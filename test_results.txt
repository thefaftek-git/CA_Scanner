  Determining projects to restore...
  All projects are up-to-date for restore.
  ConditionalAccessExporter -> /workspace/CA_Scanner/ConditionalAccessExporter/bin/Debug/net8.0/ConditionalAccessExporter.dll
  ConditionalAccessExporter.Tests -> /workspace/CA_Scanner/ConditionalAccessExporter.Tests/bin/Debug/net8.0/ConditionalAccessExporter.Tests.dll
Test run for /workspace/CA_Scanner/ConditionalAccessExporter.Tests/bin/Debug/net8.0/ConditionalAccessExporter.Tests.dll (.NETCoreApp,Version=v8.0)
VSTest version 17.11.1 (x64)

Starting test execution, please wait...
A total of 1 test files matched the specified pattern.
[xUnit.net 00:00:00.00] xUnit.net VSTest Adapter v2.5.3.1+6b60a9e56a (64-bit .NET 8.0.16)
[xUnit.net 00:00:00.20]   Discovering: ConditionalAccessExporter.Tests
[xUnit.net 00:00:00.26]   Discovered:  ConditionalAccessExporter.Tests
[xUnit.net 00:00:00.26]   Starting:    ConditionalAccessExporter.Tests
Starting cross-format comparison between '/tmp/CrossFormatTests_e27a43f8/source' and '/tmp/CrossFormatTests_e27a43f8/reference'
Starting cross-format comparison between '/tmp/CrossFormatIntegrationTests_6a698a9d/source' and '/tmp/CrossFormatIntegrationTests_6a698a9d/reference'
Starting comparison with reference directory: /tmp/test-ref-empty
Found 1 policies in Entra export
Found 0 reference policy files
Cross-format comparison report generated: /tmp/test-reports/cross-format-comparison-20250605-042325.json
Found 1 source policies (Json) and 1 reference policies (Terraform)
Starting comparison with reference directory: /tmp/test-ref-id-nomatch
Found 1 policies in Entra export
Found 1 reference policy files
Starting cross-format comparison between '/tmp/CrossFormatTests_b9e26330/source' and '/tmp/CrossFormatTests_b9e26330/reference'
Starting comparison with reference directory: /tmp/test-ref-case-insensitive
Found 1 policies in Entra export
Found 1 reference policy files
Found 1 source policies (Json) and 0 reference policies (Mixed)
Starting cross-format comparison between '/tmp/test-source' and '/tmp/test-reference'
Found 1 source policies (Json) and 1 reference policies (Terraform)
Starting cross-format comparison between '/tmp/CrossFormatTests_46e90b98/source' and '/tmp/CrossFormatTests_46e90b98/reference'
Found 1 source policies (Json) and 1 reference policies (Terraform)
Starting cross-format comparison between '/tmp/CrossFormatTests_ed87c0cb/source' and '/tmp/CrossFormatTests_ed87c0cb/reference'
Found 1 source policies (Json) and 1 reference policies (Terraform)
Starting comparison with reference directory: /tmp/test-ref-mixed
Found 3 policies in Entra export
Starting cross-format comparison between '/tmp/CrossFormatSpecificTests_b5e22e6f/nonexistent_source' and '/tmp/CrossFormatSpecificTests_b5e22e6f/terraform_policies'
Found 3 reference policy files
Found 0 source policies (Unknown) and 1 reference policies (Terraform)
Starting cross-format comparison between '/tmp/CrossFormatTests_4171b496/source' and '/tmp/CrossFormatTests_4171b496/reference'
Found 1 source policies (Json) and 1 reference policies (Terraform)
Starting comparison with reference directory: /tmp/test-ref-different
Found 1 policies in Entra export
Found 1 reference policy files
Starting cross-format comparison between '/tmp/CrossFormatTests_71b208f8/nonexistent-source' and '/tmp/CrossFormatTests_71b208f8/reference'
Found 0 source policies (Unknown) and 0 reference policies (Mixed)
Terraform parsing error: Directory not found: /tmp/CrossFormatSpecificTests_2cd6348f/nonexistent
Starting cross-format comparison between '/tmp/CrossFormatTests_a6f79b3b/source' and '/tmp/CrossFormatTests_a6f79b3b/reference'
Starting comparison with reference directory: /tmp/test-ref-custom-mapping
Found 1 policies in Entra export
Found 1 source policies (Terraform) and 1 reference policies (Json)
Found 1 reference policy files
Found 50 source policies (Json) and 50 reference policies (Terraform)
Starting comparison with reference directory: /tmp/test-timestamp
Found 0 policies in Entra export
Found 0 reference policy files
Starting comparison with reference directory: dummy-path
Found 2 policies in Entra export
Warning: Reference directory 'dummy-path' does not exist
Found 0 reference policy files
Starting cross-format comparison between '/tmp/CrossFormatSpecificTests_5a47a797/json_policies' and '/tmp/CrossFormatSpecificTests_5a47a797/terraform_policies'
Starting cross-format comparison between '/tmp/CrossFormatTests_c06deb08/source' and '/tmp/CrossFormatTests_c06deb08/reference'
Found 1 source policies (Json) and 1 reference policies (Terraform)
Starting comparison with reference directory: /tmp/test-ref-identical
Found 1 policies in Entra export
Found 1 reference policy files
Found 1 source policies (Json) and 1 reference policies (Terraform)
Starting cross-format comparison between '/tmp/CrossFormatIntegrationTests_2669bf9d/source' and '/tmp/CrossFormatIntegrationTests_2669bf9d/reference'
Starting cross-format comparison between '/tmp/CrossFormatTests_29d561a1/source' and '/tmp/CrossFormatTests_29d561a1/reference'
Starting comparison with reference directory: /tmp/test-ref-empty-reference
Found 1 policies in Entra export
Found 0 reference policy files
Found 1 source policies (Json) and 1 reference policies (Terraform)
Found 2 source policies (Json) and 2 reference policies (Terraform)
Starting comparison with reference directory: /tmp/test-ref-id-match
Found 1 policies in Entra export
Found 1 reference policy files
Starting cross-format comparison between '/tmp/CrossFormatTests_86f1cb00/source' and '/tmp/CrossFormatTests_86f1cb00/reference'
Starting cross-format comparison between '/tmp/CrossFormatIntegrationTests_e04db270/source' and '/tmp/CrossFormatIntegrationTests_e04db270/reference'
Starting cross-format comparison between '/tmp/CrossFormatSpecificTests_3e53f024/json_policies' and '/tmp/CrossFormatSpecificTests_3e53f024/terraform_policies'
Starting comparison with reference directory: /tmp/test-ref-name-match
Found 1 policies in Entra export
Found 1 reference policy files
Warning: Failed to load JSON file '/tmp/CrossFormatTests_86f1cb00/source/malformed.json': Invalid character after parsing property name. Expected ':' but got: j. Path '', line 1, position 10.
Found 1 source policies (Json) and 1 reference policies (Terraform)
Starting cross-format comparison between '/tmp/CrossFormatSpecificTests_3e53f024/json_policies' and '/tmp/CrossFormatSpecificTests_3e53f024/terraform_policies'
Found 1 source policies (Json) and 0 reference policies (Mixed)
Starting comparison with reference directory: /tmp/test-ref-only
Found 0 policies in Entra export
Found 1 reference policy files
Found 1 source policies (Json) and 1 reference policies (Terraform)
Starting cross-format comparison between '/tmp/CrossFormatSpecificTests_3e53f024/json_policies' and '/tmp/CrossFormatSpecificTests_3e53f024/terraform_policies'
Found 4 source policies (Json) and 4 reference policies (Terraform)
Found 1 source policies (Json) and 1 reference policies (Terraform)
Starting cross-format comparison between '/tmp/CrossFormatTests_5ff38f79/source' and '/tmp/CrossFormatTests_5ff38f79/reference'
Starting comparison with reference directory: /tmp/test-ref-malformed
Found 1 policies in Entra export
Found 0 source policies (Mixed) and 1 reference policies (Terraform)
  Passed ConditionalAccessExporter.Tests.CrossFormatComparisonTests.CrossFormatMatchingOptions_DefaultValues_ShouldBeCorrect [13 ms]
  Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_ValidTfFileWithSinglePolicy_ShouldParseSuccessfully [57 ms]
Starting cross-format comparison between '/tmp/CrossFormatSpecificTests_3e53f024/json_policies' and '/tmp/CrossFormatSpecificTests_3e53f024/terraform_policies'
Warning: Failed to load reference file '/tmp/test-ref-malformed/incomplete.json': Unexpected character encountered while parsing value: i. Path 'name', line 1, position 10.
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_EntraOnlyPolicy_ShouldReportAsEntraOnly [60 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_EmptyEntraExport_ShouldReturnEmptyResult [61 ms]
  Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_TfFileWithUnsupportedResources_ShouldIgnoreOtherResources [7 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatComparisonTests.CrossFormatReportGeneration_ShouldCreateValidJsonReport [35 ms]
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_MatchingById_DifferentIds_ShouldNotMatch [5 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_SemanticallyEquivalentPolicies_ShouldReturnSemanticallyEquivalentStatus [74 ms]
Warning: Failed to load reference file '/tmp/test-ref-malformed/malformed.json': Invalid character after parsing property name. Expected ':' but got: j. Path '', line 1, position 10.
Found 1 reference policy files
Found 1 source policies (Json) and 1 reference policies (Terraform)
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_ArrayOrderDifference_ShouldDetectSemanticEquivalence [11 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatComparisonTests.CrossFormatComparison_WithSampleData_ShouldProduceValidResults [12 ms]
  Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_TfFileWithLocalsOnly_ShouldParseLocals [16 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_SourceOnlyPolicy_ShouldReturnSourceOnlyStatus [18 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_DifferentPolicies_ShouldReturnDifferentStatus [9 ms]
  Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_FileDoesNotExist_ShouldReturnError [5 ms]
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_CaseSensitiveFalse_DifferentCase_ShouldMatch [23 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_DifferentPolicies_ShouldReturnDifferentStatus [11 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_CaseInsensitiveValues_ShouldDetectSemanticEquivalence [9 ms]
  Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithDifferentStates_ShouldIncludeStateCorrectly(inputState: "disabled", expectedOutputState: "disabled") [104 ms]
  Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_TfFileWithVariablesOnly_ShouldParseVariables [11 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_ValidEntraExportAndTerraformDirectory_ShouldReturnComparisonResult [3 ms]
Starting comparison with reference directory: /tmp/test-ref-both-empty
Found 0 policies in Entra export
Found 0 reference policy files
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_ByNameCaseSensitive_ShouldRespectCaseSensitivity [5 ms]
  Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_EmptyFile_ShouldReturnEmptyPolicies [15 ms]
  Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithDifferentStates_ShouldIncludeStateCorrectly(inputState: "enabled", expectedOutputState: "enabled") [16 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareAsync_NonExistentSourceDirectory_ShouldHandleGracefully [16 ms]
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_MultipleDifferenceTypes_ShouldReportCorrectly [28 ms]
Starting cross-format comparison between '/tmp/CrossFormatTests_c3a45da0/source' and '/tmp/CrossFormatTests_c3a45da0/reference'
Starting cross-format comparison between '/tmp/CrossFormatIntegrationTests_b38be13c/source' and '/tmp/CrossFormatIntegrationTests_b38be13c/reference'
  Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformDirectoryAsync_DirectoryWithMixedFileTypes_ShouldOnlyProcessTerraformFiles [3 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_IdenticalPolicies_ShouldReturnIdenticalStatus [17 ms]
  Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithDifferentStates_ShouldIncludeStateCorrectly(inputState: "enabledForReportingButNotEnforced", expectedOutputState: "enabledforreportingbutnotenforced") [3 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_DisableSemanticComparison_ShouldPerformExactComparison [3 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_NonExistentSourceDirectory_ShouldHandleGracefully [2 ms]
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_DifferentPolicies_ShouldReportAsDifferent [4 ms]
Found 1 source policies (Json) and 1 reference policies (Terraform)
Starting comparison with reference directory: /tmp/test-ref-case-sensitive
Found 1 policies in Entra export
  Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformDirectoryAsync_DirectoryWithMultipleTfFiles_ShouldAggregateAll [3 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_NonExistentTerraformDirectory_ShouldHandleGracefully [2 ms]
  Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformDirectoryAsync_DirectoryDoesNotExist_ShouldReturnError [1 ms]
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_CustomMapping_ShouldMapCorrectly [3 ms]
  Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_TfFileWithSyntaxErrors_ShouldHandleGracefully [2 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_IdenticalPolicies_ShouldReturnIdenticalStatus [4 ms]
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_ShouldSetComparedAtTimestamp [1 ms]
Found 1 reference policy files
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_TerraformToJson_ShouldDetectFormatsCorrectly [5 ms]
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.ParseEntraExport_ValidJObject_ShouldParseCorrectly [< 1 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceIntegrationTests.CompareLargeNumberOfPolicies_ShouldPerformWithinReasonableTime [142 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareAsync_ValidDirectories_ShouldReturnComparisonResult [4 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_JsonToTerraform_ShouldDetectFormatsCorrectly [4 ms]
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_IdenticalPolicies_ShouldReportAsIdentical [4 ms]
Found 1 source policies (Json) and 1 reference policies (Terraform)
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_EmptyReferenceDirectory_ShouldReportAllAsEntraOnly [1 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_CustomMappingStrategy_ShouldUseCustomMappings [4 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_CustomMapping_ShouldUseCustomMappings [4 ms]
  Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithUserConditions_ShouldMapCorrectly [18 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceIntegrationTests.CompareWithCustomMappings_ComplexScenario_ShouldFollowMappings [6 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_EmptyTerraformDirectory_ShouldReturnSourceOnlyPolicies [2 ms]
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_MatchingById_SameId_ShouldMatch [3 ms]
  Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithMultiplePolicies_ShouldGenerateMultipleResources [4 ms]
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_MatchingByName_SameName_ShouldMatch [3 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_MalformedJsonFile_ShouldSkipAndContinue [6 ms]
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_ReferenceOnlyPolicy_ShouldReportAsReferenceOnly [1 ms]
  Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithEmptyPoliciesList_ShouldReturnError [2 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceIntegrationTests.CompareMixedFormats_MultiplePolicies_ShouldHandleAllCombinations [9 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_ReferenceOnlyPolicy_ShouldReturnReferenceOnlyStatus [5 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareAsync_DifferentMatchingStrategies_ShouldHandleProperly [13 ms]
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_ReferenceDirectoryWithMalformedJson_ShouldSkipMalformedFiles [7 ms]
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_BothEmpty_ShouldReturnEmptyResult [1 ms]
Starting cross-format comparison between '/tmp/CrossFormatTests_856aaf10/source' and '/tmp/CrossFormatTests_856aaf10/nonexistent-reference'
Found 0 source policies (Mixed) and 0 reference policies (Unknown)
Starting comparison with reference directory: dummy-path
Starting cross-format comparison between '/tmp/CrossFormatIntegrationTests_d5f253d7/source' and '/tmp/CrossFormatIntegrationTests_d5f253d7/reference'
Starting comparison with reference directory: /tmp/test-ref-custom-mapping-missing
Found 1 policies in Entra export
Found 0 reference policy files
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_ByNameCaseInsensitive_ShouldIgnoreCase [4 ms]
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_CaseSensitiveTrue_DifferentCase_ShouldNotMatch [2 ms]
  Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithApplicationConditions_ShouldMapCorrectly [11 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceIntegrationTests.CompareWithMixedFileTypes_ShouldIgnoreNonPolicyFiles [9 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_NonExistentReferenceDirectory_ShouldHandleGracefully [2 ms]
  Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithIncludeComments_ShouldGenerateAppropriateContent(includeComments: True) [2 ms]
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.ParseEntraExport_InvalidJsonString_ShouldThrowException [3 ms]
Starting comparison with reference directory: dummy-path
Starting comparison with reference directory: dummy-path
Found 0 policies in Entra export
Warning: Reference directory 'dummy-path' does not exist
Found 0 reference policy files
Found 1 source policies (Json) and 1 reference policies (Terraform)
Starting comparison with reference directory: dummy-path
Found 1 policies in Entra export
Warning: Reference directory 'dummy-path' does not exist
Found 0 reference policy files
Starting comparison with reference directory: /tmp/test-ref-dir
Found 0 policies in Entra export
Found 0 reference policy files
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_CustomMapping_NonExistentReference_ShouldReportAsEntraOnly [1 ms]
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.ParseEntraExport_NullInput_ShouldThrowException [< 1 ms]
  Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithIncludeComments_ShouldGenerateAppropriateContent(includeComments: False) [3 ms]
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.ParseEntraExport_EmptyPoliciesArray_ShouldHandleGracefully [< 1 ms]
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.ParseEntraExport_MissingTenantId_ShouldUseEmptyString [< 1 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceIntegrationTests.CompareComplexPolicies_MultipleConditionsAndControls_ShouldAnalyzeCorrectly [7 ms]
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_ShouldSetReferenceDirectoryCorrectly [1 ms]
Starting cross-format comparison between '/tmp/CrossFormatIntegrationTests_abbccefb/source' and '/tmp/CrossFormatIntegrationTests_abbccefb/reference'
Found 0 source policies (Mixed) and 0 reference policies (Mixed)
Starting comparison with reference directory: /tmp/test-ref-mixed-files
Found 1 policies in Entra export
Found 1 reference policy files
Starting comparison with reference directory: dummy-path
Found 0 policies in Entra export
Warning: Reference directory 'dummy-path' does not exist
Found 0 reference policy files
Starting cross-format comparison between '/tmp/CrossFormatIntegrationTests_d7707f20/source' and '/tmp/CrossFormatIntegrationTests_d7707f20/reference'
Found 1 source policies (Json) and 1 reference policies (Terraform)
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceIntegrationTests.CompareWithEmptyDirectories_ShouldHandleGracefully [3 ms]
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_ReferenceDirectoryWithNonJsonFiles_ShouldIgnoreNonJsonFiles [3 ms]
  Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithNullConditions_ShouldHandleGracefully [6 ms]
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.ParseEntraExport_MissingPoliciesProperty_ShouldHandleGracefully [1 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceIntegrationTests.CompareWithDifferentNamingConventions_ShouldDetectSimilarPolicies [4 ms]
  Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithGenerateProvider_ShouldCreateProviderFile [3 ms]
  Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_TfStateWithMultipleInstances_ShouldParseAll [50 ms]
Starting comparison with reference directory: /tmp/test-ref-complex
Found 1 policies in Entra export
Found 1 reference policy files
Starting comparison with reference directory: dummy-path
Found 1 policies in Entra export
Warning: Reference directory 'dummy-path' does not exist
Found 0 reference policy files
  Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithSpecialCharactersInDisplayName_ShouldSanitizeResourceName [4 ms]
  Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_ValidTfStateBackupFile_ShouldParseSuccessfully [2 ms]
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_LocationsConditions_ShouldMapCorrectly [188 ms]
  Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformDirectoryAsync_EmptyDirectory_ShouldReturnEmptyResults [1 ms]
  Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithMinimalPolicy_ShouldGenerateCorrectHCL [3 ms]
  Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformDirectoryAsync_DirectoryWithValidAndInvalidFiles_ShouldParseValidOnesAndReportErrors [2 ms]
  Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_ValidTfFileWithMultiplePolicies_ShouldParseAll [2 ms]
Starting comparison with reference directory: /tmp/test-ref-empty-entra
Found 0 policies in Entra export
Found 1 reference policy files
Starting comparison with reference directory: /tmp/non-existent-directory
Found 1 policies in Entra export
Warning: Reference directory '/tmp/non-existent-directory' does not exist
Found 0 reference policy files
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_ComplexNestedDifferences_ShouldDetectCorrectly [15 ms]
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.ParseEntraExport_ValidJsonString_ShouldParseCorrectly [< 1 ms]
  Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_FullyPopulatedPolicy_ShouldMapAllAttributes [2 ms]
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_EmptyEntraExport_ShouldReportAllAsReferenceOnly [2 ms]
  Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_NonExistentReferenceDirectory_ShouldHandleGracefully [< 1 ms]
  Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithSessionControls_ShouldMapCorrectly [10 ms]
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_VariableResolution_ShouldResolveCorrectly [11 ms]
  Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_TfFileWithVariableInterpolations_ShouldParseCorrectly [2 ms]
  Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithInvalidJson_ShouldHandleErrorGracefully [1 ms]
  Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_TfFileWithComments_ShouldIgnoreComments [1 ms]
  Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_ValidTfStateFile_ShouldParseSuccessfully [2 ms]
  Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_PolicyWithMissingRequiredAttributes_ShouldHandleGracefully [1 ms]
  Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_UnknownFileExtension_ShouldAttemptHclParsing [1 ms]
  Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithGrantControls_ShouldMapCorrectly [6 ms]
  Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformDirectoryAsync_DirectoryWithSubdirectories_ShouldParseRecursively [1 ms]
  Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithGenerateVariables_ShouldCreateVariablesFile [2 ms]
  Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_TfStateWithNoResources_ShouldReturnEmpty [1 ms]
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_GrantControls_ShouldMapCorrectly [22 ms]
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_SingleFullyPopulatedPolicy_ShouldConvertSuccessfully [19 ms]
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_DifferentStates_ShouldMapCorrectly(terraformState: "enabled", expectedState: "enabled") [1 ms]
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_DifferentStates_ShouldMapCorrectly(terraformState: "invalid", expectedState: "disabled") [< 1 ms]
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_DifferentStates_ShouldMapCorrectly(terraformState: "enabledForReportingButNotEnforced", expectedState: "enabledForReportingButNotEnforced") [< 1 ms]
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_DifferentStates_ShouldMapCorrectly(terraformState: null, expectedState: "disabled") [< 1 ms]
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_DifferentStates_ShouldMapCorrectly(terraformState: "disabled", expectedState: "disabled") [< 1 ms]
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_EmptyPoliciesList_ShouldReturnEmptyList [1 ms]
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_PolicyConversionFailure_ShouldContinueWithOthers [< 1 ms]
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_UnresolvedVariables_ShouldGenerateWarnings [< 1 ms]
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_NullNestedObjects_ShouldHandleGracefully [1 ms]
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_UsersConditions_ShouldMapCorrectly [13 ms]
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_DataSourceReferences_ShouldGenerateWarnings [< 1 ms]
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_ClientApplicationsConditions_ShouldMapCorrectly [20 ms]
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_PlatformsConditions_ShouldMapCorrectly [8 ms]
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_ApplicationsConditions_ShouldMapCorrectly [9 ms]
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_LocalResolution_ShouldResolveCorrectly [1 ms]
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_MultiplePolicies_ShouldConvertAll [1 ms]
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_SessionControls_ShouldMapCorrectly [14 ms]
Markdown cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/29a117e1-15d3-4b65-9399-136601e9e182/cross-format-comparison-20250605-042325.md
Cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/a9034d2d-4d15-4bc2-ae17-597c0f8a6b1f/cross-format-comparison-20250605-042325.json
HTML cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/a9034d2d-4d15-4bc2-ae17-597c0f8a6b1f/cross-format-comparison-20250605-042325.html
Markdown cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/a9034d2d-4d15-4bc2-ae17-597c0f8a6b1f/cross-format-comparison-20250605-042325.md
CSV cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/a9034d2d-4d15-4bc2-ae17-597c0f8a6b1f/cross-format-comparison-20250605-042325.csv
Cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/7770bf72-64de-4002-83be-99c9f160cd31/cross-format-comparison-20250605-042325.json
Cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/d288f68a-37c0-435e-b574-b4c143ee0754/cross-format-comparison-20250605-042325.json
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_ClientAppTypes_ShouldMapCorrectly [4 ms]
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_SpecialValues_ShouldMapCorrectly [2 ms]
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_RiskLevels_ShouldMapCorrectly [5 ms]
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_GeneralStructure_ShouldBeCorrect [4 ms]
  Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_MinimalRequiredFields_ShouldConvertWithDefaults [2 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateMarkdownReport_ValidatesMarkdownSyntax [7 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateReports_AllFormats_ShouldContainSameDataAccuracy [14 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateJsonReport_WithEmptyResult_ShouldCreateValidJsonFile [4 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateReport_WithDefaultFormat_ShouldCreateJsonReport [11 ms]
HTML cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/c0af2d07-2140-471e-a537-367a4cab2599/cross-format-comparison-20250605-042325.html
CSV cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/907af208-604d-44b2-a433-dcfcde5ff121/cross-format-comparison-20250605-042325.csv
Cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/84073e4b-631b-44b4-b0a5-cc7ccbc9ded1/cross-format-comparison-20250605-042325.json
HTML cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/84073e4b-631b-44b4-b0a5-cc7ccbc9ded1/cross-format-comparison-20250605-042325.html
Markdown cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/84073e4b-631b-44b4-b0a5-cc7ccbc9ded1/cross-format-comparison-20250605-042325.md
CSV cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/84073e4b-631b-44b4-b0a5-cc7ccbc9ded1/cross-format-comparison-20250605-042325.csv
HTML cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/7a0813fe-1d62-404c-a7cb-7845db7a5176/cross-format-comparison-20250605-042325.html
Cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/4f333a2b-a6d0-4ac8-8978-41ce24c8b229/cross-format-comparison-20250605-042325.json
CSV cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/addbfeef-76b2-431f-a12e-abb578552075/cross-format-comparison-20250605-042325.csv
HTML cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/b6dd6f25-fba2-406f-bce6-6dadd6bc2514/cross-format-comparison-20250605-042325.html
Cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/d272bcbc-ae72-476c-b170-dd4d845c7e4b/new-directory/cross-format-comparison-20250605-042325.json
Markdown cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/64cb3013-9a42-4d93-914a-bb27fafaae13/cross-format-comparison-20250605-042325.md
  Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateHtmlReport_WithSemanticallyEquivalent_ShouldDisplaySemanticInfo [2 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateCsvReport_WithConversionSuggestions_ShouldReflectInHasSuggestions [1 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateReport_WithEmptyResult_ShouldHandleGracefully [2 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateHtmlReport_WithConversionSuggestions_ShouldDisplaySuggestions [2 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateReport_WithUnknownFormat_ShouldDefaultToJson [1 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateCsvReport_WithAllStatuses_ShouldCreateValidCsvFile [1 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateHtmlReport_WithAllStatuses_ShouldCreateValidHtmlFile [3 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateReport_CreatesOutputDirectory_WhenNotExists [1 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateMarkdownReport_WithAllStatuses_ShouldCreateValidMarkdownFile [1 ms]
Markdown cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/69d14ae6-5fe2-4e7e-96ea-4b853690c100/cross-format-comparison-20250605-042325.md
Cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/17b3100c-c5e1-4802-9b24-d554be0ab52e/cross-format-comparison-20250605-042325.json
[xUnit.net 00:00:00.74]     ConditionalAccessExporter.Tests.ProgramTests.CrossFormatComparePoliciesAsync_Success_ReturnsZero [FAIL]
[xUnit.net 00:00:00.74]       Assert.NotNull() Failure: Value is null
[xUnit.net 00:00:00.74]       Stack Trace:
[xUnit.net 00:00:00.74]         /workspace/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTests.cs(856,0): at ConditionalAccessExporter.Tests.ProgramTests.CrossFormatComparePoliciesAsync_Success_ReturnsZero()
[xUnit.net 00:00:00.74]         --- End of stack trace from previous location ---
  Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateReports_ShouldLogFileGeneration [2 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateMarkdownReport_WithSemanticallyEquivalent_ShouldFormatCorrectly [1 ms]
  Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateJsonReport_WithAllStatuses_ShouldCreateValidJsonFile [2 ms]
  Failed ConditionalAccessExporter.Tests.ProgramTests.CrossFormatComparePoliciesAsync_Success_ReturnsZero [3 ms]
  Error Message:
   Assert.NotNull() Failure: Value is null
  Stack Trace:
     at ConditionalAccessExporter.Tests.ProgramTests.CrossFormatComparePoliciesAsync_Success_ReturnsZero() in /workspace/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTests.cs:line 856
--- End of stack trace from previous location ---
  Passed ConditionalAccessExporter.Tests.ProgramTests.ExportPoliciesAsync_Exception_HandlesErrorAndReturnsOne [1 s]
  Passed ConditionalAccessExporter.Tests.ProgramTests.Export_Command_ValidArgs_CallsHandler(args: ["export", "--output", "custom_export.json"]) [872 ms]
[xUnit.net 00:00:04.16]     ConditionalAccessExporter.Tests.ProgramTests.ConvertJsonToTerraformAsync_Success_ReturnsZero [FAIL]
[xUnit.net 00:00:04.17]       Assert.NotNull() Failure: Value is null
[xUnit.net 00:00:04.17]       Stack Trace:
[xUnit.net 00:00:04.17]         /workspace/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTests.cs(686,0): at ConditionalAccessExporter.Tests.ProgramTests.ConvertJsonToTerraformAsync_Success_ReturnsZero()
[xUnit.net 00:00:04.17]         --- End of stack trace from previous location ---
Option '--input' is required.
[xUnit.net 00:00:04.19]     ConditionalAccessExporter.Tests.ProgramTests.JsonToTerraform_Command_MissingInput_ReturnsError [FAIL]
[xUnit.net 00:00:04.19]       Assert.Contains() Failure: Sub-string not found
[xUnit.net 00:00:04.19]       String:    "Description:\n  Convert JSON conditional a"···
[xUnit.net 00:00:04.19]       Not found: "Required option '--input'"
[xUnit.net 00:00:04.19]       Stack Trace:
[xUnit.net 00:00:04.19]         /workspace/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTests.cs(234,0): at ConditionalAccessExporter.Tests.ProgramTests.JsonToTerraform_Command_MissingInput_ReturnsError()
[xUnit.net 00:00:04.19]         --- End of stack trace from previous location ---
Option '--reference-dir' is required.
[xUnit.net 00:00:04.19]     ConditionalAccessExporter.Tests.ProgramTests.CrossCompare_Command_MissingRequiredOption_ReturnsError(args: ["cross-compare", "--source-dir", "./src"]) [FAIL]
[xUnit.net 00:00:04.19]       Assert.Contains() Failure: Sub-string not found
[xUnit.net 00:00:04.19]       String:    "Description:\n  Compare policies across di"···
[xUnit.net 00:00:04.19]       Not found: "Required option '--reference-dir'"
[xUnit.net 00:00:04.19]       Stack Trace:
[xUnit.net 00:00:04.19]         /workspace/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTests.cs(475,0): at ConditionalAccessExporter.Tests.ProgramTests.CrossCompare_Command_MissingRequiredOption_ReturnsError(String[] args)
[xUnit.net 00:00:04.19]         --- End of stack trace from previous location ---
Option '--source-dir' is required.
[xUnit.net 00:00:04.19]     ConditionalAccessExporter.Tests.ProgramTests.CrossCompare_Command_MissingRequiredOption_ReturnsError(args: ["cross-compare", "--reference-dir", "./ref"]) [FAIL]
[xUnit.net 00:00:04.19]       Assert.Contains() Failure: Sub-string not found
[xUnit.net 00:00:04.19]       String:    "Description:\n  Compare policies across di"···
[xUnit.net 00:00:04.19]       Not found: "Required option '--source-dir'"
[xUnit.net 00:00:04.19]       Stack Trace:
[xUnit.net 00:00:04.19]         /workspace/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTests.cs(479,0): at ConditionalAccessExporter.Tests.ProgramTests.CrossCompare_Command_MissingRequiredOption_ReturnsError(String[] args)
[xUnit.net 00:00:04.19]         --- End of stack trace from previous location ---
Option '--input' is required.
[xUnit.net 00:00:04.20]     ConditionalAccessExporter.Tests.ProgramTests.Terraform_Command_MissingInput_ReturnsError [FAIL]
[xUnit.net 00:00:04.20]       Assert.Contains() Failure: Sub-string not found
[xUnit.net 00:00:04.20]       String:    "Description:\n  Convert Terraform conditio"···
[xUnit.net 00:00:04.20]       Not found: "Required option '--input'"
[xUnit.net 00:00:04.20]       Stack Trace:
[xUnit.net 00:00:04.20]         /workspace/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTests.cs(158,0): at ConditionalAccessExporter.Tests.ProgramTests.Terraform_Command_MissingInput_ReturnsError()
[xUnit.net 00:00:04.20]         --- End of stack trace from previous location ---
  Passed ConditionalAccessExporter.Tests.ProgramTests.Export_Command_ValidArgs_CallsHandler(args: ["export"]) [643 ms]
  Failed ConditionalAccessExporter.Tests.ProgramTests.ConvertJsonToTerraformAsync_Success_ReturnsZero [2 ms]
  Error Message:
   Assert.NotNull() Failure: Value is null
  Stack Trace:
     at ConditionalAccessExporter.Tests.ProgramTests.ConvertJsonToTerraformAsync_Success_ReturnsZero() in /workspace/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTests.cs:line 686
--- End of stack trace from previous location ---
  Passed ConditionalAccessExporter.Tests.ProgramTests.ComparePoliciesAsync_ServiceFailure_ReturnsOne [1 ms]
  Failed ConditionalAccessExporter.Tests.ProgramTests.JsonToTerraform_Command_MissingInput_ReturnsError [23 ms]
  Error Message:
   Assert.Contains() Failure: Sub-string not found
String:    "Description:\n  Convert JSON conditional a"···
Not found: "Required option '--input'"
  Stack Trace:
     at ConditionalAccessExporter.Tests.ProgramTests.JsonToTerraform_Command_MissingInput_ReturnsError() in /workspace/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTests.cs:line 234
--- End of stack trace from previous location ---
  Failed ConditionalAccessExporter.Tests.ProgramTests.CrossCompare_Command_MissingRequiredOption_ReturnsError(args: ["cross-compare", "--source-dir", "./src"]) [1 ms]
  Error Message:
   Assert.Contains() Failure: Sub-string not found
String:    "Description:\n  Compare policies across di"···
Not found: "Required option '--reference-dir'"
  Stack Trace:
     at ConditionalAccessExporter.Tests.ProgramTests.CrossCompare_Command_MissingRequiredOption_ReturnsError(String[] args) in /workspace/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTests.cs:line 475
--- End of stack trace from previous location ---
  Failed ConditionalAccessExporter.Tests.ProgramTests.CrossCompare_Command_MissingRequiredOption_ReturnsError(args: ["cross-compare", "--reference-dir", "./ref"]) [< 1 ms]
  Error Message:
   Assert.Contains() Failure: Sub-string not found
String:    "Description:\n  Compare policies across di"···
Not found: "Required option '--source-dir'"
  Stack Trace:
     at ConditionalAccessExporter.Tests.ProgramTests.CrossCompare_Command_MissingRequiredOption_ReturnsError(String[] args) in /workspace/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTests.cs:line 479
--- End of stack trace from previous location ---
  Passed ConditionalAccessExporter.Tests.ProgramTests.CrossCompare_Command_ValidArgs_CallsHandler(args: ["cross-compare", "--source-dir", "./src_tf", "--reference-dir", "./ref_json", ···]) [2 ms]
  Passed ConditionalAccessExporter.Tests.ProgramTests.CrossCompare_Command_ValidArgs_CallsHandler(args: ["cross-compare", "--source-dir", "./src", "--reference-dir", "./ref"]) [< 1 ms]
  Failed ConditionalAccessExporter.Tests.ProgramTests.Terraform_Command_MissingInput_ReturnsError [1 ms]
  Error Message:
   Assert.Contains() Failure: Sub-string not found
String:    "Description:\n  Convert Terraform conditio"···
Not found: "Required option '--input'"
  Stack Trace:
     at ConditionalAccessExporter.Tests.ProgramTests.Terraform_Command_MissingInput_ReturnsError() in /workspace/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTests.cs:line 158
--- End of stack trace from previous location ---
[xUnit.net 00:00:05.01]     ConditionalAccessExporter.Tests.ProgramTests.ExportPoliciesAsync_Success_ReturnsZero [FAIL]
[xUnit.net 00:00:05.01]       Assert.Contains() Failure: Sub-string not found
[xUnit.net 00:00:05.01]       String:    "Conditional Access Policy Exporter\n======"···
[xUnit.net 00:00:05.01]       Not found: "Exporting"
[xUnit.net 00:00:05.01]       Stack Trace:
[xUnit.net 00:00:05.01]         /workspace/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTests.cs(553,0): at ConditionalAccessExporter.Tests.ProgramTests.ExportPoliciesAsync_Success_ReturnsZero()
[xUnit.net 00:00:05.01]         --- End of stack trace from previous location ---
  Passed ConditionalAccessExporter.Tests.ProgramTests.Terraform_Command_ValidArgs_CallsHandler(args: ["terraform", "--input", "file.tf"]) [10 ms]
  Passed ConditionalAccessExporter.Tests.ProgramTests.Terraform_Command_ValidArgs_CallsHandler(args: ["terraform", "--input", "dir/", "--output", "converted.json", ···]) [< 1 ms]
  Failed ConditionalAccessExporter.Tests.ProgramTests.ExportPoliciesAsync_Success_ReturnsZero [803 ms]
  Error Message:
   Assert.Contains() Failure: Sub-string not found
String:    "Conditional Access Policy Exporter\n======"···
Not found: "Exporting"
  Stack Trace:
     at ConditionalAccessExporter.Tests.ProgramTests.ExportPoliciesAsync_Success_ReturnsZero() in /workspace/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTests.cs:line 553
--- End of stack trace from previous location ---
  Passed ConditionalAccessExporter.Tests.ProgramTests.ConvertTerraformAsync_ServiceFailure_ReturnsOne [< 1 ms]
  Passed ConditionalAccessExporter.Tests.ProgramTests.ConvertJsonToTerraformAsync_ServiceFailure_ReturnsOne [< 1 ms]
  Passed ConditionalAccessExporter.Tests.ProgramTests.Compare_Command_ValidArgs_CallsHandler(args: ["compare", "--reference-dir", "./ref", "--entra-file", "entra_export.json", ···]) [5 ms]
[xUnit.net 00:00:06.44]     ConditionalAccessExporter.Tests.ProgramTests.ConvertTerraformAsync_Success_ReturnsZero [FAIL]
[xUnit.net 00:00:06.44]       Assert.NotNull() Failure: Value is null
[xUnit.net 00:00:06.44]       Stack Trace:
[xUnit.net 00:00:06.44]         /workspace/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTests.cs(610,0): at ConditionalAccessExporter.Tests.ProgramTests.ConvertTerraformAsync_Success_ReturnsZero()
[xUnit.net 00:00:06.44]         --- End of stack trace from previous location ---
[xUnit.net 00:00:06.44]     ConditionalAccessExporter.Tests.ProgramTests.ComparePoliciesAsync_Success_ReturnsZero [FAIL]
[xUnit.net 00:00:06.44]       Assert.NotNull() Failure: Value is null
[xUnit.net 00:00:06.44]       Stack Trace:
[xUnit.net 00:00:06.44]         /workspace/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTests.cs(771,0): at ConditionalAccessExporter.Tests.ProgramTests.ComparePoliciesAsync_Success_ReturnsZero()
[xUnit.net 00:00:06.44]         --- End of stack trace from previous location ---
Option '--reference-dir' is required.
[xUnit.net 00:00:06.45]     ConditionalAccessExporter.Tests.ProgramTests.Compare_Command_MissingReferenceDir_ReturnsError [FAIL]
[xUnit.net 00:00:06.45]       Assert.Contains() Failure: Sub-string not found
[xUnit.net 00:00:06.45]       String:    "Description:\n  Compare Entra policies wit"···
[xUnit.net 00:00:06.45]       Not found: "Required option '--reference-dir'"
[xUnit.net 00:00:06.45]       Stack Trace:
[xUnit.net 00:00:06.45]         /workspace/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTests.cs(384,0): at ConditionalAccessExporter.Tests.ProgramTests.Compare_Command_MissingReferenceDir_ReturnsError()
[xUnit.net 00:00:06.45]         --- End of stack trace from previous location ---
  Passed ConditionalAccessExporter.Tests.ProgramTests.Compare_Command_ValidArgs_CallsHandler(args: ["compare", "--reference-dir", "./ref"]) [1 s]
  Failed ConditionalAccessExporter.Tests.ProgramTests.ConvertTerraformAsync_Success_ReturnsZero [2 ms]
  Error Message:
   Assert.NotNull() Failure: Value is null
  Stack Trace:
     at ConditionalAccessExporter.Tests.ProgramTests.ConvertTerraformAsync_Success_ReturnsZero() in /workspace/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTests.cs:line 610
--- End of stack trace from previous location ---
  Failed ConditionalAccessExporter.Tests.ProgramTests.ComparePoliciesAsync_Success_ReturnsZero [1 ms]
  Error Message:
   Assert.NotNull() Failure: Value is null
  Stack Trace:
     at ConditionalAccessExporter.Tests.ProgramTests.ComparePoliciesAsync_Success_ReturnsZero() in /workspace/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTests.cs:line 771
--- End of stack trace from previous location ---
  Passed ConditionalAccessExporter.Tests.ProgramTests.JsonToTerraform_Command_ValidArgs_CallsHandler(args: ["json-to-terraform", "--input", "policies.json", "--output-dir", "custom_tf_out", ···]) [1 ms]
  Passed ConditionalAccessExporter.Tests.ProgramTests.JsonToTerraform_Command_ValidArgs_CallsHandler(args: ["json-to-terraform", "--input", "policies.json"]) [< 1 ms]
  Failed ConditionalAccessExporter.Tests.ProgramTests.Compare_Command_MissingReferenceDir_ReturnsError [1 ms]
  Error Message:
   Assert.Contains() Failure: Sub-string not found
String:    "Description:\n  Compare Entra policies wit"···
Not found: "Required option '--reference-dir'"
  Stack Trace:
     at ConditionalAccessExporter.Tests.ProgramTests.Compare_Command_MissingReferenceDir_ReturnsError() in /workspace/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTests.cs:line 384
--- End of stack trace from previous location ---
  Passed ConditionalAccessExporter.Tests.ProgramTests.Help_Option_PrintsHelpText(args: ["--help"]) [1 ms]
  Passed ConditionalAccessExporter.Tests.ProgramTests.Help_Option_PrintsHelpText(args: ["export", "--help"]) [< 1 ms]
  Passed ConditionalAccessExporter.Tests.ProgramTests.Main_NoArgs_CallsExportCommand [589 ms]
HTML report generated: /tmp/ReportGenerationTests/07d23e78-6a57-4095-b6ac-99d59ed66dec/CA_Comparison_20250605_042332.html
JSON report generated: /tmp/ReportGenerationTests/25181ba4-9b2a-4c73-9470-3997e6a64aec/CA_Comparison_20250605_042332.json
CSV report generated: /tmp/ReportGenerationTests/4c4a4cc6-f1b8-49ef-8b92-ba18abf66608/CA_Comparison_20250605_042332.csv
JSON report generated: /tmp/ReportGenerationTests/c92b0a53-b947-433b-8db1-c080d8fbaf5e/CA_Comparison_20250605_042332.json
HTML report generated: /tmp/ReportGenerationTests/c92b0a53-b947-433b-8db1-c080d8fbaf5e/CA_Comparison_20250605_042332.html
CSV report generated: /tmp/ReportGenerationTests/c92b0a53-b947-433b-8db1-c080d8fbaf5e/CA_Comparison_20250605_042332.csv
JSON report generated: /tmp/ReportGenerationTests/cabe9090-e99a-45e8-8a6c-6573f4968a71/CA_Comparison_20250605_042332.json
  Passed ConditionalAccessExporter.Tests.ProgramTests.CrossFormatComparePoliciesAsync_ServiceFailure_ReturnsOne [1 ms]
  Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateConsoleReport_WithAllIdentical_ShouldShowAllIdentical [< 1 ms]
  Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateConsoleReport_WithAllEntraOnly_ShouldShowEntraOnlySection [< 1 ms]
  Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateHtmlReport_WithEmptyResult_ShouldCreateValidHtmlFile [1 ms]
  Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateJsonReport_WithEmptyResult_ShouldCreateValidJsonFile [2 ms]
  Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateCsvReport_WithAllStatusTypes_ShouldCreateValidCsvFile [2 ms]
  Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateReports_WithNullDifferences_ShouldHandleGracefully [3 ms]
  Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateJsonReport_WithAllStatusTypes_ShouldCreateValidJsonFile [3 ms]
  Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateReports_WithInvalidFormat_ShouldHandleGracefully [1 ms]
JSON report generated: /tmp/ReportGenerationTests/5c6fb25c-3a1f-4c4d-a17c-5970dfd63322/new-directory/CA_Comparison_20250605_042332.json
JSON report generated: /tmp/ReportGenerationTests/2da5be16-04c2-4fac-a33d-c66e77f5e131/CA_Comparison_20250605_042332.json
HTML report generated: /tmp/ReportGenerationTests/2da5be16-04c2-4fac-a33d-c66e77f5e131/CA_Comparison_20250605_042332.html
CSV report generated: /tmp/ReportGenerationTests/2da5be16-04c2-4fac-a33d-c66e77f5e131/CA_Comparison_20250605_042332.csv
HTML report generated: /tmp/ReportGenerationTests/74b899ce-e550-491b-aee4-f5a65aa283e8/CA_Comparison_20250605_042332.html
[xUnit.net 00:00:07.07]   Finished:    ConditionalAccessExporter.Tests
  Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateConsoleReport_WithEmptyResult_ShouldShowEmptyReport [< 1 ms]
  Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateConsoleReport_WithAllStatusTypes_ShouldProduceStructuredOutput [< 1 ms]
  Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateReports_CreatesOutputDirectory_WhenNotExists [1 ms]
  Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateReports_WithMultipleFormats_ShouldCreateAllFiles [2 ms]
  Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateHtmlReport_WithAllStatusTypes_ShouldCreateValidHtmlFile [2 ms]

Test Run Failed.
Total tests: 187
     Passed: 177
     Failed: 10
 Total time: 7.4494 Seconds
