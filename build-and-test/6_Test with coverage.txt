2025-06-13T05:43:00.2127282Z ##[group]Run dotnet --version && dotnet test --no-build --verbosity normal --collect:"XPlat Code Coverage" --logger "console;verbosity=detailed" --nologo
2025-06-13T05:43:00.2128338Z [36;1mdotnet --version && dotnet test --no-build --verbosity normal --collect:"XPlat Code Coverage" --logger "console;verbosity=detailed" --nologo[0m
2025-06-13T05:43:00.2188167Z shell: /usr/bin/bash -e {0}
2025-06-13T05:43:00.2188435Z env:
2025-06-13T05:43:00.2188639Z   DOTNET_ROOT: /usr/share/dotnet
2025-06-13T05:43:00.2189194Z   AZURE_TENANT_ID: ***
2025-06-13T05:43:00.2189514Z   AZURE_CLIENT_ID: ***
2025-06-13T05:43:00.2189903Z   AZURE_CLIENT_SECRET: ***
2025-06-13T05:43:00.2190161Z ##[endgroup]
2025-06-13T05:43:00.3150037Z 8.0.411
2025-06-13T05:43:00.6756402Z Build started 06/13/2025 05:43:00.
2025-06-13T05:43:00.8491136Z      1>Project "/home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.sln" on node 1 (VSTest target(s)).
2025-06-13T05:43:00.8546505Z      1>ValidateSolutionConfiguration:
2025-06-13T05:43:00.8554250Z          Building solution configuration "Debug|Any CPU".
2025-06-13T05:43:01.3822024Z Test run for /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/bin/Debug/net8.0/ConditionalAccessExporter.Tests.dll (.NETCoreApp,Version=v8.0)
2025-06-13T05:43:01.5526650Z A total of 1 test files matched the specified pattern.
2025-06-13T05:43:01.5528150Z /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/bin/Debug/net8.0/ConditionalAccessExporter.Tests.dll
2025-06-13T05:43:03.4383819Z [xUnit.net 00:00:00.00] xUnit.net VSTest Adapter v2.5.3.1+6b60a9e56a (64-bit .NET 8.0.17)
2025-06-13T05:43:03.6733192Z [xUnit.net 00:00:00.25]   Discovering: ConditionalAccessExporter.Tests
2025-06-13T05:43:03.7510458Z [xUnit.net 00:00:00.33]   Discovered:  ConditionalAccessExporter.Tests
2025-06-13T05:43:03.7556900Z [xUnit.net 00:00:00.33]   Starting:    ConditionalAccessExporter.Tests
2025-06-13T05:43:03.8798620Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-13T05:43:03.8871386Z Starting Conditional Access Policy remediation analysis...
2025-06-13T05:43:03.8913046Z Authentication credentials not found. Please set AZURE_TENANT_ID, AZURE_CLIENT_ID, and AZURE_CLIENT_SECRET environment variables.
2025-06-13T05:43:03.8916688Z Authentication credentials not found. Please set AZURE_TENANT_ID, AZURE_CLIENT_ID, and AZURE_CLIENT_SECRET environment variables.
2025-06-13T05:43:03.8937514Z Authentication credentials not found. Please set AZURE_TENANT_ID, AZURE_CLIENT_ID, and AZURE_CLIENT_SECRET environment variables.
2025-06-13T05:43:03.8939409Z Authentication credentials not found. Please set AZURE_TENANT_ID, AZURE_CLIENT_ID, and AZURE_CLIENT_SECRET environment variables.
2025-06-13T05:43:03.8941152Z Authentication credentials not found. Please set AZURE_TENANT_ID, AZURE_CLIENT_ID, and AZURE_CLIENT_SECRET environment variables.
2025-06-13T05:43:03.8942656Z Starting Conditional Access Policy remediation analysis...
2025-06-13T05:43:03.8943521Z Starting Conditional Access Policy remediation analysis...
2025-06-13T05:43:03.8944258Z Starting Conditional Access Policy remediation analysis...
2025-06-13T05:43:03.8945750Z Starting Conditional Access Policy remediation analysis...
2025-06-13T05:43:03.8976932Z Starting Conditional Access Policy remediation analysis...
2025-06-13T05:43:03.8978580Z Authentication credentials not found. Please set AZURE_TENANT_ID, AZURE_CLIENT_ID, and AZURE_CLIENT_SECRET environment variables.
2025-06-13T05:43:03.8987404Z Starting Conditional Access Policy remediation analysis...
2025-06-13T05:43:03.8994533Z Authentication credentials not found. Please set AZURE_TENANT_ID, AZURE_CLIENT_ID, and AZURE_CLIENT_SECRET environment variables.
2025-06-13T05:43:03.9011646Z Cross-format comparison report generated: /tmp/test-reports/cross-format-comparison-20250613-054303.json
2025-06-13T05:43:03.9420133Z Starting comparison with reference directory: /tmp/test-ref-empty
2025-06-13T05:43:03.9421928Z Starting cross-format comparison between '/tmp/CrossFormatTests_7d86c98c/source' and '/tmp/CrossFormatTests_7d86c98c/reference'
2025-06-13T05:43:03.9476007Z Found 1 policies in Entra export
2025-06-13T05:43:03.9485990Z Validating reference files...
2025-06-13T05:43:03.9497699Z Validating reference directory: /tmp/test-ref-empty
2025-06-13T05:43:03.9501987Z Starting cross-format comparison between '/tmp/CrossFormatIntegrationTests_0230212a/source' and '/tmp/CrossFormatIntegrationTests_0230212a/reference'
2025-06-13T05:43:03.9624256Z   Passed ConditionalAccessExporter.Tests.BaselineGenerationServiceTests.BaselineGenerationOptions_PropertiesSetCorrectly [26 ms]
2025-06-13T05:43:03.9635395Z No JSON files found in directory: /tmp/test-ref-empty. No files were processed.
2025-06-13T05:43:03.9649100Z ✓ All 0 reference files are valid
2025-06-13T05:43:03.9650773Z   Passed ConditionalAccessExporter.Tests.BaselineGenerationServiceTests.BaselineGenerationOptions_DefaultConstructor_SetsDefaults [< 1 ms]
2025-06-13T05:43:03.9653520Z   Passed ConditionalAccessExporter.Tests.BaselineGenerationServiceTests.BaselineGenerationService_Constructor_CreatesInstance [< 1 ms]
2025-06-13T05:43:03.9654612Z   Passed ConditionalAccessExporter.Tests.CrossFormatComparisonTests.CrossFormatMatchingOptions_DefaultValues_ShouldBeCorrect [11 ms]
2025-06-13T05:43:03.9659537Z   Passed ConditionalAccessExporter.Tests.RemediatePoliciesAsyncTests.RemediatePoliciesAsync_AcceptsValidRiskLevels(riskLevel: "All") [8 ms]
2025-06-13T05:43:03.9661570Z   Passed ConditionalAccessExporter.Tests.RemediatePoliciesAsyncTests.RemediatePoliciesAsync_AcceptsValidRiskLevels(riskLevel: "High") [< 1 ms]
2025-06-13T05:43:03.9663677Z   Passed ConditionalAccessExporter.Tests.RemediatePoliciesAsyncTests.RemediatePoliciesAsync_AcceptsValidRiskLevels(riskLevel: "Critical") [< 1 ms]
2025-06-13T05:43:03.9666078Z   Passed ConditionalAccessExporter.Tests.RemediatePoliciesAsyncTests.RemediatePoliciesAsync_AcceptsValidRiskLevels(riskLevel: "Low") [< 1 ms]
2025-06-13T05:43:03.9668187Z   Passed ConditionalAccessExporter.Tests.RemediatePoliciesAsyncTests.RemediatePoliciesAsync_AcceptsValidRiskLevels(riskLevel: "Medium") [< 1 ms]
2025-06-13T05:43:03.9670141Z   Passed ConditionalAccessExporter.Tests.RemediatePoliciesAsyncTests.RemediatePoliciesAsync_CreatesOutputDirectory [7 ms]
2025-06-13T05:43:03.9672082Z   Passed ConditionalAccessExporter.Tests.RemediatePoliciesAsyncTests.RemediatePoliciesAsync_WithoutCredentials_ReturnsErrorExitCode [2 ms]
2025-06-13T05:43:03.9673660Z Converting policies: Progress: 1/1 (100.0%) - 40.0 items/sec, ETA: 00:00
2025-06-13T05:43:03.9674495Z No JSON files found in reference directory '/tmp/test-ref-empty'
2025-06-13T05:43:03.9675137Z Found 0 reference policy files
2025-06-13T05:43:03.9683981Z Policy conversion completed in 80ms
2025-06-13T05:43:03.9690784Z Average speed: 12.4 policies/second
2025-06-13T05:43:03.9700653Z Starting cross-format comparison between '/tmp/test-source' and '/tmp/test-reference'
2025-06-13T05:43:03.9904732Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-13T05:43:03.9939156Z Found 0 source policies (Mixed) and 1 reference policies (Terraform)
2025-06-13T05:43:03.9950631Z Starting comparison with reference directory: /tmp/test-ref-id-nomatch
2025-06-13T05:43:03.9961899Z Found 1 policies in Entra export
2025-06-13T05:43:03.9962427Z Validating reference files...
2025-06-13T05:43:03.9963055Z Validating reference directory: /tmp/test-ref-id-nomatch
2025-06-13T05:43:03.9963801Z Validating 1 policy files using parallel processing...
2025-06-13T05:43:04.0135829Z   Passed ConditionalAccessExporter.Tests.CrossFormatComparisonTests.CrossFormatReportGeneration_ShouldCreateValidJsonReport [38 ms]
2025-06-13T05:43:04.0138059Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_EntraOnlyPolicy_ShouldReportAsEntraOnly [74 ms]
2025-06-13T05:43:04.0141158Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_ValidTfFileWithSinglePolicy_ShouldParseSuccessfully [181 ms]
2025-06-13T05:43:04.0144872Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_EmptyEntraExport_ShouldReturnEmptyResult [142 ms]
2025-06-13T05:43:04.0147895Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_EmptySourceDirectory_ShouldHandleGracefully [76 ms]
2025-06-13T05:43:04.0182030Z Starting cross-format comparison between '/tmp/CrossFormatTests_9acf4c63/source' and '/tmp/CrossFormatTests_9acf4c63/reference'
2025-06-13T05:43:04.0246309Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-13T05:43:04.0421083Z Starting cross-format comparison between '/tmp/CrossFormatTests_55d655a6/source' and '/tmp/CrossFormatTests_55d655a6/reference'
2025-06-13T05:43:04.0423003Z   Passed ConditionalAccessExporter.Tests.CrossFormatComparisonTests.CrossFormatComparison_WithSampleData_ShouldProduceValidResults [108 ms]
2025-06-13T05:43:04.0425429Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_TfFileWithUnsupportedResources_ShouldIgnoreOtherResources [9 ms]
2025-06-13T05:43:04.0428163Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_ArrayOrderDifference_ShouldDetectSemanticEquivalence [12 ms]
2025-06-13T05:43:04.0431033Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_DifferentPolicies_ShouldReturnDifferentStatus [5 ms]
2025-06-13T05:43:04.0433930Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_CaseInsensitiveValues_ShouldDetectSemanticEquivalence [6 ms]
2025-06-13T05:43:04.0436719Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_TfFileWithLocalsOnly_ShouldParseLocals [16 ms]
2025-06-13T05:43:04.0439341Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithDifferentStates_ShouldIncludeStateCorrectly(inputState: "disabled", expectedOutputState: "disabled") [226 ms]
2025-06-13T05:43:04.0468399Z Found 1 source policies (Json) and 0 reference policies (Mixed)
2025-06-13T05:43:04.0470873Z Starting cross-format comparison between '/tmp/CrossFormatSpecificTests_3f17c500/nonexistent_source' and '/tmp/CrossFormatSpecificTests_3f17c500/terraform_policies'
2025-06-13T05:43:04.0492740Z Starting cross-format comparison between '/tmp/CrossFormatTests_83221a8c/source' and '/tmp/CrossFormatTests_83221a8c/reference'
2025-06-13T05:43:04.0508815Z Found 0 source policies (Mixed) and 0 reference policies (Mixed)
2025-06-13T05:43:04.0537550Z Found 0 source policies (Unknown) and 1 reference policies (Terraform)
2025-06-13T05:43:04.0561789Z Starting cross-format comparison between '/tmp/CrossFormatTests_daf37ae5/source' and '/tmp/CrossFormatTests_daf37ae5/reference'
2025-06-13T05:43:04.0619404Z Terraform parsing error: Directory not found: /tmp/CrossFormatSpecificTests_bebdec92/nonexistent
2025-06-13T05:43:04.0636405Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-13T05:43:04.0676933Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_FileDoesNotExist_ShouldReturnError [< 1 ms]
2025-06-13T05:43:04.0679681Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_SemanticallyEquivalentPolicies_ShouldReturnSemanticallyEquivalentStatus [25 ms]
2025-06-13T05:43:04.0682542Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_ValidEntraExportAndTerraformDirectory_ShouldReturnComparisonResult [11 ms]
2025-06-13T05:43:04.0685456Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_SourceOnlyPolicy_ShouldReturnSourceOnlyStatus [6 ms]
2025-06-13T05:43:04.0687757Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_BothDirectoriesEmpty_ShouldReturnEmptyResult [4 ms]
2025-06-13T05:43:04.0690627Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithDifferentStates_ShouldIncludeStateCorrectly(inputState: "enabled", expectedOutputState: "enabled") [14 ms]
2025-06-13T05:43:04.0724841Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_TfFileWithVariablesOnly_ShouldParseVariables [13 ms]
2025-06-13T05:43:04.0729760Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareAsync_NonExistentSourceDirectory_ShouldHandleGracefully [8 ms]
2025-06-13T05:43:04.0732865Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_EmptyFile_ShouldReturnEmptyPolicies [2 ms]
2025-06-13T05:43:04.0740274Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithDifferentStates_ShouldIncludeStateCorrectly(inputState: "enabledForReportingButNotEnforced", expectedOutputState: "enabledforreportingbutnotenforced") [5 ms]
2025-06-13T05:43:04.0744341Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformDirectoryAsync_DirectoryWithMixedFileTypes_ShouldOnlyProcessTerraformFiles [6 ms]
2025-06-13T05:43:04.0748342Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_DisableSemanticComparison_ShouldPerformExactComparison [6 ms]
2025-06-13T05:43:04.0751749Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_NonExistentTerraformDirectory_ShouldHandleGracefully [1 ms]
2025-06-13T05:43:04.0908462Z Starting cross-format comparison between '/tmp/CrossFormatSpecificTests_6e97c058/json_policies' and '/tmp/CrossFormatSpecificTests_6e97c058/terraform_policies'
2025-06-13T05:43:04.0915937Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-13T05:43:04.0958179Z Starting cross-format comparison between '/tmp/CrossFormatTests_fad68c27/source' and '/tmp/CrossFormatTests_fad68c27/reference'
2025-06-13T05:43:04.0979740Z Validation completed: 0 valid, 1 invalid files
2025-06-13T05:43:04.0984443Z Processing time: 101ms
2025-06-13T05:43:04.0985094Z Average speed: 9.9 files/second
2025-06-13T05:43:04.0986123Z Reference file validation failed. Found 1 invalid files out of 1.
2025-06-13T05:43:04.0999087Z [xUnit.net 00:00:00.67]     ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_NullMatchingOptions_ShouldUseDefaults [FAIL]
2025-06-13T05:43:04.1000783Z   ✗ policy1.json: 2 errors
2025-06-13T05:43:04.1001713Z [xUnit.net 00:00:00.68]       System.NullReferenceException : Object reference not set to an instance of an object.
2025-06-13T05:43:04.1014544Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-13T05:43:04.1016698Z [xUnit.net 00:00:00.68]       Stack Trace:
2025-06-13T05:43:04.1022993Z [xUnit.net 00:00:00.68]         /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter/Services/CrossFormatPolicyComparisonService.cs(569,0): at ConditionalAccessExporter.Services.CrossFormatPolicyComparisonService.FindMatchingPolicy(NormalizedPolicy sourcePolicy, List`1 referencePolicies, CrossFormatMatchingOptions matchingOptions)
2025-06-13T05:43:04.1044040Z [xUnit.net 00:00:00.68]         /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter/Services/CrossFormatPolicyComparisonService.cs(532,0): at ConditionalAccessExporter.Services.CrossFormatPolicyComparisonService.ComparePolicy(NormalizedPolicy sourcePolicy, List`1 referencePolicies, CrossFormatMatchingOptions matchingOptions)
2025-06-13T05:43:04.1095141Z [xUnit.net 00:00:00.68]         /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter/Services/CrossFormatPolicyComparisonService.cs(476,0): at ConditionalAccessExporter.Services.CrossFormatPolicyComparisonService.PerformCrossFormatComparison(CrossFormatComparisonResult result, List`1 sourcePolicies, List`1 referencePolicies, CrossFormatMatchingOptions matchingOptions)
2025-06-13T05:43:04.1100549Z [xUnit.net 00:00:00.68]         /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter/Services/CrossFormatPolicyComparisonService.cs(53,0): at ConditionalAccessExporter.Services.CrossFormatPolicyComparisonService.CompareAsync(String sourceDirectory, String referenceDirectory, CrossFormatMatchingOptions matchingOptions)
2025-06-13T05:43:04.1104795Z [xUnit.net 00:00:00.68]         /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/CrossFormatPolicyComparisonServiceTests.cs(554,0): at ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_NullMatchingOptions_ShouldUseDefaults()
2025-06-13T05:43:04.1107410Z [xUnit.net 00:00:00.68]         --- End of stack trace from previous location ---
2025-06-13T05:43:04.1108345Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-13T05:43:04.1109168Z     - Display name is missing or empty.
2025-06-13T05:43:04.1109761Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-13T05:43:04.1110549Z Loading 1 reference policy files using parallel processing...
2025-06-13T05:43:04.1150934Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-13T05:43:04.1152957Z Loading reference files: Progress: 1/1 (100.0%) - 284.3 items/sec, ETA: 00:00
2025-06-13T05:43:04.1154238Z Reference file loading completed: 1 files loaded successfully
2025-06-13T05:43:04.1155432Z Processing time: 4ms
2025-06-13T05:43:04.1156891Z Average speed: 232.7 files/second
2025-06-13T05:43:04.1157625Z Found 1 reference policy files
2025-06-13T05:43:04.1158939Z Starting cross-format comparison between '/tmp/CrossFormatTests_65098c54/source' and '/tmp/CrossFormatTests_65098c54/reference'
2025-06-13T05:43:04.1163672Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-13T05:43:04.1166080Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformDirectoryAsync_DirectoryWithMultipleTfFiles_ShouldAggregateAll [8 ms]
2025-06-13T05:43:04.1168651Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformDirectoryAsync_DirectoryDoesNotExist_ShouldReturnError [< 1 ms]
2025-06-13T05:43:04.1171077Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_TfFileWithSyntaxErrors_ShouldHandleGracefully [7 ms]
2025-06-13T05:43:04.1173451Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_IdenticalPolicies_ShouldReturnIdenticalStatus [16 ms]
2025-06-13T05:43:04.1176191Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareAsync_ValidDirectories_ShouldReturnComparisonResult [12 ms]
2025-06-13T05:43:04.1178460Z   Failed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_NullMatchingOptions_ShouldUseDefaults [16 ms]
2025-06-13T05:43:04.1179758Z   Error Message:
2025-06-13T05:43:04.1180712Z    System.NullReferenceException : Object reference not set to an instance of an object.
2025-06-13T05:43:04.1181411Z   Stack Trace:
2025-06-13T05:43:04.1183712Z      at ConditionalAccessExporter.Services.CrossFormatPolicyComparisonService.FindMatchingPolicy(NormalizedPolicy sourcePolicy, List`1 referencePolicies, CrossFormatMatchingOptions matchingOptions) in /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter/Services/CrossFormatPolicyComparisonService.cs:line 569
2025-06-13T05:43:04.1188176Z    at ConditionalAccessExporter.Services.CrossFormatPolicyComparisonService.ComparePolicy(NormalizedPolicy sourcePolicy, List`1 referencePolicies, CrossFormatMatchingOptions matchingOptions) in /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter/Services/CrossFormatPolicyComparisonService.cs:line 532
2025-06-13T05:43:04.1192891Z    at ConditionalAccessExporter.Services.CrossFormatPolicyComparisonService.PerformCrossFormatComparison(CrossFormatComparisonResult result, List`1 sourcePolicies, List`1 referencePolicies, CrossFormatMatchingOptions matchingOptions) in /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter/Services/CrossFormatPolicyComparisonService.cs:line 476
2025-06-13T05:43:04.1198059Z    at ConditionalAccessExporter.Services.CrossFormatPolicyComparisonService.CompareAsync(String sourceDirectory, String referenceDirectory, CrossFormatMatchingOptions matchingOptions) in /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter/Services/CrossFormatPolicyComparisonService.cs:line 53
2025-06-13T05:43:04.1202106Z    at ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_NullMatchingOptions_ShouldUseDefaults() in /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/CrossFormatPolicyComparisonServiceTests.cs:line 554
2025-06-13T05:43:04.1204400Z --- End of stack trace from previous location ---
2025-06-13T05:43:04.1206101Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_DifferentPolicies_ShouldReturnDifferentStatus [13 ms]
2025-06-13T05:43:04.1245548Z Starting comparison with reference directory: /tmp/test-ref-case-insensitive
2025-06-13T05:43:04.1253765Z Found 1 policies in Entra export
2025-06-13T05:43:04.1254627Z Validating reference files...
2025-06-13T05:43:04.1255745Z Validating reference directory: /tmp/test-ref-case-insensitive
2025-06-13T05:43:04.1256717Z Validating 1 policy files using parallel processing...
2025-06-13T05:43:04.1257552Z Validation completed: 0 valid, 1 invalid files
2025-06-13T05:43:04.1258270Z Processing time: 1ms
2025-06-13T05:43:04.1258792Z Average speed: 1698.4 files/second
2025-06-13T05:43:04.1259653Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-13T05:43:04.1260671Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-13T05:43:04.1261551Z Loading 1 reference policy files using parallel processing...
2025-06-13T05:43:04.1262548Z Reference file loading completed: 1 files loaded successfully
2025-06-13T05:43:04.1263363Z Processing time: 0ms
2025-06-13T05:43:04.1263899Z Average speed: 2893.5 files/second
2025-06-13T05:43:04.1264481Z Found 1 reference policy files
2025-06-13T05:43:04.1266139Z Starting cross-format comparison between '/tmp/CrossFormatSpecificTests_9e846a68/json_policies' and '/tmp/CrossFormatSpecificTests_9e846a68/terraform_policies'
2025-06-13T05:43:04.1267926Z Reference file validation failed. Found 1 invalid files out of 1.
2025-06-13T05:43:04.1271022Z   ✗ policy1.json: 2 errors
2025-06-13T05:43:04.1271914Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-13T05:43:04.1272878Z     - Display name is missing or empty.
2025-06-13T05:43:04.1273656Z Loading reference files: Progress: 1/1 (100.0%) - 5078.7 items/sec, ETA: 00:00
2025-06-13T05:43:04.1303283Z Starting cross-format comparison between '/tmp/CrossFormatTests_ac45436c/source' and '/tmp/CrossFormatTests_ac45436c/reference'
2025-06-13T05:43:04.1329554Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-13T05:43:04.1331121Z Starting cross-format comparison between '/tmp/CrossFormatSpecificTests_9e846a68/json_policies' and '/tmp/CrossFormatSpecificTests_9e846a68/terraform_policies'
2025-06-13T05:43:04.1348929Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-13T05:43:04.1354073Z Starting cross-format comparison between '/tmp/CrossFormatSpecificTests_9e846a68/json_policies' and '/tmp/CrossFormatSpecificTests_9e846a68/terraform_policies'
2025-06-13T05:43:04.1358092Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-13T05:43:04.1373150Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_MatchingById_DifferentIds_ShouldNotMatch [134 ms]
2025-06-13T05:43:04.1375934Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_CustomMappingStrategy_ShouldUseCustomMappings [18 ms]
2025-06-13T05:43:04.1378703Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_EmptyTerraformDirectory_ShouldReturnSourceOnlyPolicies [1 ms]
2025-06-13T05:43:04.1380563Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-13T05:43:04.1382079Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_ByNameCaseSensitive_ShouldRespectCaseSensitivity [18 ms]
2025-06-13T05:43:04.1384225Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithUserConditions_ShouldMapCorrectly [67 ms]
2025-06-13T05:43:04.1386378Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_CaseSensitiveFalse_DifferentCase_ShouldMatch [21 ms]
2025-06-13T05:43:04.1467031Z Starting cross-format comparison between '/tmp/CrossFormatSpecificTests_9e846a68/json_policies' and '/tmp/CrossFormatSpecificTests_9e846a68/terraform_policies'
2025-06-13T05:43:04.1527162Z Starting cross-format comparison between '/tmp/CrossFormatTests_ca718136/nonexistent-source' and '/tmp/CrossFormatTests_ca718136/reference'
2025-06-13T05:43:04.1529989Z Found 0 source policies (Unknown) and 0 reference policies (Mixed)
2025-06-13T05:43:04.1531150Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-13T05:43:04.1532358Z Starting comparison with reference directory: /tmp/test-ref-mixed
2025-06-13T05:43:04.1533733Z Found 3 policies in Entra export
2025-06-13T05:43:04.1588255Z Validating reference files...
2025-06-13T05:43:04.1589459Z Validating reference directory: /tmp/test-ref-mixed
2025-06-13T05:43:04.1590497Z Validating 3 policy files using parallel processing...
2025-06-13T05:43:04.1591981Z Starting cross-format comparison between '/tmp/CrossFormatTests_4b6b34fb/source' and '/tmp/CrossFormatTests_4b6b34fb/reference'
2025-06-13T05:43:04.1593351Z Validation completed: 0 valid, 3 invalid files
2025-06-13T05:43:04.1593988Z Processing time: 6ms
2025-06-13T05:43:04.1594485Z Average speed: 480.1 files/second
2025-06-13T05:43:04.1595576Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-13T05:43:04.1596747Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-13T05:43:04.1597794Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-13T05:43:04.1599602Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-13T05:43:04.1600532Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-13T05:43:04.1601436Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-13T05:43:04.1602233Z Loading 3 reference policy files using parallel processing...
2025-06-13T05:43:04.1603044Z Reference file validation failed. Found 3 invalid files out of 3.
2025-06-13T05:43:04.1603941Z   ✗ policy2.json: 2 errors
2025-06-13T05:43:04.1605123Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-13T05:43:04.1606276Z     - Display name is missing or empty.
2025-06-13T05:43:04.1606864Z   ✗ policy1.json: 2 errors
2025-06-13T05:43:04.1607749Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-13T05:43:04.1608733Z     - Display name is missing or empty.
2025-06-13T05:43:04.1609319Z   ✗ policy4.json: 2 errors
2025-06-13T05:43:04.1610193Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-13T05:43:04.1611168Z     - Display name is missing or empty.
2025-06-13T05:43:04.1650053Z Loading reference files: Progress: 1/3 (33.3%) - 664.2 items/sec, ETA: 00:00
2025-06-13T05:43:04.1656991Z Loading reference files: Progress: 2/3 (66.7%) - 1203.3 items/sec, ETA: 00:00
2025-06-13T05:43:04.1657977Z Loading reference files: Progress: 3/3 (100.0%) - 1665.8 items/sec, ETA: 00:00
2025-06-13T05:43:04.1658852Z Reference file loading completed: 3 files loaded successfully
2025-06-13T05:43:04.1659436Z Processing time: 2ms
2025-06-13T05:43:04.1659858Z Average speed: 1250.2 files/second
2025-06-13T05:43:04.1660356Z Found 3 reference policy files
2025-06-13T05:43:04.1661006Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-13T05:43:04.1682218Z Starting comparison with reference directory: /tmp/test-ref-different
2025-06-13T05:43:04.1686177Z Found 1 policies in Entra export
2025-06-13T05:43:04.1691705Z Validating reference files...
2025-06-13T05:43:04.1697094Z Validating reference directory: /tmp/test-ref-different
2025-06-13T05:43:04.1713448Z Reference file validation failed. Found 1 invalid files out of 1.
2025-06-13T05:43:04.1717833Z   ✗ policy1.json: 2 errors
2025-06-13T05:43:04.1718891Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-13T05:43:04.1721127Z     - Display name is missing or empty.
2025-06-13T05:43:04.1722991Z Validating 1 policy files using parallel processing...
2025-06-13T05:43:04.1724846Z Validation completed: 0 valid, 1 invalid files
2025-06-13T05:43:04.1726831Z Processing time: 1ms
2025-06-13T05:43:04.1728524Z Average speed: 1560.5 files/second
2025-06-13T05:43:04.1730569Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-13T05:43:04.1732336Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-13T05:43:04.1733677Z Loading 1 reference policy files using parallel processing...
2025-06-13T05:43:04.1735470Z Loading reference files: Progress: 1/1 (100.0%) - 4456.3 items/sec, ETA: 00:00
2025-06-13T05:43:04.1736823Z Reference file loading completed: 1 files loaded successfully
2025-06-13T05:43:04.1738335Z Processing time: 0ms
2025-06-13T05:43:04.1738775Z Average speed: 2019.0 files/second
2025-06-13T05:43:04.1739251Z Found 1 reference policy files
2025-06-13T05:43:04.1740333Z Starting cross-format comparison between '/tmp/CrossFormatTests_06c38c1b/source' and '/tmp/CrossFormatTests_06c38c1b/reference'
2025-06-13T05:43:04.1784833Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithMultiplePolicies_ShouldGenerateMultipleResources [8 ms]
2025-06-13T05:43:04.1789495Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_IdenticalPolicies_ShouldReturnIdenticalStatus [12 ms]
2025-06-13T05:43:04.1795169Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_NonExistentSourceDirectory_ShouldHandleGracefully [1 ms]
2025-06-13T05:43:04.1797715Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithEmptyPoliciesList_ShouldReturnError [10 ms]
2025-06-13T05:43:04.1800026Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareAsync_DifferentMatchingStrategies_ShouldHandleProperly [40 ms]
2025-06-13T05:43:04.1802660Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_MultipleDifferenceTypes_ShouldReportCorrectly [29 ms]
2025-06-13T05:43:04.1804749Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_VeryLongPolicyNames_ShouldHandleCorrectly [25 ms]
2025-06-13T05:43:04.1819514Z Starting comparison with reference directory: /tmp/test-ref-custom-mapping
2025-06-13T05:43:04.1825041Z Found 1 policies in Entra export
2025-06-13T05:43:04.1826078Z Validating reference files...
2025-06-13T05:43:04.1827714Z Validating reference directory: /tmp/test-ref-custom-mapping
2025-06-13T05:43:04.1828532Z Validating 1 policy files using parallel processing...
2025-06-13T05:43:04.1853004Z Reference file validation failed. Found 1 invalid files out of 1.
2025-06-13T05:43:04.1855164Z   ✗ reference-policy.json: 2 errors
2025-06-13T05:43:04.1856377Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-13T05:43:04.1857457Z     - Display name is missing or empty.
2025-06-13T05:43:04.1858021Z Validation completed: 0 valid, 1 invalid files
2025-06-13T05:43:04.1858531Z Processing time: 2ms
2025-06-13T05:43:04.1858956Z Average speed: 427.8 files/second
2025-06-13T05:43:04.1859722Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-13T05:43:04.1860667Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-13T05:43:04.1861463Z Found 1 source policies (Terraform) and 1 reference policies (Json)
2025-06-13T05:43:04.1862217Z Loading 1 reference policy files using parallel processing...
2025-06-13T05:43:04.1863072Z Loading reference files: Progress: 1/1 (100.0%) - 5599.1 items/sec, ETA: 00:00
2025-06-13T05:43:04.1863920Z Reference file loading completed: 1 files loaded successfully
2025-06-13T05:43:04.1864504Z Processing time: 1ms
2025-06-13T05:43:04.1864919Z Average speed: 1980.2 files/second
2025-06-13T05:43:04.1865596Z Found 1 reference policy files
2025-06-13T05:43:04.1990388Z Starting comparison with reference directory: /tmp/test-timestamp
2025-06-13T05:43:04.1991184Z Found 0 policies in Entra export
2025-06-13T05:43:04.1991685Z Validating reference files...
2025-06-13T05:43:04.1992248Z Validating reference directory: /tmp/test-timestamp
2025-06-13T05:43:04.1993110Z No JSON files found in directory: /tmp/test-timestamp. No files were processed.
2025-06-13T05:43:04.1994054Z ✓ All 0 reference files are valid
2025-06-13T05:43:04.1994704Z No JSON files found in reference directory '/tmp/test-timestamp'
2025-06-13T05:43:04.1995586Z Found 0 reference policy files
2025-06-13T05:43:04.2010653Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-13T05:43:04.2021263Z Starting comparison with reference directory: dummy-path
2025-06-13T05:43:04.2021919Z Found 2 policies in Entra export
2025-06-13T05:43:04.2022411Z Validating reference files...
2025-06-13T05:43:04.2022921Z Validating reference directory: dummy-path
2025-06-13T05:43:04.2023716Z Converting policies: Progress: 1/1 (100.0%) - 1718.8 items/sec, ETA: 00:00
2025-06-13T05:43:04.2030489Z Found 0 reference policy files
2025-06-13T05:43:04.2031159Z Reference file validation failed. Found 0 invalid files out of 0.
2025-06-13T05:43:04.2031861Z Reference directory 'dummy-path' does not exist
2025-06-13T05:43:04.2032429Z Policy conversion completed in 1ms
2025-06-13T05:43:04.2032903Z Average speed: 1348.1 policies/second
2025-06-13T05:43:04.2063197Z Starting cross-format comparison between '/tmp/CrossFormatTests_2d43189d/source' and '/tmp/CrossFormatTests_2d43189d/reference'
2025-06-13T05:43:04.2081671Z Starting comparison with reference directory: /tmp/test-ref-identical
2025-06-13T05:43:04.2085107Z Found 1 policies in Entra export
2025-06-13T05:43:04.2085809Z Validating reference files...
2025-06-13T05:43:04.2086729Z Validating reference directory: /tmp/test-ref-identical
2025-06-13T05:43:04.2087480Z Validating 1 policy files using parallel processing...
2025-06-13T05:43:04.2088137Z Validation completed: 0 valid, 1 invalid files
2025-06-13T05:43:04.2127359Z Processing time: 1ms
2025-06-13T05:43:04.2128116Z Average speed: 1448.0 files/second
2025-06-13T05:43:04.2134355Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-13T05:43:04.2136261Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-13T05:43:04.2156168Z Loading 1 reference policy files using parallel processing...
2025-06-13T05:43:04.2169057Z Reference file validation failed. Found 1 invalid files out of 1.
2025-06-13T05:43:04.2170089Z   ✗ policy1.json: 2 errors
2025-06-13T05:43:04.2171126Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-13T05:43:04.2175408Z     - Display name is missing or empty.
2025-06-13T05:43:04.2194971Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-13T05:43:04.2196500Z Loading reference files: Progress: 1/1 (100.0%) - 1975.1 items/sec, ETA: 00:00
2025-06-13T05:43:04.2197392Z Reference file loading completed: 1 files loaded successfully
2025-06-13T05:43:04.2197987Z Processing time: 1ms
2025-06-13T05:43:04.2198398Z Average speed: 1034.4 files/second
2025-06-13T05:43:04.2198865Z Found 1 reference policy files
2025-06-13T05:43:04.2199950Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_DifferentPolicies_ShouldReportAsDifferent [12 ms]
2025-06-13T05:43:04.2201986Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithApplicationConditions_ShouldMapCorrectly [28 ms]
2025-06-13T05:43:04.2204102Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_LocationsConditions_ShouldMapCorrectly [327 ms]
2025-06-13T05:43:04.2206351Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_TfStateWithMultipleInstances_ShouldParseAll [106 ms]
2025-06-13T05:43:04.2208180Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_CustomMapping_ShouldMapCorrectly [21 ms]
2025-06-13T05:43:04.2210114Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_TerraformToJson_ShouldDetectFormatsCorrectly [13 ms]
2025-06-13T05:43:04.2212204Z Starting cross-format comparison between '/tmp/CrossFormatTests_89dd5bca/source' and '/tmp/CrossFormatTests_89dd5bca/reference'
2025-06-13T05:43:04.2213543Z Starting comparison with reference directory: /tmp/test-ref-empty-reference
2025-06-13T05:43:04.2214275Z Found 1 policies in Entra export
2025-06-13T05:43:04.2248777Z Validating reference files...
2025-06-13T05:43:04.2255119Z Validating reference directory: /tmp/test-ref-empty-reference
2025-06-13T05:43:04.2256256Z No JSON files found in directory: /tmp/test-ref-empty-reference. No files were processed.
2025-06-13T05:43:04.2257250Z ✓ All 0 reference files are valid
2025-06-13T05:43:04.2257962Z No JSON files found in reference directory '/tmp/test-ref-empty-reference'
2025-06-13T05:43:04.2258654Z Found 0 reference policy files
2025-06-13T05:43:04.2259659Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_ShouldSetComparedAtTimestamp [1 ms]
2025-06-13T05:43:04.2261455Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.ParseEntraExport_ValidJObject_ShouldParseCorrectly [2 ms]
2025-06-13T05:43:04.2263720Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithIncludeComments_ShouldGenerateAppropriateContent(includeComments: True) [23 ms]
2025-06-13T05:43:04.2266342Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_ValidTfStateBackupFile_ShouldParseSuccessfully [20 ms]
2025-06-13T05:43:04.2268550Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformDirectoryAsync_EmptyDirectory_ShouldReturnEmptyResults [5 ms]
2025-06-13T05:43:04.2270892Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_IdenticalPolicies_ShouldReportAsIdentical [14 ms]
2025-06-13T05:43:04.2272466Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-13T05:43:04.2273448Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-13T05:43:04.2274353Z Starting comparison with reference directory: /tmp/test-ref-id-match
2025-06-13T05:43:04.2275071Z Found 1 policies in Entra export
2025-06-13T05:43:04.2275808Z Validating reference files...
2025-06-13T05:43:04.2276394Z Validating reference directory: /tmp/test-ref-id-match
2025-06-13T05:43:04.2277101Z Validating 1 policy files using parallel processing...
2025-06-13T05:43:04.2294911Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_SpecialCharactersInPolicyNames_ShouldHandleCorrectly [16 ms]
2025-06-13T05:43:04.2307175Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithIncludeComments_ShouldGenerateAppropriateContent(includeComments: False) [8 ms]
2025-06-13T05:43:04.2309645Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_VariableResolution_ShouldResolveCorrectly [33 ms]
2025-06-13T05:43:04.2311719Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_EmptyReferenceDirectory_ShouldReportAllAsEntraOnly [4 ms]
2025-06-13T05:43:04.2314058Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformDirectoryAsync_DirectoryWithValidAndInvalidFiles_ShouldParseValidOnesAndReportErrors [11 ms]
2025-06-13T05:43:04.2316059Z Validation completed: 0 valid, 1 invalid files
2025-06-13T05:43:04.2316623Z Processing time: 2ms
2025-06-13T05:43:04.2317054Z Average speed: 507.2 files/second
2025-06-13T05:43:04.2325697Z Reference file validation failed. Found 1 invalid files out of 1.
2025-06-13T05:43:04.2327624Z   ✗ policy1.json: 2 errors
2025-06-13T05:43:04.2328572Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-13T05:43:04.2329631Z     - Display name is missing or empty.
2025-06-13T05:43:04.2330423Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-13T05:43:04.2331382Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-13T05:43:04.2332185Z Loading 1 reference policy files using parallel processing...
2025-06-13T05:43:04.2346230Z Loading reference files: Progress: 1/1 (100.0%) - 5649.7 items/sec, ETA: 00:00
2025-06-13T05:43:04.2358401Z Reference file loading completed: 1 files loaded successfully
2025-06-13T05:43:04.2359064Z Processing time: 2ms
2025-06-13T05:43:04.2359463Z Average speed: 573.3 files/second
2025-06-13T05:43:04.2359934Z Found 1 reference policy files
2025-06-13T05:43:04.2360624Z Converting policies: Progress: 1/1 (100.0%) - 115.5 items/sec, ETA: 00:00
2025-06-13T05:43:04.2361293Z Policy conversion completed in 9ms
2025-06-13T05:43:04.2361769Z Average speed: 114.5 policies/second
2025-06-13T05:43:04.2362861Z Starting cross-format comparison between '/tmp/CrossFormatTests_c4ad8ad5/source' and '/tmp/CrossFormatTests_c4ad8ad5/reference'
2025-06-13T05:43:04.2385890Z Starting comparison with reference directory: /tmp/test-ref-name-match
2025-06-13T05:43:04.2386691Z Found 1 policies in Entra export
2025-06-13T05:43:04.2387193Z Validating reference files...
2025-06-13T05:43:04.2387783Z Validating reference directory: /tmp/test-ref-name-match
2025-06-13T05:43:04.2388506Z Validating 1 policy files using parallel processing...
2025-06-13T05:43:04.2450747Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_ValidTfFileWithMultiplePolicies_ShouldParseAll [6 ms]
2025-06-13T05:43:04.2457746Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithNullConditions_ShouldHandleGracefully [15 ms]
2025-06-13T05:43:04.2460068Z   Passed ConditionalAccessExporter.Tests.ParallelProcessingServiceTests.ProcessInParallelAsync_WithCustomParallelism_RespectsMaxDegreeOfParallelism [420 ms]
2025-06-13T05:43:04.2461494Z   Standard Output Messages:
2025-06-13T05:43:04.2461924Z  Max concurrent operations observed: 3
2025-06-13T05:43:04.2462416Z  Configured max degree of parallelism: 3
2025-06-13T05:43:04.2462743Z 
2025-06-13T05:43:04.2462756Z 
2025-06-13T05:43:04.2463831Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_JsonToTerraform_ShouldDetectFormatsCorrectly [17 ms]
2025-06-13T05:43:04.2466086Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_MatchingById_SameId_ShouldMatch [13 ms]
2025-06-13T05:43:04.2467625Z Validation completed: 0 valid, 1 invalid files
2025-06-13T05:43:04.2496051Z Processing time: 4ms
2025-06-13T05:43:04.2496519Z Average speed: 262.8 files/second
2025-06-13T05:43:04.2497309Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-13T05:43:04.2498493Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-13T05:43:04.2499333Z Loading 1 reference policy files using parallel processing...
2025-06-13T05:43:04.2500240Z Loading reference files: Progress: 1/1 (100.0%) - 2506.9 items/sec, ETA: 00:00
2025-06-13T05:43:04.2501065Z Reference file loading completed: 1 files loaded successfully
2025-06-13T05:43:04.2501632Z Processing time: 4ms
2025-06-13T05:43:04.2502063Z Average speed: 264.3 files/second
2025-06-13T05:43:04.2502525Z Found 1 reference policy files
2025-06-13T05:43:04.2503182Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-13T05:43:04.2504015Z Reference file validation failed. Found 1 invalid files out of 1.
2025-06-13T05:43:04.2504816Z   ✗ policy1.json: 2 errors
2025-06-13T05:43:04.2505902Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-13T05:43:04.2506903Z     - Display name is missing or empty.
2025-06-13T05:43:04.2507631Z Starting comparison with reference directory: /tmp/test-ref-only
2025-06-13T05:43:04.2508304Z Found 0 policies in Entra export
2025-06-13T05:43:04.2508792Z Validating reference files...
2025-06-13T05:43:04.2509352Z Validating reference directory: /tmp/test-ref-only
2025-06-13T05:43:04.2510054Z Validating 1 policy files using parallel processing...
2025-06-13T05:43:04.2535725Z Validation completed: 0 valid, 1 invalid files
2025-06-13T05:43:04.2536302Z Processing time: 1ms
2025-06-13T05:43:04.2536737Z Average speed: 801.0 files/second
2025-06-13T05:43:04.2537543Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-13T05:43:04.2538537Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-13T05:43:04.2539389Z Loading 1 reference policy files using parallel processing...
2025-06-13T05:43:04.2540222Z Reference file validation failed. Found 1 invalid files out of 1.
2025-06-13T05:43:04.2541004Z   ✗ policy1.json: 2 errors
2025-06-13T05:43:04.2541908Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-13T05:43:04.2542895Z     - Display name is missing or empty.
2025-06-13T05:43:04.2544039Z Starting cross-format comparison between '/tmp/CrossFormatTests_343768a4/source' and '/tmp/CrossFormatTests_343768a4/reference'
2025-06-13T05:43:04.2545558Z Loading reference files: Progress: 1/1 (100.0%) - 3384.1 items/sec, ETA: 00:00
2025-06-13T05:43:04.2549656Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_FullyPopulatedPolicy_ShouldMapAllAttributes [7 ms]
2025-06-13T05:43:04.2556584Z Reference file loading completed: 1 files loaded successfully
2025-06-13T05:43:04.2559420Z Processing time: 2ms
2025-06-13T05:43:04.2559847Z Average speed: 427.7 files/second
2025-06-13T05:43:04.2560334Z Found 1 reference policy files
2025-06-13T05:43:04.2561660Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_TfFileWithVariableInterpolations_ShouldParseCorrectly [7 ms]
2025-06-13T05:43:04.2563894Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithGenerateProvider_ShouldCreateProviderFile [13 ms]
2025-06-13T05:43:04.2586314Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_MatchingByName_SameName_ShouldMatch [11 ms]
2025-06-13T05:43:04.2588300Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_UnicodeCharacters_ShouldHandleCorrectly [13 ms]
2025-06-13T05:43:04.2590660Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_TfFileWithComments_ShouldIgnoreComments [4 ms]
2025-06-13T05:43:04.2618501Z Terraform parsing error: Unmatched braces in resource 'invalid_policy'
2025-06-13T05:43:04.2626567Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-13T05:43:04.2679862Z Found 50 source policies (Json) and 50 reference policies (Terraform)
2025-06-13T05:43:04.2701781Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_ValidTfStateFile_ShouldParseSuccessfully [5 ms]
2025-06-13T05:43:04.2703870Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_ReferenceOnlyPolicy_ShouldReportAsReferenceOnly [9 ms]
2025-06-13T05:43:04.2706345Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithSpecialCharactersInDisplayName_ShouldSanitizeResourceName [11 ms]
2025-06-13T05:43:04.2708791Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_PolicyWithMissingRequiredAttributes_ShouldHandleGracefully [2 ms]
2025-06-13T05:43:04.2711068Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_UnknownFileExtension_ShouldAttemptHclParsing [2 ms]
2025-06-13T05:43:04.2713275Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_InvalidTerraformSyntax_ShouldSkipAndContinue [14 ms]
2025-06-13T05:43:04.2714934Z Starting comparison with reference directory: /tmp/test-ref-malformed
2025-06-13T05:43:04.2727790Z Found 1 policies in Entra export
2025-06-13T05:43:04.2728301Z Validating reference files...
2025-06-13T05:43:04.2728909Z Validating reference directory: /tmp/test-ref-malformed
2025-06-13T05:43:04.2729621Z Validating 3 policy files using parallel processing...
2025-06-13T05:43:04.2760395Z Validation completed: 0 valid, 3 invalid files
2025-06-13T05:43:04.2760954Z Processing time: 1ms
2025-06-13T05:43:04.2761395Z Average speed: 2524.6 files/second
2025-06-13T05:43:04.2762225Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-13T05:43:04.2763245Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-13T05:43:04.2764148Z       Suggestion: Ensure the JSON is well-formed. Check for missing commas, brackets, or quotes.
2025-06-13T05:43:04.2765156Z       Suggestion: Ensure the JSON is well-formed. Check for missing commas, brackets, or quotes.
2025-06-13T05:43:04.2766348Z Loading 3 reference policy files using parallel processing...
2025-06-13T05:43:04.2767206Z Reference file validation failed. Found 3 invalid files out of 3.
2025-06-13T05:43:04.2768102Z   ✗ valid-policy.json: 2 errors
2025-06-13T05:43:04.2769028Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-13T05:43:04.2770068Z     - Display name is missing or empty.
2025-06-13T05:43:04.2770704Z   ✗ incomplete.json: 1 errors
2025-06-13T05:43:04.2771601Z     - Invalid JSON syntax: Unexpected character encountered while parsing value: i. Path 'name', line 1, position 10. (line 1)
2025-06-13T05:43:04.2772990Z   ✗ malformed.json: 1 errors
2025-06-13T05:43:04.2773950Z     - Invalid JSON syntax: Invalid character after parsing property name. Expected ':' but got: j. Path '', line 1, position 10. (line 1)
2025-06-13T05:43:04.2798939Z Loading reference files: Progress: 1/3 (33.3%) - 230.1 items/sec, ETA: 00:00
2025-06-13T05:43:04.2799949Z Loading reference files: Progress: 2/3 (66.7%) - 392.6 items/sec, ETA: 00:00
2025-06-13T05:43:04.2876704Z Loading reference files: Progress: 3/3 (100.0%) - 563.4 items/sec, ETA: 00:00
2025-06-13T05:43:04.2908031Z Failed to load reference file 'malformed.json': Invalid character after parsing property name. Expected ':' but got: j. Path '', line 1, position 10.
2025-06-13T05:43:04.2911524Z   Invalid JSON syntax at line 1, position 10
2025-06-13T05:43:04.2914761Z Failed to load reference file 'incomplete.json': Unexpected character encountered while parsing value: i. Path 'name', line 1, position 10.
2025-06-13T05:43:04.2923627Z   Invalid JSON syntax at line 1, position 10
2025-06-13T05:43:04.2924390Z   Suggestion: Check the JSON structure for missing commas, brackets, or quotes.
2025-06-13T05:43:04.2925539Z   Suggestion: Check the JSON structure for missing commas, brackets, or quotes.
2025-06-13T05:43:04.2926366Z Reference file loading completed: 1 files loaded successfully
2025-06-13T05:43:04.2926937Z Processing time: 15ms
2025-06-13T05:43:04.2927342Z Average speed: 202.2 files/second
2025-06-13T05:43:04.2927807Z Found 1 reference policy files
2025-06-13T05:43:04.2951408Z Starting comparison with reference directory: /tmp/test-ref-both-empty
2025-06-13T05:43:04.2952403Z Found 0 policies in Entra export
2025-06-13T05:43:04.2953021Z Validating reference files...
2025-06-13T05:43:04.2953792Z Validating reference directory: /tmp/test-ref-both-empty
2025-06-13T05:43:04.2954960Z No JSON files found in directory: /tmp/test-ref-both-empty. No files were processed.
2025-06-13T05:43:04.2964057Z ✓ All 0 reference files are valid
2025-06-13T05:43:04.2965200Z No JSON files found in reference directory '/tmp/test-ref-both-empty'
2025-06-13T05:43:04.2966206Z Found 0 reference policy files
2025-06-13T05:43:04.2967915Z Starting cross-format comparison between '/tmp/CrossFormatIntegrationTests_301b901c/source' and '/tmp/CrossFormatIntegrationTests_301b901c/reference'
2025-06-13T05:43:04.2984885Z Starting comparison with reference directory: /tmp/test-ref-case-sensitive
2025-06-13T05:43:04.2992227Z Found 1 policies in Entra export
2025-06-13T05:43:04.3026293Z Validating reference files...
2025-06-13T05:43:04.3027242Z Validating reference directory: /tmp/test-ref-case-sensitive
2025-06-13T05:43:04.3028161Z Validating 1 policy files using parallel processing...
2025-06-13T05:43:04.3029719Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithMinimalPolicy_ShouldGenerateCorrectHCL [8 ms]
2025-06-13T05:43:04.3032303Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformDirectoryAsync_DirectoryWithSubdirectories_ShouldParseRecursively [12 ms]
2025-06-13T05:43:04.3034736Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithSessionControls_ShouldMapCorrectly [22 ms]
2025-06-13T05:43:04.3037354Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceIntegrationTests.CompareLargeNumberOfPolicies_ShouldPerformWithinReasonableTime [426 ms]
2025-06-13T05:43:04.3041120Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_ReferenceDirectoryWithMalformedJson_ShouldSkipMalformedFiles [32 ms]
2025-06-13T05:43:04.3043170Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_BothEmpty_ShouldReturnEmptyResult [5 ms]
2025-06-13T05:43:04.3044391Z Validation completed: 0 valid, 1 invalid files
2025-06-13T05:43:04.3044939Z Processing time: 1ms
2025-06-13T05:43:04.3045511Z Average speed: 714.5 files/second
2025-06-13T05:43:04.3046294Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-13T05:43:04.3047509Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-13T05:43:04.3049401Z Loading 1 reference policy files using parallel processing...
2025-06-13T05:43:04.3050168Z Reference file validation failed. Found 1 invalid files out of 1.
2025-06-13T05:43:04.3050947Z   ✗ policy1.json: 2 errors
2025-06-13T05:43:04.3051840Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-13T05:43:04.3052760Z     - Display name is missing or empty.
2025-06-13T05:43:04.3053520Z Loading reference files: Progress: 1/1 (100.0%) - 550.7 items/sec, ETA: 00:00
2025-06-13T05:43:04.3054378Z Reference file loading completed: 1 files loaded successfully
2025-06-13T05:43:04.3058942Z Processing time: 3ms
2025-06-13T05:43:04.3059369Z Average speed: 365.4 files/second
2025-06-13T05:43:04.3059834Z Found 1 reference policy files
2025-06-13T05:43:04.3060583Z Found 2 source policies (Json) and 2 reference policies (Terraform)
2025-06-13T05:43:04.3078970Z Starting cross-format comparison between '/tmp/CrossFormatTests_0b4853a2/source' and '/tmp/CrossFormatTests_0b4853a2/reference'
2025-06-13T05:43:04.3120169Z Starting comparison with reference directory: dummy-path
2025-06-13T05:43:04.3132146Z Starting cross-format comparison between '/tmp/CrossFormatIntegrationTests_6d298bf4/source' and '/tmp/CrossFormatIntegrationTests_6d298bf4/reference'
2025-06-13T05:43:04.3140249Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-13T05:43:04.3163661Z Converting policies: Progress: 1/1 (100.0%) - 418.7 items/sec, ETA: 00:00
2025-06-13T05:43:04.3178741Z Policy conversion completed in 3ms
2025-06-13T05:43:04.3188535Z Average speed: 371.2 policies/second
2025-06-13T05:43:04.3192824Z Starting comparison with reference directory: /tmp/test-ref-custom-mapping-missing
2025-06-13T05:43:04.3201314Z Found 1 policies in Entra export
2025-06-13T05:43:04.3212121Z Validating reference files...
2025-06-13T05:43:04.3215841Z Validating reference directory: /tmp/test-ref-custom-mapping-missing
2025-06-13T05:43:04.3222908Z No JSON files found in directory: /tmp/test-ref-custom-mapping-missing. No files were processed.
2025-06-13T05:43:04.3223986Z ✓ All 0 reference files are valid
2025-06-13T05:43:04.3224779Z No JSON files found in reference directory '/tmp/test-ref-custom-mapping-missing'
2025-06-13T05:43:04.3225981Z Found 0 reference policy files
2025-06-13T05:43:04.3227988Z Starting comparison with reference directory: dummy-path
2025-06-13T05:43:04.3230577Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_TfStateWithNoResources_ShouldReturnEmpty [14 ms]
2025-06-13T05:43:04.3234772Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_GrantControls_ShouldMapCorrectly [81 ms]
2025-06-13T05:43:04.3237252Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithInvalidJson_ShouldHandleErrorGracefully [11 ms]
2025-06-13T05:43:04.3239364Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_CaseSensitiveTrue_DifferentCase_ShouldNotMatch [12 ms]
2025-06-13T05:43:04.3263183Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceIntegrationTests.CompareWithCustomMappings_ComplexScenario_ShouldFollowMappings [19 ms]
2025-06-13T05:43:04.3358508Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithGrantControls_ShouldMapCorrectly [12 ms]
2025-06-13T05:43:04.3361984Z Found 4 source policies (Json) and 4 reference policies (Terraform)
2025-06-13T05:43:04.3362784Z Starting comparison with reference directory: dummy-path
2025-06-13T05:43:04.3363155Z Found 0 policies in Entra export
2025-06-13T05:43:04.3363448Z Validating reference files...
2025-06-13T05:43:04.3363729Z Validating reference directory: dummy-path
2025-06-13T05:43:04.3364282Z Found 0 reference policy files
2025-06-13T05:43:04.3364625Z Reference file validation failed. Found 0 invalid files out of 0.
2025-06-13T05:43:04.3365589Z Reference directory 'dummy-path' does not exist
2025-06-13T05:43:04.3366267Z Starting comparison with reference directory: dummy-path
2025-06-13T05:43:04.3366833Z Found 1 policies in Entra export
2025-06-13T05:43:04.3367259Z Validating reference files...
2025-06-13T05:43:04.3367716Z Validating reference directory: dummy-path
2025-06-13T05:43:04.3368232Z Found 0 reference policy files
2025-06-13T05:43:04.3368846Z Reference file validation failed. Found 0 invalid files out of 0.
2025-06-13T05:43:04.3369527Z Reference directory 'dummy-path' does not exist
2025-06-13T05:43:04.3370815Z Starting cross-format comparison between '/tmp/CrossFormatIntegrationTests_8368b0f0/source' and '/tmp/CrossFormatIntegrationTests_8368b0f0/reference'
2025-06-13T05:43:04.3372387Z Starting comparison with reference directory: /tmp/test-ref-dir
2025-06-13T05:43:04.3373035Z Found 0 policies in Entra export
2025-06-13T05:43:04.3373466Z Validating reference files...
2025-06-13T05:43:04.3373972Z Validating reference directory: /tmp/test-ref-dir
2025-06-13T05:43:04.3374670Z No JSON files found in directory: /tmp/test-ref-dir. No files were processed.
2025-06-13T05:43:04.3375817Z ✓ All 0 reference files are valid
2025-06-13T05:43:04.3376464Z No JSON files found in reference directory '/tmp/test-ref-dir'
2025-06-13T05:43:04.3377056Z Found 0 reference policy files
2025-06-13T05:43:04.3377680Z Starting comparison with reference directory: /tmp/test-ref-mixed-files
2025-06-13T05:43:04.3378336Z Found 1 policies in Entra export
2025-06-13T05:43:04.3378759Z Validating reference files...
2025-06-13T05:43:04.3379303Z Validating reference directory: /tmp/test-ref-mixed-files
2025-06-13T05:43:04.3379974Z Validating 1 policy files using parallel processing...
2025-06-13T05:43:04.3380568Z Validation completed: 0 valid, 1 invalid files
2025-06-13T05:43:04.3381030Z Processing time: 2ms
2025-06-13T05:43:04.3381424Z Average speed: 568.8 files/second
2025-06-13T05:43:04.3382136Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-13T05:43:04.3382999Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-13T05:43:04.3383731Z Loading 1 reference policy files using parallel processing...
2025-06-13T05:43:04.3384474Z Reference file validation failed. Found 1 invalid files out of 1.
2025-06-13T05:43:04.3385123Z   ✗ valid-policy.json: 2 errors
2025-06-13T05:43:04.3386131Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-13T05:43:04.3387000Z     - Display name is missing or empty.
2025-06-13T05:43:04.3387732Z Loading reference files: Progress: 1/1 (100.0%) - 3225.8 items/sec, ETA: 00:00
2025-06-13T05:43:04.3388546Z Reference file loading completed: 1 files loaded successfully
2025-06-13T05:43:04.3389108Z Processing time: 0ms
2025-06-13T05:43:04.3389481Z Average speed: 2749.5 files/second
2025-06-13T05:43:04.3389906Z Found 1 reference policy files
2025-06-13T05:43:04.3390500Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-13T05:43:04.3391791Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.ParseEntraExport_InvalidJsonString_ShouldThrowException [7 ms]
2025-06-13T05:43:04.3393704Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_CustomMapping_NonExistentReference_ShouldReportAsEntraOnly [1 ms]
2025-06-13T05:43:04.3395770Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.ParseEntraExport_NullInput_ShouldThrowException [1 ms]
2025-06-13T05:43:04.3397721Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithGenerateVariables_ShouldCreateVariablesFile [8 ms]
2025-06-13T05:43:04.3399738Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.ParseEntraExport_EmptyPoliciesArray_ShouldHandleGracefully [2 ms]
2025-06-13T05:43:04.3401972Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceIntegrationTests.CompareMixedFormats_MultiplePolicies_ShouldHandleAllCombinations [13 ms]
2025-06-13T05:43:04.3404093Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.ParseEntraExport_MissingTenantId_ShouldUseEmptyString [2 ms]
2025-06-13T05:43:04.3406007Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_ShouldSetReferenceDirectoryCorrectly [2 ms]
2025-06-13T05:43:04.3484959Z Starting comparison with reference directory: dummy-path
2025-06-13T05:43:04.3533357Z Found 0 policies in Entra export
2025-06-13T05:43:04.3534008Z Validating reference files...
2025-06-13T05:43:04.3534598Z Validating reference directory: dummy-path
2025-06-13T05:43:04.3535112Z Found 0 reference policy files
2025-06-13T05:43:04.3596367Z Reference file validation failed. Found 0 invalid files out of 0.
2025-06-13T05:43:04.3597387Z Reference directory 'dummy-path' does not exist
2025-06-13T05:43:04.3599009Z Starting cross-format comparison between '/tmp/CrossFormatIntegrationTests_6cf62cad/source' and '/tmp/CrossFormatIntegrationTests_6cf62cad/reference'
2025-06-13T05:43:04.3600780Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-13T05:43:04.3602278Z Starting cross-format comparison between '/tmp/CrossFormatIntegrationTests_a0f85ba1/source' and '/tmp/CrossFormatIntegrationTests_a0f85ba1/reference'
2025-06-13T05:43:04.3603651Z Found 0 source policies (Mixed) and 0 reference policies (Mixed)
2025-06-13T05:43:04.3657598Z Starting cross-format comparison between '/tmp/CrossFormatIntegrationTests_e7926e34/source' and '/tmp/CrossFormatIntegrationTests_e7926e34/reference'
2025-06-13T05:43:04.3675084Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-13T05:43:04.3761465Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-13T05:43:04.3762540Z Converting policies: Progress: 1/1 (100.0%) - 1592.1 items/sec, ETA: 00:00
2025-06-13T05:43:04.3763237Z Policy conversion completed in 1ms
2025-06-13T05:43:04.3763725Z Average speed: 1468.2 policies/second
2025-06-13T05:43:04.3764508Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-13T05:43:04.3765650Z Converting policies: Progress: 1/1 (100.0%) - 16366.6 items/sec, ETA: 00:00
2025-06-13T05:43:04.3766332Z Policy conversion completed in 0ms
2025-06-13T05:43:04.3766806Z Average speed: 5848.0 policies/second
2025-06-13T05:43:04.3767572Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-13T05:43:04.3768538Z Converting policies: Progress: 1/1 (100.0%) - 7220.2 items/sec, ETA: 00:00
2025-06-13T05:43:04.3773165Z Policy conversion completed in 0ms
2025-06-13T05:43:04.3773739Z Average speed: 3087.4 policies/second
2025-06-13T05:43:04.3774619Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-13T05:43:04.3776100Z Converting policies: Progress: 1/1 (100.0%) - 15267.2 items/sec, ETA: 00:00
2025-06-13T05:43:04.3777081Z Policy conversion completed in 0ms
2025-06-13T05:43:04.3777625Z Average speed: 4543.4 policies/second
2025-06-13T05:43:04.3781966Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_ReferenceDirectoryWithNonJsonFiles_ShouldIgnoreNonJsonFiles [6 ms]
2025-06-13T05:43:04.3784206Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceIntegrationTests.CompareWithMixedFileTypes_ShouldIgnoreNonPolicyFiles [12 ms]
2025-06-13T05:43:04.3786729Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.ParseEntraExport_MissingPoliciesProperty_ShouldHandleGracefully [10 ms]
2025-06-13T05:43:04.3788866Z   Passed ConditionalAccessExporter.Tests.ParallelProcessingServiceTests.ProcessInParallelAsync_WithCancellation_ThrowsOperationCancelledException [116 ms]
2025-06-13T05:43:04.3791460Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceIntegrationTests.CompareComplexPolicies_MultipleConditionsAndControls_ShouldAnalyzeCorrectly [11 ms]
2025-06-13T05:43:04.3794420Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceIntegrationTests.CompareWithEmptyDirectories_ShouldHandleGracefully [2 ms]
2025-06-13T05:43:04.3796756Z   Passed ConditionalAccessExporter.Tests.ParallelProcessingServiceTests.ProcessFilesInParallelAsync_WithTestFiles_ProcessesCorrectly [20 ms]
2025-06-13T05:43:04.3798061Z   Standard Output Messages:
2025-06-13T05:43:04.3798575Z  Processed 5 files with 5 progress reports
2025-06-13T05:43:04.3798911Z 
2025-06-13T05:43:04.3798930Z 
2025-06-13T05:43:04.3799391Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-13T05:43:04.3800305Z Starting comparison with reference directory: /tmp/test-ref-complex
2025-06-13T05:43:04.3801057Z Found 1 policies in Entra export
2025-06-13T05:43:04.3801785Z Validating reference files...
2025-06-13T05:43:04.3802323Z Validating reference directory: /tmp/test-ref-complex
2025-06-13T05:43:04.3803049Z Validating 1 policy files using parallel processing...
2025-06-13T05:43:04.3805888Z Converting policies: Progress: 1/1 (100.0%) - 4570.4 items/sec, ETA: 00:00
2025-06-13T05:43:04.3806767Z Policy conversion completed in 1ms
2025-06-13T05:43:04.3808555Z Average speed: 1725.0 policies/second
2025-06-13T05:43:04.3830360Z Validation completed: 0 valid, 1 invalid files
2025-06-13T05:43:04.3830923Z Processing time: 1ms
2025-06-13T05:43:04.3831330Z Average speed: 1563.0 files/second
2025-06-13T05:43:04.3896217Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-13T05:43:04.3897163Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-13T05:43:04.3897976Z Reference file validation failed. Found 1 invalid files out of 1.
2025-06-13T05:43:04.3898918Z   ✗ complex-policy.json: 2 errors
2025-06-13T05:43:04.3899884Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-13T05:43:04.3900873Z     - Display name is missing or empty.
2025-06-13T05:43:04.3901555Z Loading 1 reference policy files using parallel processing...
2025-06-13T05:43:04.3902445Z Loading reference files: Progress: 1/1 (100.0%) - 3284.1 items/sec, ETA: 00:00
2025-06-13T05:43:04.3903277Z Reference file loading completed: 1 files loaded successfully
2025-06-13T05:43:04.3903835Z Processing time: 0ms
2025-06-13T05:43:04.3904230Z Average speed: 2268.1 files/second
2025-06-13T05:43:04.3904665Z Found 1 reference policy files
2025-06-13T05:43:04.3905113Z No Terraform policies found to convert.
2025-06-13T05:43:04.3906066Z Converting 2 Terraform policies to Graph JSON format using parallel processing...
2025-06-13T05:43:04.3906992Z Converting policies: Progress: 1/2 (50.0%) - 4721.4 items/sec, ETA: 00:00
2025-06-13T05:43:04.3907671Z Policy conversion completed in 1ms
2025-06-13T05:43:04.3908148Z Average speed: 3882.7 policies/second
2025-06-13T05:43:04.3908907Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-13T05:43:04.3909864Z Converting policies: Progress: 2/2 (100.0%) - 7595.9 items/sec, ETA: 00:00
2025-06-13T05:43:04.3910784Z Converting policies: Progress: 1/1 (100.0%) - 3268.0 items/sec, ETA: 00:00
2025-06-13T05:43:04.3911471Z Policy conversion completed in 0ms
2025-06-13T05:43:04.3911958Z Average speed: 2252.3 policies/second
2025-06-13T05:43:04.3912582Z Starting comparison with reference directory: dummy-path
2025-06-13T05:43:04.3913474Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-13T05:43:04.3914439Z Converting policies: Progress: 1/1 (100.0%) - 4601.9 items/sec, ETA: 00:00
2025-06-13T05:43:04.3915117Z Found 1 policies in Entra export
2025-06-13T05:43:04.3915782Z Validating reference files...
2025-06-13T05:43:04.3916283Z Validating reference directory: dummy-path
2025-06-13T05:43:04.3916806Z Found 0 reference policy files
2025-06-13T05:43:04.3917424Z Reference file validation failed. Found 0 invalid files out of 0.
2025-06-13T05:43:04.3918397Z Reference directory 'dummy-path' does not exist
2025-06-13T05:43:04.3918974Z Policy conversion completed in 1ms
2025-06-13T05:43:04.3919454Z Average speed: 733.1 policies/second
2025-06-13T05:43:04.3942584Z Starting comparison with reference directory: /tmp/test-ref-empty-entra
2025-06-13T05:43:04.3965522Z Found 0 policies in Entra export
2025-06-13T05:43:04.3980654Z Validating reference files...
2025-06-13T05:43:04.3981854Z Validating reference directory: /tmp/test-ref-empty-entra
2025-06-13T05:43:04.3983358Z Validating 1 policy files using parallel processing...
2025-06-13T05:43:04.3984502Z Validation completed: 0 valid, 1 invalid files
2025-06-13T05:43:04.3985835Z Processing time: 1ms
2025-06-13T05:43:04.3987880Z Average speed: 691.0 files/second
2025-06-13T05:43:04.3992920Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-13T05:43:04.3994161Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-13T05:43:04.3994961Z Reference file validation failed. Found 1 invalid files out of 1.
2025-06-13T05:43:04.3995948Z   ✗ policy1.json: 2 errors
2025-06-13T05:43:04.3996788Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-13T05:43:04.3997683Z     - Display name is missing or empty.
2025-06-13T05:43:04.3998393Z Loading 1 reference policy files using parallel processing...
2025-06-13T05:43:04.3999249Z Loading reference files: Progress: 1/1 (100.0%) - 933.9 items/sec, ETA: 00:00
2025-06-13T05:43:04.4000854Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_SingleFullyPopulatedPolicy_ShouldConvertSuccessfully [71 ms]
2025-06-13T05:43:04.4003401Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceIntegrationTests.CompareWithDifferentNamingConventions_ShouldDetectSimilarPolicies [12 ms]
2025-06-13T05:43:04.4006381Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_DifferentStates_ShouldMapCorrectly(terraformState: "enabled", expectedState: "enabled") [2 ms]
2025-06-13T05:43:04.4009233Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_DifferentStates_ShouldMapCorrectly(terraformState: "invalid", expectedState: "disabled") [< 1 ms]
2025-06-13T05:43:04.4012392Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_DifferentStates_ShouldMapCorrectly(terraformState: "enabledForReportingButNotEnforced", expectedState: "enabledForReportingButNotEnforced") [< 1 ms]
2025-06-13T05:43:04.4015788Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_DifferentStates_ShouldMapCorrectly(terraformState: null, expectedState: "disabled") [< 1 ms]
2025-06-13T05:43:04.4018623Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_DifferentStates_ShouldMapCorrectly(terraformState: "disabled", expectedState: "disabled") [1 ms]
2025-06-13T05:43:04.4021153Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_EmptyPoliciesList_ShouldReturnEmptyList [2 ms]
2025-06-13T05:43:04.4023345Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_PolicyConversionFailure_ShouldContinueWithOthers [1 ms]
2025-06-13T05:43:04.4024975Z Reference file loading completed: 1 files loaded successfully
2025-06-13T05:43:04.4025860Z Processing time: 1ms
2025-06-13T05:43:04.4026282Z Average speed: 885.0 files/second
2025-06-13T05:43:04.4026766Z Found 1 reference policy files
2025-06-13T05:43:04.4027532Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-13T05:43:04.4028529Z Starting comparison with reference directory: /tmp/non-existent-directory
2025-06-13T05:43:04.4029521Z Converting policies: Progress: 1/1 (100.0%) - 10362.7 items/sec, ETA: 00:00
2025-06-13T05:43:04.4030501Z Policy conversion completed in 1ms
2025-06-13T05:43:04.4031017Z Average speed: 1732.8 policies/second
2025-06-13T05:43:04.4031526Z Found 1 policies in Entra export
2025-06-13T05:43:04.4031984Z Validating reference files...
2025-06-13T05:43:04.4032616Z Validating reference directory: /tmp/non-existent-directory
2025-06-13T05:43:04.4033446Z Reference file validation failed. Found 0 invalid files out of 0.
2025-06-13T05:43:04.4034283Z Reference directory '/tmp/non-existent-directory' does not exist
2025-06-13T05:43:04.4034927Z Found 0 reference policy files
2025-06-13T05:43:04.4249327Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-13T05:43:04.4252191Z Converting policies: Progress: 1/1 (100.0%) - 5165.3 items/sec, ETA: 00:00
2025-06-13T05:43:04.4254235Z Policy conversion completed in 0ms
2025-06-13T05:43:04.4256764Z Average speed: 3958.8 policies/second
2025-06-13T05:43:04.4264559Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-13T05:43:04.4275795Z Converting policies: Progress: 1/1 (100.0%) - 3330.0 items/sec, ETA: 00:00
2025-06-13T05:43:04.4276997Z Policy conversion completed in 0ms
2025-06-13T05:43:04.4278824Z Average speed: 2708.6 policies/second
2025-06-13T05:43:04.4297279Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_ComplexNestedDifferences_ShouldDetectCorrectly [40 ms]
2025-06-13T05:43:04.4309102Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_UnresolvedVariables_ShouldGenerateWarnings [3 ms]
2025-06-13T05:43:04.4311164Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.ParseEntraExport_ValidJsonString_ShouldParseCorrectly [3 ms]
2025-06-13T05:43:04.4313188Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_NullNestedObjects_ShouldHandleGracefully [4 ms]
2025-06-13T05:43:04.4315421Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_EmptyEntraExport_ShouldReportAllAsReferenceOnly [7 ms]
2025-06-13T05:43:04.4317391Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_NonExistentReferenceDirectory_ShouldHandleGracefully [1 ms]
2025-06-13T05:43:04.4319634Z   Passed ConditionalAccessExporter.Tests.ParallelProcessingServiceTests.ProcessInParallelAsync_WithErrorsAndContinueOnError_HandlesErrorsGracefully [36 ms]
2025-06-13T05:43:04.4321036Z   Standard Output Messages:
2025-06-13T05:43:04.4321490Z  Successfully processed 7 out of 10 items
2025-06-13T05:43:04.4321951Z  Errors encountered: 3
2025-06-13T05:43:04.4322190Z 
2025-06-13T05:43:04.4322200Z 
2025-06-13T05:43:04.4323147Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_UsersConditions_ShouldMapCorrectly [31 ms]
2025-06-13T05:43:04.4393066Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-13T05:43:04.4394069Z Converting policies: Progress: 1/1 (100.0%) - 11086.5 items/sec, ETA: 00:00
2025-06-13T05:43:04.4395198Z Policy conversion completed in 0ms
2025-06-13T05:43:04.4400027Z Average speed: 7974.5 policies/second
2025-06-13T05:43:04.4533719Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-13T05:43:04.4534978Z Converting policies: Progress: 1/1 (100.0%) - 12484.4 items/sec, ETA: 00:00
2025-06-13T05:43:04.4591036Z Policy conversion completed in 0ms
2025-06-13T05:43:04.4596103Z Average speed: 4690.4 policies/second
2025-06-13T05:43:04.4706428Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-13T05:43:04.4714414Z Converting policies: Progress: 1/1 (100.0%) - 2923.1 items/sec, ETA: 00:00
2025-06-13T05:43:04.4715863Z Policy conversion completed in 0ms
2025-06-13T05:43:04.4716492Z Average speed: 2345.2 policies/second
2025-06-13T05:43:04.4750329Z Converting 3 Terraform policies to Graph JSON format using parallel processing...
2025-06-13T05:43:04.4762060Z Converting policies: Progress: 1/3 (33.3%) - 4771.0 items/sec, ETA: 00:00
2025-06-13T05:43:04.4774462Z Converting policies: Progress: 2/3 (66.7%) - 7150.5 items/sec, ETA: 00:00
2025-06-13T05:43:04.4781151Z Converting policies: Progress: 3/3 (100.0%) - 4845.0 items/sec, ETA: 00:00
2025-06-13T05:43:04.4781903Z Policy conversion completed in 1ms
2025-06-13T05:43:04.4782433Z Average speed: 2719.9 policies/second
2025-06-13T05:43:04.4837825Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_DataSourceReferences_ShouldGenerateWarnings [1 ms]
2025-06-13T05:43:04.4846243Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_ClientApplicationsConditions_ShouldMapCorrectly [11 ms]
2025-06-13T05:43:04.4849739Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_PlatformsConditions_ShouldMapCorrectly [14 ms]
2025-06-13T05:43:04.4853270Z   Passed ConditionalAccessExporter.Tests.ParallelProcessingServiceTests.ProcessInParallelAsync_WithValidItems_ProcessesSuccessfully [49 ms]
2025-06-13T05:43:04.4856808Z   Standard Output Messages:
2025-06-13T05:43:04.4857226Z  Processed 10 items in 43.4476ms
2025-06-13T05:43:04.4857645Z  Average speed: 230.16 items/second
2025-06-13T05:43:04.4858349Z 
2025-06-13T05:43:04.4859593Z 
2025-06-13T05:43:04.4860599Z   Passed ConditionalAccessExporter.Tests.ParallelProcessingServiceTests.GetOptimalDegreeOfParallelism_ReturnsReasonableValue [< 1 ms]
2025-06-13T05:43:04.4861773Z   Standard Output Messages:
2025-06-13T05:43:04.4862194Z  Optimal parallelism: 3 (System cores: 4)
2025-06-13T05:43:04.4862514Z 
2025-06-13T05:43:04.4862522Z 
2025-06-13T05:43:04.4863465Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_ApplicationsConditions_ShouldMapCorrectly [19 ms]
2025-06-13T05:43:04.4865667Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_LocalResolution_ShouldResolveCorrectly [3 ms]
2025-06-13T05:43:04.4867114Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_MultiplePolicies_ShouldConvertAll [5 ms]
2025-06-13T05:43:04.4868647Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-13T05:43:04.4869606Z Converting policies: Progress: 1/1 (100.0%) - 1397.0 items/sec, ETA: 00:00
2025-06-13T05:43:04.4870302Z Policy conversion completed in 1ms
2025-06-13T05:43:04.4870813Z Average speed: 1271.8 policies/second
2025-06-13T05:43:04.5029055Z Found 100 source policies (Json) and 100 reference policies (Terraform)
2025-06-13T05:43:04.5092883Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-13T05:43:04.5095577Z Converting policies: Progress: 1/1 (100.0%) - 1184.4 items/sec, ETA: 00:00
2025-06-13T05:43:04.5096429Z Policy conversion completed in 1ms
2025-06-13T05:43:04.5096940Z Average speed: 1091.8 policies/second
2025-06-13T05:43:04.5132905Z [xUnit.net 00:00:01.09]     ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_LargeNumberOfPolicies_ShouldHandleEfficiently [FAIL]
2025-06-13T05:43:04.5136460Z [xUnit.net 00:00:01.09]       Expected matching policies but found: Matching=0, SemanticallyEquivalent=0
2025-06-13T05:43:04.5137287Z [xUnit.net 00:00:01.09]       Stack Trace:
2025-06-13T05:43:04.5139334Z [xUnit.net 00:00:01.09]         /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/PolicyAssertions.cs(52,0): at ConditionalAccessExporter.Tests.PolicyAssertions.AssertHasMatchingPolicies(CrossFormatComparisonSummary summary)
2025-06-13T05:43:04.5143187Z [xUnit.net 00:00:01.09]         /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/CrossFormatPolicyComparisonServiceTests.cs(537,0): at ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_LargeNumberOfPolicies_ShouldHandleEfficiently()
2025-06-13T05:43:04.5145926Z [xUnit.net 00:00:01.09]         --- End of stack trace from previous location ---
2025-06-13T05:43:04.5152953Z Starting cross-format comparison between '/tmp/CrossFormatTests_feeede15/source' and '/tmp/CrossFormatTests_feeede15/reference'
2025-06-13T05:43:04.5155736Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-13T05:43:04.5167299Z Starting cross-format comparison between '/tmp/CrossFormatTests_23e661c2/source' and '/tmp/CrossFormatTests_23e661c2/reference'
2025-06-13T05:43:04.5168650Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-13T05:43:04.5169524Z Found 1 source policies (Json) and 0 reference policies (Mixed)
2025-06-13T05:43:04.5170393Z Converting policies: Progress: 1/1 (100.0%) - 4366.8 items/sec, ETA: 00:00
2025-06-13T05:43:04.5171108Z Policy conversion completed in 0ms
2025-06-13T05:43:04.5171615Z Average speed: 2136.8 policies/second
2025-06-13T05:43:04.5192540Z Starting cross-format comparison between '/tmp/CrossFormatTests_ed77d0b0/source' and '/tmp/CrossFormatTests_ed77d0b0/reference'
2025-06-13T05:43:04.5224720Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-13T05:43:04.5232820Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-13T05:43:04.5251162Z Starting cross-format comparison between '/tmp/CrossFormatTests_6aafe2b3/source' and '/tmp/CrossFormatTests_6aafe2b3/reference'
2025-06-13T05:43:04.5252730Z Converting policies: Progress: 1/1 (100.0%) - 806.2 items/sec, ETA: 00:00
2025-06-13T05:43:04.5254295Z Policy conversion completed in 1ms
2025-06-13T05:43:04.5255126Z Average speed: 760.4 policies/second
2025-06-13T05:43:04.5257030Z Warning: Failed to load JSON file '/tmp/CrossFormatTests_6aafe2b3/source/malformed.json': Invalid character after parsing property name. Expected ':' but got: j. Path '', line 1, position 10.
2025-06-13T05:43:04.5274311Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_SessionControls_ShouldMapCorrectly [28 ms]
2025-06-13T05:43:04.5281326Z   Failed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_LargeNumberOfPolicies_ShouldHandleEfficiently [247 ms]
2025-06-13T05:43:04.5282809Z   Error Message:
2025-06-13T05:43:04.5283441Z    Expected matching policies but found: Matching=0, SemanticallyEquivalent=0
2025-06-13T05:43:04.5287898Z   Stack Trace:
2025-06-13T05:43:04.5289543Z      at ConditionalAccessExporter.Tests.PolicyAssertions.AssertHasMatchingPolicies(CrossFormatComparisonSummary summary) in /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/PolicyAssertions.cs:line 52
2025-06-13T05:43:04.5296807Z    at ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_LargeNumberOfPolicies_ShouldHandleEfficiently() in /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/CrossFormatPolicyComparisonServiceTests.cs:line 537
2025-06-13T05:43:04.5298951Z --- End of stack trace from previous location ---
2025-06-13T05:43:04.5300243Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_ClientAppTypes_ShouldMapCorrectly [7 ms]
2025-06-13T05:43:04.5302298Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_ReadOnlyFileSystem_ShouldNotThrow [3 ms]
2025-06-13T05:43:04.5304507Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_EmptyReferenceDirectory_ShouldHandleGracefully [3 ms]
2025-06-13T05:43:04.5306918Z   Passed ConditionalAccessExporter.Tests.ParallelProcessingServiceTests.ProcessInParallelAsync_WithProgressReporting_ReportsProgressCorrectly [62 ms]
2025-06-13T05:43:04.5308255Z   Standard Output Messages:
2025-06-13T05:43:04.5308792Z  Progress: Progress: 5/20 (25.0%) - 185.7 items/sec, ETA: 00:00
2025-06-13T05:43:04.5309507Z  Progress: Progress: 10/20 (50.0%) - 269.6 items/sec, ETA: 00:00
2025-06-13T05:43:04.5310236Z  Progress: Progress: 15/20 (75.0%) - 317.4 items/sec, ETA: 00:00
2025-06-13T05:43:04.5311212Z  Progress: Progress: 20/20 (100.0%) - 345.3 items/sec, ETA: 00:00
2025-06-13T05:43:04.5311802Z  Received 4 progress reports
2025-06-13T05:43:04.5312230Z 
2025-06-13T05:43:04.5312246Z 
2025-06-13T05:43:04.5313218Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_SpecialValues_ShouldMapCorrectly [6 ms]
2025-06-13T05:43:04.5323447Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_CustomMapping_ShouldUseCustomMappings [5 ms]
2025-06-13T05:43:04.5325717Z Found 1 source policies (Json) and 0 reference policies (Mixed)
2025-06-13T05:43:04.5327229Z Starting cross-format comparison between '/tmp/CrossFormatTests_3f2bf997/source' and '/tmp/CrossFormatTests_3f2bf997/reference'
2025-06-13T05:43:04.5328481Z Found 0 source policies (Mixed) and 1 reference policies (Terraform)
2025-06-13T05:43:04.5330028Z Starting cross-format comparison between '/tmp/CrossFormatTests_880cdd8f/source' and '/tmp/CrossFormatTests_880cdd8f/reference'
2025-06-13T05:43:04.5339790Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-13T05:43:04.5360954Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-13T05:43:04.5375848Z Converting policies: Progress: 1/1 (100.0%) - 954.2 items/sec, ETA: 00:00
2025-06-13T05:43:04.5376610Z Policy conversion completed in 1ms
2025-06-13T05:43:04.5377165Z Average speed: 831.9 policies/second
2025-06-13T05:43:04.5438653Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-13T05:43:04.5448609Z Converting policies: Progress: 1/1 (100.0%) - 986.8 items/sec, ETA: 00:00
2025-06-13T05:43:04.5449620Z Policy conversion completed in 1ms
2025-06-13T05:43:04.5451652Z Average speed: 828.2 policies/second
2025-06-13T05:43:04.5560959Z Starting cross-format comparison between '/tmp/CrossFormatTests_4ea29c7d/source' and '/tmp/CrossFormatTests_4ea29c7d/reference'
2025-06-13T05:43:04.5902513Z Found 50 source policies (Json) and 50 reference policies (Terraform)
2025-06-13T05:43:04.5958361Z [xUnit.net 00:00:01.17]     ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_PerformanceWithManyComplexPolicies_ShouldCompleteWithinReasonableTime [FAIL]
2025-06-13T05:43:04.5960446Z [xUnit.net 00:00:01.17]       Expected matching policies but found: Matching=0, SemanticallyEquivalent=0
2025-06-13T05:43:04.5961362Z [xUnit.net 00:00:01.17]       Stack Trace:
2025-06-13T05:43:04.5964381Z [xUnit.net 00:00:01.17]         /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/PolicyAssertions.cs(52,0): at ConditionalAccessExporter.Tests.PolicyAssertions.AssertHasMatchingPolicies(CrossFormatComparisonSummary summary)
2025-06-13T05:43:04.5968866Z [xUnit.net 00:00:01.17]         /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/CrossFormatPolicyComparisonServiceTests.cs(707,0): at ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_PerformanceWithManyComplexPolicies_ShouldCompleteWithinReasonableTime()
2025-06-13T05:43:04.5971579Z [xUnit.net 00:00:01.17]         --- End of stack trace from previous location ---
2025-06-13T05:43:04.5972947Z Starting cross-format comparison between '/tmp/CrossFormatTests_61d33df3/source' and '/tmp/CrossFormatTests_61d33df3/nonexistent-reference'
2025-06-13T05:43:04.5974262Z Found 0 source policies (Mixed) and 0 reference policies (Unknown)
2025-06-13T05:43:04.6009680Z Markdown cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/3c87313f-92ba-4388-9295-89631b5a4f67/cross-format-comparison-20250613-054304.md
2025-06-13T05:43:04.6044880Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_MalformedJsonFile_ShouldSkipAndContinue [2 ms]
2025-06-13T05:43:04.6048599Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_ReferenceOnlyPolicy_ShouldReturnReferenceOnlyStatus [3 ms]
2025-06-13T05:43:04.6051079Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_RiskLevels_ShouldMapCorrectly [12 ms]
2025-06-13T05:43:04.6053244Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_ByNameCaseInsensitive_ShouldIgnoreCase [3 ms]
2025-06-13T05:43:04.6055653Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_GeneralStructure_ShouldBeCorrect [9 ms]
2025-06-13T05:43:04.6057857Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_MinimalRequiredFields_ShouldConvertWithDefaults [4 ms]
2025-06-13T05:43:04.6060345Z   Failed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_PerformanceWithManyComplexPolicies_ShouldCompleteWithinReasonableTime [60 ms]
2025-06-13T05:43:04.6062255Z   Error Message:
2025-06-13T05:43:04.6062869Z    Expected matching policies but found: Matching=0, SemanticallyEquivalent=0
2025-06-13T05:43:04.6063584Z   Stack Trace:
2025-06-13T05:43:04.6065197Z      at ConditionalAccessExporter.Tests.PolicyAssertions.AssertHasMatchingPolicies(CrossFormatComparisonSummary summary) in /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/PolicyAssertions.cs:line 52
2025-06-13T05:43:04.6069094Z    at ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_PerformanceWithManyComplexPolicies_ShouldCompleteWithinReasonableTime() in /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/CrossFormatPolicyComparisonServiceTests.cs:line 707
2025-06-13T05:43:04.6071675Z --- End of stack trace from previous location ---
2025-06-13T05:43:04.6073199Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_NonExistentReferenceDirectory_ShouldHandleGracefully [1 ms]
2025-06-13T05:43:04.6075690Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateMarkdownReport_ValidatesMarkdownSyntax [5 ms]
2025-06-13T05:43:04.6152888Z Cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/18d12ed1-2844-42bd-a355-bd2464d35d5a/cross-format-comparison-20250613-054304.json
2025-06-13T05:43:04.6171867Z HTML cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/18d12ed1-2844-42bd-a355-bd2464d35d5a/cross-format-comparison-20250613-054304.html
2025-06-13T05:43:04.6175574Z Markdown cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/18d12ed1-2844-42bd-a355-bd2464d35d5a/cross-format-comparison-20250613-054304.md
2025-06-13T05:43:04.6194183Z CSV cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/18d12ed1-2844-42bd-a355-bd2464d35d5a/cross-format-comparison-20250613-054304.csv
2025-06-13T05:43:04.6234254Z Cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/c243151c-1518-4984-935a-56ec1e1a55cb/cross-format-comparison-20250613-054304.json
2025-06-13T05:43:04.6278967Z Cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/c39bd65e-cdcf-4839-8ecf-63d4df39a69f/cross-format-comparison-20250613-054304.json
2025-06-13T05:43:04.6419232Z HTML cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/69ff9673-ea9c-4a93-af0a-8a3d4d64d147/cross-format-comparison-20250613-054304.html
2025-06-13T05:43:04.6456870Z CSV cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/c9516f1b-15e1-4112-95ae-4047090b9251/cross-format-comparison-20250613-054304.csv
2025-06-13T05:43:04.6461281Z Cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/3c3aa6c1-da5c-4b0d-9fa9-32bdc468b7e3/cross-format-comparison-20250613-054304.json
2025-06-13T05:43:04.6467244Z HTML cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/3c3aa6c1-da5c-4b0d-9fa9-32bdc468b7e3/cross-format-comparison-20250613-054304.html
2025-06-13T05:43:04.6476639Z Markdown cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/3c3aa6c1-da5c-4b0d-9fa9-32bdc468b7e3/cross-format-comparison-20250613-054304.md
2025-06-13T05:43:04.6479255Z CSV cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/3c3aa6c1-da5c-4b0d-9fa9-32bdc468b7e3/cross-format-comparison-20250613-054304.csv
2025-06-13T05:43:04.6487440Z HTML cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/3f3a2907-ea92-4ded-8137-b6ee25933254/cross-format-comparison-20250613-054304.html
2025-06-13T05:43:04.6513779Z Cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/5b80d011-ddbc-4ff7-8bb7-6124df1da491/cross-format-comparison-20250613-054304.json
2025-06-13T05:43:04.6529862Z CSV cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/f99c21ae-6abc-4fbb-bc37-4ee92fbfdd85/cross-format-comparison-20250613-054304.csv
2025-06-13T05:43:04.6553997Z HTML cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/fd501a3a-a59e-49bb-8ab7-4d73a04c6e7a/cross-format-comparison-20250613-054304.html
2025-06-13T05:43:04.6587049Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateReports_AllFormats_ShouldContainSameDataAccuracy [20 ms]
2025-06-13T05:43:04.6593272Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateJsonReport_WithEmptyResult_ShouldCreateValidJsonFile [4 ms]
2025-06-13T05:43:04.6596119Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateReport_WithDefaultFormat_ShouldCreateJsonReport [13 ms]
2025-06-13T05:43:04.6598632Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateHtmlReport_WithSemanticallyEquivalent_ShouldDisplaySemanticInfo [2 ms]
2025-06-13T05:43:04.6602426Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateCsvReport_WithConversionSuggestions_ShouldReflectInHasSuggestions [1 ms]
2025-06-13T05:43:04.6604683Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateReport_WithEmptyResult_ShouldHandleGracefully [2 ms]
2025-06-13T05:43:04.6607060Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateHtmlReport_WithConversionSuggestions_ShouldDisplaySuggestions [2 ms]
2025-06-13T05:43:04.6609294Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateReport_WithUnknownFormat_ShouldDefaultToJson [1 ms]
2025-06-13T05:43:04.6611417Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateCsvReport_WithAllStatuses_ShouldCreateValidCsvFile [2 ms]
2025-06-13T05:43:04.6613820Z Cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/3de37208-67a4-4d5b-b2dc-f306c4679782/new-directory/cross-format-comparison-20250613-054304.json
2025-06-13T05:43:04.6624205Z Markdown cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/eea3e957-43d3-4dba-85bb-c375c2e33138/cross-format-comparison-20250613-054304.md
2025-06-13T05:43:04.6673584Z Markdown cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/4e393ee7-00c9-4241-ae94-3b57f091c65d/cross-format-comparison-20250613-054304.md
2025-06-13T05:43:04.6690750Z Cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/8669cc7d-097a-4a87-91b1-be5b7ef85f7d/cross-format-comparison-20250613-054304.json
2025-06-13T05:43:05.9698467Z custom_export.json
2025-06-13T05:43:06.1587964Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateHtmlReport_WithAllStatuses_ShouldCreateValidHtmlFile [3 ms]
2025-06-13T05:43:06.1590188Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateReport_CreatesOutputDirectory_WhenNotExists [2 ms]
2025-06-13T05:43:06.1592425Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateMarkdownReport_WithAllStatuses_ShouldCreateValidMarkdownFile [2 ms]
2025-06-13T05:43:06.1594035Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateReports_ShouldLogFileGeneration [2 ms]
2025-06-13T05:43:06.1595163Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateMarkdownReport_WithSemanticallyEquivalent_ShouldFormatCorrectly [1 ms]
2025-06-13T05:43:06.1596682Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateJsonReport_WithAllStatuses_ShouldCreateValidJsonFile [3 ms]
2025-06-13T05:43:06.1597698Z   Passed ConditionalAccessExporter.Tests.ProgramTests.CrossFormatComparePoliciesAsync_Success_ReturnsZero [21 ms]
2025-06-13T05:43:06.1598543Z   Passed ConditionalAccessExporter.Tests.ProgramTests.ExportPoliciesAsync_Exception_HandlesErrorAndReturnsOne [1 s]
2025-06-13T05:43:06.4014688Z Conditional Access Policy Exporter
2025-06-13T05:43:06.4015880Z ==================================
2025-06-13T05:43:06.4017122Z Tenant ID: ***
2025-06-13T05:43:06.4027054Z Client ID: ***
2025-06-13T05:43:06.4027500Z Client Secret: [HIDDEN]
2025-06-13T05:43:06.4027900Z Authenticating to Microsoft Graph...
2025-06-13T05:43:06.4028355Z Fetching Conditional Access Policies...
2025-06-13T05:43:06.4028821Z Found 1 Conditional Access Policies
2025-06-13T05:43:06.4029243Z Policy Summary:
2025-06-13T05:43:06.4029544Z ================
2025-06-13T05:43:06.4029918Z - notrustisrael (State: Enabled)
2025-06-13T05:43:06.4030628Z Conditional Access Policies exported successfully to: custom_export.json
2025-06-13T05:43:06.4031220Z File size: 1.25 KB
2025-06-13T05:43:06.4031632Z Export completed successfully!
2025-06-13T05:43:06.4033759Z ConditionalAccessPolicies_20250613_054306.json
2025-06-13T05:43:06.7941999Z Conditional Access Policy Exporter
2025-06-13T05:43:06.7942806Z ==================================
2025-06-13T05:43:06.7943576Z Tenant ID: ***
2025-06-13T05:43:06.7944042Z Client ID: ***
2025-06-13T05:43:06.7944381Z Client Secret: [HIDDEN]
2025-06-13T05:43:06.7944792Z Authenticating to Microsoft Graph...
2025-06-13T05:43:06.7945492Z Fetching Conditional Access Policies...
2025-06-13T05:43:06.7946001Z Found 1 Conditional Access Policies
2025-06-13T05:43:06.7946400Z Policy Summary:
2025-06-13T05:43:06.7946698Z ================
2025-06-13T05:43:06.7947071Z - notrustisrael (State: Enabled)
2025-06-13T05:43:06.7947982Z Conditional Access Policies exported successfully to: ConditionalAccessPolicies_20250613_054306.json
2025-06-13T05:43:06.7948814Z File size: 1.25 KB
2025-06-13T05:43:06.7949218Z Export completed successfully!
2025-06-13T05:43:06.8464037Z   Passed ConditionalAccessExporter.Tests.ProgramTests.Export_Command_ValidArgs_CallsHandler(args: ["export", "--output", "custom_export.json"]) [432 ms]
2025-06-13T05:43:06.8465969Z   Passed ConditionalAccessExporter.Tests.ProgramTests.Export_Command_ValidArgs_CallsHandler(args: ["export"]) [392 ms]
2025-06-13T05:43:06.8467450Z   Passed ConditionalAccessExporter.Tests.ProgramTests.ConvertJsonToTerraformAsync_Success_ReturnsZero [11 ms]
2025-06-13T05:43:06.8468790Z   Passed ConditionalAccessExporter.Tests.ProgramTests.ComparePoliciesAsync_ServiceFailure_ReturnsOne [3 ms]
2025-06-13T05:43:06.8469613Z   Passed ConditionalAccessExporter.Tests.ProgramTests.JsonToTerraform_Command_MissingInput_ReturnsError [28 ms]
2025-06-13T05:43:06.8470611Z   Passed ConditionalAccessExporter.Tests.ProgramTests.CrossCompare_Command_MissingRequiredOption_ReturnsError(args: ["cross-compare", "--source-dir", "./src"]) [1 ms]
2025-06-13T05:43:06.8471769Z   Passed ConditionalAccessExporter.Tests.ProgramTests.CrossCompare_Command_MissingRequiredOption_ReturnsError(args: ["cross-compare", "--reference-dir", "./ref"]) [< 1 ms]
2025-06-13T05:43:06.8473234Z   Passed ConditionalAccessExporter.Tests.ProgramTests.CrossCompare_Command_ValidArgs_CallsHandler(args: ["cross-compare", "--source-dir", "./src_tf", "--reference-dir", "./ref_json", ···]) [3 ms]
2025-06-13T05:43:06.8474452Z   Passed ConditionalAccessExporter.Tests.ProgramTests.CrossCompare_Command_ValidArgs_CallsHandler(args: ["cross-compare", "--source-dir", "./src", "--reference-dir", "./ref"]) [< 1 ms]
2025-06-13T05:43:07.7768250Z   Passed ConditionalAccessExporter.Tests.ProgramTests.Terraform_Command_MissingInput_ReturnsError [1 ms]
2025-06-13T05:43:07.7769872Z   Passed ConditionalAccessExporter.Tests.ProgramTests.Terraform_Command_ValidArgs_CallsHandler(args: ["terraform", "--input", "file.tf"]) [31 ms]
2025-06-13T05:43:07.7772133Z   Passed ConditionalAccessExporter.Tests.ProgramTests.Terraform_Command_ValidArgs_CallsHandler(args: ["terraform", "--input", "dir/", "--output", "converted.json", ···]) [< 1 ms]
2025-06-13T05:43:07.7773698Z   Passed ConditionalAccessExporter.Tests.ProgramTests.ExportPoliciesAsync_Success_ReturnsZero [630 ms]
2025-06-13T05:43:07.7774814Z   Passed ConditionalAccessExporter.Tests.ProgramTests.ConvertTerraformAsync_ServiceFailure_ReturnsOne [1 ms]
2025-06-13T05:43:07.7776257Z   Passed ConditionalAccessExporter.Tests.ProgramTests.ConvertJsonToTerraformAsync_ServiceFailure_ReturnsOne [1 ms]
2025-06-13T05:43:07.7777819Z   Passed ConditionalAccessExporter.Tests.ProgramTests.Compare_Command_ValidArgs_CallsHandler(args: ["compare", "--reference-dir", "./ref", "--entra-file", "entra_export.json", ···]) [6 ms]
2025-06-13T05:43:07.7778909Z   Passed ConditionalAccessExporter.Tests.ProgramTests.Compare_Command_ValidArgs_CallsHandler(args: ["compare", "--reference-dir", "./ref"]) [255 ms]
2025-06-13T05:43:07.7779780Z   Passed ConditionalAccessExporter.Tests.ProgramTests.ConvertTerraformAsync_Success_ReturnsZero [2 ms]
2025-06-13T05:43:08.0838772Z   Passed ConditionalAccessExporter.Tests.ProgramTests.ComparePoliciesAsync_Success_ReturnsZero [6 ms]
2025-06-13T05:43:08.0841177Z   Passed ConditionalAccessExporter.Tests.ProgramTests.JsonToTerraform_Command_ValidArgs_CallsHandler(args: ["json-to-terraform", "--input", "policies.json", "--output-dir", "custom_tf_out", ···]) [1 ms]
2025-06-13T05:43:08.0843423Z   Passed ConditionalAccessExporter.Tests.ProgramTests.JsonToTerraform_Command_ValidArgs_CallsHandler(args: ["json-to-terraform", "--input", "policies.json"]) [< 1 ms]
2025-06-13T05:43:08.0845118Z   Passed ConditionalAccessExporter.Tests.ProgramTests.Compare_Command_MissingReferenceDir_ReturnsError [2 ms]
2025-06-13T05:43:08.0846602Z   Passed ConditionalAccessExporter.Tests.ProgramTests.Help_Option_PrintsHelpText(args: ["--help"]) [2 ms]
2025-06-13T05:43:08.0847998Z   Passed ConditionalAccessExporter.Tests.ProgramTests.Help_Option_PrintsHelpText(args: ["export", "--help"]) [< 1 ms]
2025-06-13T05:43:08.0849314Z   Passed ConditionalAccessExporter.Tests.ProgramTests.Main_NoArgs_CallsExportCommand [291 ms]
2025-06-13T05:43:08.0850701Z   Passed ConditionalAccessExporter.Tests.ProgramTests.CrossFormatComparePoliciesAsync_ServiceFailure_ReturnsOne [1 ms]
2025-06-13T05:43:08.0852461Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateConsoleReport_WithAllIdentical_ShouldShowAllIdentical [1 ms]
2025-06-13T05:43:08.0854361Z HTML report generated: /tmp/ReportGenerationTests/93a53fdb-c90e-4554-9ed7-52dc0352a095/CA_Comparison_20250613_054308.html
2025-06-13T05:43:08.0926974Z JSON report generated: /tmp/ReportGenerationTests/46b58133-b4c6-412e-a955-224145a31182/CA_Comparison_20250613_054308.json
2025-06-13T05:43:08.0979316Z CSV report generated: /tmp/ReportGenerationTests/e292bb88-ba2b-4ada-9b64-6f08b9e6e6c3/CA_Comparison_20250613_054308.csv
2025-06-13T05:43:08.0996274Z JSON report generated: /tmp/ReportGenerationTests/90a3e3fc-865b-4169-a4b9-0c0fc0c6b64f/CA_Comparison_20250613_054308.json
2025-06-13T05:43:08.0998936Z HTML report generated: /tmp/ReportGenerationTests/90a3e3fc-865b-4169-a4b9-0c0fc0c6b64f/CA_Comparison_20250613_054308.html
2025-06-13T05:43:08.1004319Z CSV report generated: /tmp/ReportGenerationTests/90a3e3fc-865b-4169-a4b9-0c0fc0c6b64f/CA_Comparison_20250613_054308.csv
2025-06-13T05:43:08.1029366Z JSON report generated: /tmp/ReportGenerationTests/04c71675-3bb2-4780-b0d2-27b02fa3f7a7/CA_Comparison_20250613_054308.json
2025-06-13T05:43:08.1087592Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateConsoleReport_WithAllEntraOnly_ShouldShowEntraOnlySection [< 1 ms]
2025-06-13T05:43:08.1089919Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateHtmlReport_WithEmptyResult_ShouldCreateValidHtmlFile [8 ms]
2025-06-13T05:43:08.1091810Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateJsonReport_WithEmptyResult_ShouldCreateValidJsonFile [4 ms]
2025-06-13T05:43:08.1093788Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateCsvReport_WithAllStatusTypes_ShouldCreateValidCsvFile [2 ms]
2025-06-13T05:43:08.1095922Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateReports_WithNullDifferences_ShouldHandleGracefully [2 ms]
2025-06-13T05:43:08.1097865Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateJsonReport_WithAllStatusTypes_ShouldCreateValidJsonFile [3 ms]
2025-06-13T05:43:08.1099979Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateReports_WithInvalidFormat_ShouldHandleGracefully [1 ms]
2025-06-13T05:43:08.1101829Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateConsoleReport_WithEmptyResult_ShouldShowEmptyReport [< 1 ms]
2025-06-13T05:43:08.1103831Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateConsoleReport_WithAllStatusTypes_ShouldProduceStructuredOutput [1 ms]
2025-06-13T05:43:08.1105999Z JSON report generated: /tmp/ReportGenerationTests/65720f93-3ec7-4787-8548-0da7b3748a07/new-directory/CA_Comparison_20250613_054308.json
2025-06-13T05:43:08.1107646Z JSON report generated: /tmp/ReportGenerationTests/0444a0ee-9360-4a05-a406-99a0881af39b/CA_Comparison_20250613_054308.json
2025-06-13T05:43:08.1109150Z HTML report generated: /tmp/ReportGenerationTests/0444a0ee-9360-4a05-a406-99a0881af39b/CA_Comparison_20250613_054308.html
2025-06-13T05:43:08.1110662Z CSV report generated: /tmp/ReportGenerationTests/0444a0ee-9360-4a05-a406-99a0881af39b/CA_Comparison_20250613_054308.csv
2025-06-13T05:43:08.1124689Z HTML report generated: /tmp/ReportGenerationTests/c8f24056-060a-416f-b812-f20dcc21376a/CA_Comparison_20250613_054308.html
2025-06-13T05:43:08.1181691Z [xUnit.net 00:00:04.70]   Finished:    ConditionalAccessExporter.Tests
2025-06-13T05:43:09.6087267Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateReports_CreatesOutputDirectory_WhenNotExists [1 ms]
2025-06-13T05:43:09.6089147Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateReports_WithMultipleFormats_ShouldCreateAllFiles [1 ms]
2025-06-13T05:43:09.6091034Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateHtmlReport_WithAllStatusTypes_ShouldCreateValidHtmlFile [3 ms]
2025-06-13T05:43:19.1846883Z 
2025-06-13T05:43:19.1887600Z Test Run Failed.
2025-06-13T05:43:19.1888017Z Total tests: 215
2025-06-13T05:43:19.1888328Z      Passed: 212
2025-06-13T05:43:19.1888603Z      Failed: 3
2025-06-13T05:43:19.1903073Z  Total time: 17.6326 Seconds
2025-06-13T05:43:19.2030682Z      1>Project "/home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.sln" (1) is building "/home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/ConditionalAccessExporter.Tests.csproj" (3) on node 2 (VSTest target(s)).
2025-06-13T05:43:19.2033879Z      3>_VSTestConsole:
2025-06-13T05:43:19.2034515Z          MSB4181: The "VSTestTask" task returned false but did not log an error.
2025-06-13T05:43:19.2067983Z      3>Done Building Project "/home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/ConditionalAccessExporter.Tests.csproj" (VSTest target(s)) -- FAILED.
2025-06-13T05:43:19.2137016Z      1>Done Building Project "/home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.sln" (VSTest target(s)) -- FAILED.
2025-06-13T05:43:19.2183795Z 
2025-06-13T05:43:19.2184297Z Build FAILED.
2025-06-13T05:43:19.2184853Z     0 Warning(s)
2025-06-13T05:43:19.2185745Z     0 Error(s)
2025-06-13T05:43:19.2194197Z 
2025-06-13T05:43:19.2194707Z Time Elapsed 00:00:18.55
2025-06-13T05:43:19.3987902Z 
2025-06-13T05:43:19.3993225Z Attachments:
2025-06-13T05:43:19.3995505Z   /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/TestResults/8ab50b99-2cf6-49af-976f-43aae829e128/coverage.cobertura.xml
2025-06-13T05:43:19.4503871Z ##[error]Process completed with exit code 1.
