2025-06-15T03:28:30.6053928Z ##[group]Run dotnet --version && dotnet test --no-build --verbosity normal --collect:"XPlat Code Coverage" --logger "console;verbosity=detailed" --nologo
2025-06-15T03:28:30.6054915Z [36;1mdotnet --version && dotnet test --no-build --verbosity normal --collect:"XPlat Code Coverage" --logger "console;verbosity=detailed" --nologo[0m
2025-06-15T03:28:30.6114537Z shell: /usr/bin/bash -e {0}
2025-06-15T03:28:30.6114960Z env:
2025-06-15T03:28:30.6115153Z   DOTNET_ROOT: /usr/share/dotnet
2025-06-15T03:28:30.6115540Z   AZURE_TENANT_ID: ***
2025-06-15T03:28:30.6115797Z   AZURE_CLIENT_ID: ***
2025-06-15T03:28:30.6116129Z   AZURE_CLIENT_SECRET: ***
2025-06-15T03:28:30.6116350Z ##[endgroup]
2025-06-15T03:28:30.7163138Z 8.0.411
2025-06-15T03:28:31.0245917Z Build started 06/15/2025 03:28:31.
2025-06-15T03:28:31.2231782Z      1>Project "/home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.sln" on node 1 (VSTest target(s)).
2025-06-15T03:28:31.2235281Z      1>ValidateSolutionConfiguration:
2025-06-15T03:28:31.2239629Z          Building solution configuration "Debug|Any CPU".
2025-06-15T03:28:31.7233270Z Test run for /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/bin/Debug/net8.0/ConditionalAccessExporter.Tests.dll (.NETCoreApp,Version=v8.0)
2025-06-15T03:28:31.9000941Z A total of 1 test files matched the specified pattern.
2025-06-15T03:28:31.9002757Z /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/bin/Debug/net8.0/ConditionalAccessExporter.Tests.dll
2025-06-15T03:28:33.9809798Z [xUnit.net 00:00:00.00] xUnit.net VSTest Adapter v2.5.3.1+6b60a9e56a (64-bit .NET 8.0.17)
2025-06-15T03:28:34.2018789Z [xUnit.net 00:00:00.24]   Discovering: ConditionalAccessExporter.Tests
2025-06-15T03:28:34.2755303Z [xUnit.net 00:00:00.31]   Discovered:  ConditionalAccessExporter.Tests
2025-06-15T03:28:34.2776947Z [xUnit.net 00:00:00.31]   Starting:    ConditionalAccessExporter.Tests
2025-06-15T03:28:34.3437995Z Starting Conditional Access Policy remediation analysis...
2025-06-15T03:28:34.3467661Z Authentication credentials not found. Please set AZURE_TENANT_ID, AZURE_CLIENT_ID, and AZURE_CLIENT_SECRET environment variables.
2025-06-15T03:28:34.3552605Z Starting Conditional Access Policy remediation analysis...
2025-06-15T03:28:34.3566722Z Authentication credentials not found. Please set AZURE_TENANT_ID, AZURE_CLIENT_ID, and AZURE_CLIENT_SECRET environment variables.
2025-06-15T03:28:34.3576419Z Starting Conditional Access Policy remediation analysis...
2025-06-15T03:28:34.3583904Z Authentication credentials not found. Please set AZURE_TENANT_ID, AZURE_CLIENT_ID, and AZURE_CLIENT_SECRET environment variables.
2025-06-15T03:28:34.3585724Z Starting Conditional Access Policy remediation analysis...
2025-06-15T03:28:34.3598450Z Authentication credentials not found. Please set AZURE_TENANT_ID, AZURE_CLIENT_ID, and AZURE_CLIENT_SECRET environment variables.
2025-06-15T03:28:34.3600405Z Authentication credentials not found. Please set AZURE_TENANT_ID, AZURE_CLIENT_ID, and AZURE_CLIENT_SECRET environment variables.
2025-06-15T03:28:34.3604431Z Authentication credentials not found. Please set AZURE_TENANT_ID, AZURE_CLIENT_ID, and AZURE_CLIENT_SECRET environment variables.
2025-06-15T03:28:34.3605532Z Starting Conditional Access Policy remediation analysis...
2025-06-15T03:28:34.3606094Z Starting Conditional Access Policy remediation analysis...
2025-06-15T03:28:34.3606535Z Starting Conditional Access Policy remediation analysis...
2025-06-15T03:28:34.3607210Z Authentication credentials not found. Please set AZURE_TENANT_ID, AZURE_CLIENT_ID, and AZURE_CLIENT_SECRET environment variables.
2025-06-15T03:28:34.3753448Z Starting cross-format comparison between '/tmp/CrossFormatTests_63acc554/source' and '/tmp/CrossFormatTests_63acc554/reference'
2025-06-15T03:28:34.3978293Z Starting cross-format comparison between '/tmp/CrossFormatIntegrationTests_c6cbeaef/source' and '/tmp/CrossFormatIntegrationTests_c6cbeaef/reference'
2025-06-15T03:28:34.4084649Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-15T03:28:34.4221153Z Cross-format comparison report generated: /tmp/test-reports/cross-format-comparison-20250615-032834.json
2025-06-15T03:28:34.4677520Z   Passed ConditionalAccessExporter.Tests.RemediatePoliciesAsyncTests.RemediatePoliciesAsync_AcceptsValidRiskLevels(riskLevel: "All") [18 ms]
2025-06-15T03:28:34.4679677Z   Passed ConditionalAccessExporter.Tests.BaselineGenerationServiceTests.BaselineGenerationOptions_PropertiesSetCorrectly [16 ms]
2025-06-15T03:28:34.4682520Z   Passed ConditionalAccessExporter.Tests.BaselineGenerationServiceTests.BaselineGenerationOptions_DefaultConstructor_SetsDefaults [1 ms]
2025-06-15T03:28:34.4684681Z   Passed ConditionalAccessExporter.Tests.BaselineGenerationServiceTests.BaselineGenerationService_Constructor_CreatesInstance [< 1 ms]
2025-06-15T03:28:34.4686780Z   Passed ConditionalAccessExporter.Tests.RemediatePoliciesAsyncTests.RemediatePoliciesAsync_AcceptsValidRiskLevels(riskLevel: "High") [3 ms]
2025-06-15T03:28:34.4688946Z   Passed ConditionalAccessExporter.Tests.RemediatePoliciesAsyncTests.RemediatePoliciesAsync_AcceptsValidRiskLevels(riskLevel: "Critical") [< 1 ms]
2025-06-15T03:28:34.4691067Z   Passed ConditionalAccessExporter.Tests.RemediatePoliciesAsyncTests.RemediatePoliciesAsync_AcceptsValidRiskLevels(riskLevel: "Low") [< 1 ms]
2025-06-15T03:28:34.4693472Z   Passed ConditionalAccessExporter.Tests.RemediatePoliciesAsyncTests.RemediatePoliciesAsync_AcceptsValidRiskLevels(riskLevel: "Medium") [< 1 ms]
2025-06-15T03:28:34.4695544Z   Passed ConditionalAccessExporter.Tests.RemediatePoliciesAsyncTests.RemediatePoliciesAsync_CreatesOutputDirectory [< 1 ms]
2025-06-15T03:28:34.4697604Z   Passed ConditionalAccessExporter.Tests.RemediatePoliciesAsyncTests.RemediatePoliciesAsync_WithoutCredentials_ReturnsErrorExitCode [< 1 ms]
2025-06-15T03:28:34.4699730Z   Passed ConditionalAccessExporter.Tests.CrossFormatComparisonTests.CrossFormatMatchingOptions_DefaultValues_ShouldBeCorrect [6 ms]
2025-06-15T03:28:34.4701311Z No JSON files found in directory: /tmp/test-ref-empty. No files were processed.
2025-06-15T03:28:34.4707103Z ✓ All 0 reference files are valid
2025-06-15T03:28:34.4707941Z Converting policies: Progress: 1/1 (100.0%) - 51.0 items/sec, ETA: 00:00
2025-06-15T03:28:34.4708671Z Policy conversion completed in 43ms
2025-06-15T03:28:34.4709185Z Average speed: 23.4 policies/second
2025-06-15T03:28:34.4709835Z No JSON files found in reference directory '/tmp/test-ref-empty'
2025-06-15T03:28:34.4753651Z Found 0 source policies (Mixed) and 1 reference policies (Terraform)
2025-06-15T03:28:34.4837907Z Validating 1 policy files using parallel processing...
2025-06-15T03:28:34.4927803Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_ValidTfFileWithSinglePolicy_ShouldParseSuccessfully [72 ms]
2025-06-15T03:28:34.4931411Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_EntraOnlyPolicy_ShouldReportAsEntraOnly [73 ms]
2025-06-15T03:28:34.4946407Z   Passed ConditionalAccessExporter.Tests.CrossFormatComparisonTests.CrossFormatReportGeneration_ShouldCreateValidJsonReport [99 ms]
2025-06-15T03:28:34.4948734Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_EmptySourceDirectory_ShouldHandleGracefully [162 ms]
2025-06-15T03:28:34.4951455Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_EmptyEntraExport_ShouldReturnEmptyResult [84 ms]
2025-06-15T03:28:34.4954058Z Starting cross-format comparison between '/tmp/CrossFormatTests_17b8eb1a/source' and '/tmp/CrossFormatTests_17b8eb1a/reference'
2025-06-15T03:28:34.4955435Z Starting cross-format comparison between '/tmp/test-source' and '/tmp/test-reference'
2025-06-15T03:28:34.4987735Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-15T03:28:34.5045239Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-15T03:28:34.5217108Z Starting cross-format comparison between '/tmp/CrossFormatTests_cbbe0b9c/source' and '/tmp/CrossFormatTests_cbbe0b9c/reference'
2025-06-15T03:28:34.5244983Z Found 1 source policies (Json) and 0 reference policies (Mixed)
2025-06-15T03:28:34.5248426Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_TfFileWithUnsupportedResources_ShouldIgnoreOtherResources [6 ms]
2025-06-15T03:28:34.5252180Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithDifferentStates_ShouldIncludeStateCorrectly(inputState: "disabled", expectedOutputState: "disabled") [142 ms]
2025-06-15T03:28:34.5259413Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_TfFileWithLocalsOnly_ShouldParseLocals [14 ms]
2025-06-15T03:28:34.5262384Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_ArrayOrderDifference_ShouldDetectSemanticEquivalence [20 ms]
2025-06-15T03:28:34.5265477Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_DifferentPolicies_ShouldReturnDifferentStatus [3 ms]
2025-06-15T03:28:34.5268086Z   Passed ConditionalAccessExporter.Tests.CrossFormatComparisonTests.CrossFormatComparison_WithSampleData_ShouldProduceValidResults [33 ms]
2025-06-15T03:28:34.5270227Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_FileDoesNotExist_ShouldReturnError [9 ms]
2025-06-15T03:28:34.5345959Z Starting cross-format comparison between '/tmp/CrossFormatSpecificTests_d295e05a/nonexistent_source' and '/tmp/CrossFormatSpecificTests_d295e05a/terraform_policies'
2025-06-15T03:28:34.5376373Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_SemanticallyEquivalentPolicies_ShouldReturnSemanticallyEquivalentStatus [31 ms]
2025-06-15T03:28:34.5379355Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_CaseInsensitiveValues_ShouldDetectSemanticEquivalence [6 ms]
2025-06-15T03:28:34.5382275Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_TfFileWithVariablesOnly_ShouldParseVariables [7 ms]
2025-06-15T03:28:34.5398347Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithDifferentStates_ShouldIncludeStateCorrectly(inputState: "enabled", expectedOutputState: "enabled") [20 ms]
2025-06-15T03:28:34.5400859Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_EmptyFile_ShouldReturnEmptyPolicies [2 ms]
2025-06-15T03:28:34.5403200Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_SourceOnlyPolicy_ShouldReturnSourceOnlyStatus [11 ms]
2025-06-15T03:28:34.5405314Z Starting cross-format comparison between '/tmp/CrossFormatTests_33f3c020/source' and '/tmp/CrossFormatTests_33f3c020/reference'
2025-06-15T03:28:34.5406536Z Found 0 source policies (Mixed) and 0 reference policies (Mixed)
2025-06-15T03:28:34.5435000Z Starting cross-format comparison between '/tmp/CrossFormatTests_f1d43cd4/source' and '/tmp/CrossFormatTests_f1d43cd4/reference'
2025-06-15T03:28:34.5436352Z Found 0 source policies (Unknown) and 1 reference policies (Terraform)
2025-06-15T03:28:34.5447418Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-15T03:28:34.5536353Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_ValidEntraExportAndTerraformDirectory_ShouldReturnComparisonResult [9 ms]
2025-06-15T03:28:34.5540220Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithDifferentStates_ShouldIncludeStateCorrectly(inputState: "enabledForReportingButNotEnforced", expectedOutputState: "enabledforreportingbutnotenforced") [7 ms]
2025-06-15T03:28:34.5548270Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformDirectoryAsync_DirectoryWithMixedFileTypes_ShouldOnlyProcessTerraformFiles [7 ms]
2025-06-15T03:28:34.5562915Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_BothDirectoriesEmpty_ShouldReturnEmptyResult [8 ms]
2025-06-15T03:28:34.5565380Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformDirectoryAsync_DirectoryWithMultipleTfFiles_ShouldAggregateAll [8 ms]
2025-06-15T03:28:34.5568032Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformDirectoryAsync_DirectoryDoesNotExist_ShouldReturnError [< 1 ms]
2025-06-15T03:28:34.5633340Z Starting cross-format comparison between '/tmp/CrossFormatTests_a1d51e5c/source' and '/tmp/CrossFormatTests_a1d51e5c/reference'
2025-06-15T03:28:34.5658464Z Terraform parsing error: Directory not found: /tmp/CrossFormatSpecificTests_20ccc891/nonexistent
2025-06-15T03:28:34.5659868Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-15T03:28:34.5684668Z Starting cross-format comparison between '/tmp/CrossFormatSpecificTests_7d557003/json_policies' and '/tmp/CrossFormatSpecificTests_7d557003/terraform_policies'
2025-06-15T03:28:34.5686768Z Starting cross-format comparison between '/tmp/CrossFormatTests_fa23b396/source' and '/tmp/CrossFormatTests_fa23b396/reference'
2025-06-15T03:28:34.5688193Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-15T03:28:34.5694891Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareAsync_NonExistentSourceDirectory_ShouldHandleGracefully [13 ms]
2025-06-15T03:28:34.5697587Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_NullMatchingOptions_ShouldUseDefaults [10 ms]
2025-06-15T03:28:34.5700534Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_TfFileWithSyntaxErrors_ShouldHandleGracefully [8 ms]
2025-06-15T03:28:34.5704064Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_DisableSemanticComparison_ShouldPerformExactComparison [7 ms]
2025-06-15T03:28:34.5710724Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_NonExistentTerraformDirectory_ShouldHandleGracefully [1 ms]
2025-06-15T03:28:34.5718741Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_IdenticalPolicies_ShouldReturnIdenticalStatus [3 ms]
2025-06-15T03:28:34.5721405Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_DifferentPolicies_ShouldReturnDifferentStatus [15 ms]
2025-06-15T03:28:34.5759358Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-15T03:28:34.5760089Z Validation completed: 0 valid, 1 invalid files
2025-06-15T03:28:34.5760610Z Processing time: 88ms
2025-06-15T03:28:34.5761043Z Average speed: 11.4 files/second
2025-06-15T03:28:34.5761689Z Reference file validation failed. Found 1 invalid files out of 1.
2025-06-15T03:28:34.5762729Z   ✗ policy1.json: 2 errors
2025-06-15T03:28:34.5763961Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-15T03:28:34.5764976Z     - Display name is missing or empty.
2025-06-15T03:28:34.5765796Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-15T03:28:34.5766752Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-15T03:28:34.5767578Z Loading 1 reference policy files using parallel processing...
2025-06-15T03:28:34.5775725Z Starting cross-format comparison between '/tmp/CrossFormatTests_c310763a/source' and '/tmp/CrossFormatTests_c310763a/reference'
2025-06-15T03:28:34.5786690Z Loading reference files: Progress: 1/1 (100.0%) - 517.1 items/sec, ETA: 00:00
2025-06-15T03:28:34.5789939Z Reference file loading completed: 1 files loaded successfully
2025-06-15T03:28:34.5791031Z Processing time: 3ms
2025-06-15T03:28:34.5793078Z Average speed: 350.6 files/second
2025-06-15T03:28:34.5833780Z Validating 1 policy files using parallel processing...
2025-06-15T03:28:34.5849322Z Reference file validation failed. Found 1 invalid files out of 1.
2025-06-15T03:28:34.5852663Z   ✗ policy1.json: 2 errors
2025-06-15T03:28:34.5857105Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-15T03:28:34.5860493Z     - Display name is missing or empty.
2025-06-15T03:28:34.5861463Z Validation completed: 0 valid, 1 invalid files
2025-06-15T03:28:34.5862362Z Processing time: 1ms
2025-06-15T03:28:34.5862827Z Average speed: 1188.8 files/second
2025-06-15T03:28:34.5863606Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-15T03:28:34.5864557Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-15T03:28:34.5865344Z Loading 1 reference policy files using parallel processing...
2025-06-15T03:28:34.5866059Z Reference file loading completed: 1 files loaded successfully
2025-06-15T03:28:34.5866649Z Processing time: 1ms
2025-06-15T03:28:34.5867065Z Average speed: 1631.1 files/second
2025-06-15T03:28:34.5872842Z Starting cross-format comparison between '/tmp/CrossFormatSpecificTests_a3af27ca/json_policies' and '/tmp/CrossFormatSpecificTests_a3af27ca/terraform_policies'
2025-06-15T03:28:34.5885382Z Loading reference files: Progress: 1/1 (100.0%) - 4541.3 items/sec, ETA: 00:00
2025-06-15T03:28:34.5906848Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-15T03:28:34.5915492Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareAsync_ValidDirectories_ShouldReturnComparisonResult [7 ms]
2025-06-15T03:28:34.5924830Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_ByNameCaseSensitive_ShouldRespectCaseSensitivity [7 ms]
2025-06-15T03:28:34.5931029Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithUserConditions_ShouldMapCorrectly [40 ms]
2025-06-15T03:28:34.5933275Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_MatchingById_DifferentIds_ShouldNotMatch [101 ms]
2025-06-15T03:28:34.5935744Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_CustomMappingStrategy_ShouldUseCustomMappings [8 ms]
2025-06-15T03:28:34.5938814Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareJsonToTerraformAsync_EmptyTerraformDirectory_ShouldReturnSourceOnlyPolicies [2 ms]
2025-06-15T03:28:34.5941834Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-15T03:28:34.5944034Z Starting cross-format comparison between '/tmp/CrossFormatSpecificTests_a3af27ca/json_policies' and '/tmp/CrossFormatSpecificTests_a3af27ca/terraform_policies'
2025-06-15T03:28:34.5997594Z Starting cross-format comparison between '/tmp/CrossFormatTests_32c37880/nonexistent-source' and '/tmp/CrossFormatTests_32c37880/reference'
2025-06-15T03:28:34.5999412Z Found 0 source policies (Unknown) and 0 reference policies (Mixed)
2025-06-15T03:28:34.6005094Z Starting cross-format comparison between '/tmp/CrossFormatTests_e9067d09/source' and '/tmp/CrossFormatTests_e9067d09/reference'
2025-06-15T03:28:34.6010968Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-15T03:28:34.6023798Z Starting cross-format comparison between '/tmp/CrossFormatSpecificTests_a3af27ca/json_policies' and '/tmp/CrossFormatSpecificTests_a3af27ca/terraform_policies'
2025-06-15T03:28:34.6091525Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-15T03:28:34.6092632Z Validating 3 policy files using parallel processing...
2025-06-15T03:28:34.6093716Z Validation completed: 0 valid, 3 invalid files
2025-06-15T03:28:34.6094422Z Processing time: 1ms
2025-06-15T03:28:34.6094957Z Average speed: 2591.3 files/second
2025-06-15T03:28:34.6095845Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-15T03:28:34.6096968Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-15T03:28:34.6098473Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-15T03:28:34.6099437Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-15T03:28:34.6100345Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-15T03:28:34.6101294Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-15T03:28:34.6102351Z Loading 3 reference policy files using parallel processing...
2025-06-15T03:28:34.6103152Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-15T03:28:34.6104015Z Reference file validation failed. Found 3 invalid files out of 3.
2025-06-15T03:28:34.6104804Z   ✗ policy2.json: 2 errors
2025-06-15T03:28:34.6105726Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-15T03:28:34.6106732Z     - Display name is missing or empty.
2025-06-15T03:28:34.6107355Z   ✗ policy1.json: 2 errors
2025-06-15T03:28:34.6108249Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-15T03:28:34.6109225Z     - Display name is missing or empty.
2025-06-15T03:28:34.6109795Z   ✗ policy4.json: 2 errors
2025-06-15T03:28:34.6110678Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-15T03:28:34.6111641Z     - Display name is missing or empty.
2025-06-15T03:28:34.6117616Z Starting cross-format comparison between '/tmp/CrossFormatSpecificTests_a3af27ca/json_policies' and '/tmp/CrossFormatSpecificTests_a3af27ca/terraform_policies'
2025-06-15T03:28:34.6132981Z Starting cross-format comparison between '/tmp/CrossFormatTests_98b896e8/source' and '/tmp/CrossFormatTests_98b896e8/reference'
2025-06-15T03:28:34.6134692Z Loading reference files: Progress: 1/3 (33.3%) - 702.0 items/sec, ETA: 00:00
2025-06-15T03:28:34.6143602Z Loading reference files: Progress: 2/3 (66.7%) - 1280.4 items/sec, ETA: 00:00
2025-06-15T03:28:34.6144986Z Loading reference files: Progress: 3/3 (100.0%) - 1735.8 items/sec, ETA: 00:00
2025-06-15T03:28:34.6146028Z Reference file loading completed: 3 files loaded successfully
2025-06-15T03:28:34.6146932Z Processing time: 7ms
2025-06-15T03:28:34.6147580Z Average speed: 406.5 files/second
2025-06-15T03:28:34.6169189Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-15T03:28:34.6207982Z Found 1 source policies (Terraform) and 1 reference policies (Json)
2025-06-15T03:28:34.6213141Z Validating 1 policy files using parallel processing...
2025-06-15T03:28:34.6236061Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_CaseSensitiveFalse_DifferentCase_ShouldMatch [13 ms]
2025-06-15T03:28:34.6263653Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_IdenticalPolicies_ShouldReturnIdenticalStatus [23 ms]
2025-06-15T03:28:34.6266246Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_NonExistentSourceDirectory_ShouldHandleGracefully [1 ms]
2025-06-15T03:28:34.6268739Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithMultiplePolicies_ShouldGenerateMultipleResources [17 ms]
2025-06-15T03:28:34.6271176Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_VeryLongPolicyNames_ShouldHandleCorrectly [8 ms]
2025-06-15T03:28:34.6273644Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithEmptyPoliciesList_ShouldReturnError [14 ms]
2025-06-15T03:28:34.6276362Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceSpecificMethodTests.CompareAsync_DifferentMatchingStrategies_ShouldHandleProperly [33 ms]
2025-06-15T03:28:34.6277959Z Validation completed: 0 valid, 1 invalid files
2025-06-15T03:28:34.6278707Z Processing time: 2ms
2025-06-15T03:28:34.6279111Z Average speed: 468.9 files/second
2025-06-15T03:28:34.6279850Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-15T03:28:34.6280780Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-15T03:28:34.6281567Z Loading 1 reference policy files using parallel processing...
2025-06-15T03:28:34.6288524Z Reference file validation failed. Found 1 invalid files out of 1.
2025-06-15T03:28:34.6289278Z   ✗ policy1.json: 2 errors
2025-06-15T03:28:34.6290154Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-15T03:28:34.6291141Z     - Display name is missing or empty.
2025-06-15T03:28:34.6292421Z Loading reference files: Progress: 1/1 (100.0%) - 1780.9 items/sec, ETA: 00:00
2025-06-15T03:28:34.6293364Z Reference file loading completed: 1 files loaded successfully
2025-06-15T03:28:34.6293990Z Processing time: 3ms
2025-06-15T03:28:34.6294423Z Average speed: 397.4 files/second
2025-06-15T03:28:34.6295512Z Starting cross-format comparison between '/tmp/CrossFormatTests_8e10dc64/source' and '/tmp/CrossFormatTests_8e10dc64/reference'
2025-06-15T03:28:34.6315276Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-15T03:28:34.6319647Z Validating 1 policy files using parallel processing...
2025-06-15T03:28:34.6330993Z Validation completed: 0 valid, 1 invalid files
2025-06-15T03:28:34.6344342Z Processing time: 1ms
2025-06-15T03:28:34.6346216Z Average speed: 913.5 files/second
2025-06-15T03:28:34.6349768Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-15T03:28:34.6354032Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-15T03:28:34.6355195Z Loading 1 reference policy files using parallel processing...
2025-06-15T03:28:34.6359795Z Reference file validation failed. Found 1 invalid files out of 1.
2025-06-15T03:28:34.6361261Z   ✗ reference-policy.json: 2 errors
2025-06-15T03:28:34.6369069Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-15T03:28:34.6370885Z     - Display name is missing or empty.
2025-06-15T03:28:34.6372526Z Loading reference files: Progress: 1/1 (100.0%) - 738.2 items/sec, ETA: 00:00
2025-06-15T03:28:34.6379328Z Reference file loading completed: 1 files loaded successfully
2025-06-15T03:28:34.6379948Z Processing time: 2ms
2025-06-15T03:28:34.6381558Z Average speed: 407.7 files/second
2025-06-15T03:28:34.6382761Z No JSON files found in directory: /tmp/test-timestamp. No files were processed.
2025-06-15T03:28:34.6384281Z ✓ All 0 reference files are valid
2025-06-15T03:28:34.6384914Z No JSON files found in reference directory '/tmp/test-timestamp'
2025-06-15T03:28:34.6386208Z Starting cross-format comparison between '/tmp/CrossFormatTests_1ba2efb2/source' and '/tmp/CrossFormatTests_1ba2efb2/reference'
2025-06-15T03:28:34.6406422Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_MultipleDifferenceTypes_ShouldReportCorrectly [22 ms]
2025-06-15T03:28:34.6420336Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_TerraformToJson_ShouldDetectFormatsCorrectly [17 ms]
2025-06-15T03:28:34.6422865Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_DifferentPolicies_ShouldReportAsDifferent [10 ms]
2025-06-15T03:28:34.6425020Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithApplicationConditions_ShouldMapCorrectly [14 ms]
2025-06-15T03:28:34.6426948Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_CustomMapping_ShouldMapCorrectly [6 ms]
2025-06-15T03:28:34.6428107Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_SpecialCharactersInPolicyNames_ShouldHandleCorrectly [11 ms]
2025-06-15T03:28:34.6429382Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_ShouldSetComparedAtTimestamp [2 ms]
2025-06-15T03:28:34.6430102Z Reference file validation failed. Found 0 invalid files out of 0.
2025-06-15T03:28:34.6430498Z Reference directory 'dummy-path' does not exist
2025-06-15T03:28:34.6534642Z Validating 1 policy files using parallel processing...
2025-06-15T03:28:34.6539864Z Validation completed: 0 valid, 1 invalid files
2025-06-15T03:28:34.6550906Z Processing time: 1ms
2025-06-15T03:28:34.6561283Z Average speed: 1341.7 files/second
2025-06-15T03:28:34.6570385Z Reference file validation failed. Found 1 invalid files out of 1.
2025-06-15T03:28:34.6583068Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-15T03:28:34.6596545Z   ✗ policy1.json: 2 errors
2025-06-15T03:28:34.6599980Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-15T03:28:34.6610375Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-15T03:28:34.6614598Z     - Display name is missing or empty.
2025-06-15T03:28:34.6615876Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-15T03:28:34.6617700Z Loading 1 reference policy files using parallel processing...
2025-06-15T03:28:34.6636878Z Loading reference files: Progress: 1/1 (100.0%) - 4235.5 items/sec, ETA: 00:00
2025-06-15T03:28:34.6640812Z Reference file loading completed: 1 files loaded successfully
2025-06-15T03:28:34.6642899Z Processing time: 3ms
2025-06-15T03:28:34.6643571Z Average speed: 376.4 files/second
2025-06-15T03:28:34.6689023Z Starting cross-format comparison between '/tmp/CrossFormatTests_aa42c569/source' and '/tmp/CrossFormatTests_aa42c569/reference'
2025-06-15T03:28:34.6690900Z No JSON files found in directory: /tmp/test-ref-empty-reference. No files were processed.
2025-06-15T03:28:34.6693679Z ✓ All 0 reference files are valid
2025-06-15T03:28:34.6694404Z No JSON files found in reference directory '/tmp/test-ref-empty-reference'
2025-06-15T03:28:34.6695269Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-15T03:28:34.6708094Z Validating 1 policy files using parallel processing...
2025-06-15T03:28:34.6730272Z Validation completed: 0 valid, 1 invalid files
2025-06-15T03:28:34.6742823Z Processing time: 1ms
2025-06-15T03:28:34.6753972Z Average speed: 668.5 files/second
2025-06-15T03:28:34.6762332Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.ParseEntraExport_ValidJObject_ShouldParseCorrectly [3 ms]
2025-06-15T03:28:34.6769629Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_JsonToTerraform_ShouldDetectFormatsCorrectly [21 ms]
2025-06-15T03:28:34.6777593Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithIncludeComments_ShouldGenerateAppropriateContent(includeComments: True) [25 ms]
2025-06-15T03:28:34.6780038Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_IdenticalPolicies_ShouldReportAsIdentical [23 ms]
2025-06-15T03:28:34.6782451Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_EmptyReferenceDirectory_ShouldReportAllAsEntraOnly [1 ms]
2025-06-15T03:28:34.6784784Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithIncludeComments_ShouldGenerateAppropriateContent(includeComments: False) [7 ms]
2025-06-15T03:28:34.6787421Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_UnicodeCharacters_ShouldHandleCorrectly [10 ms]
2025-06-15T03:28:34.6796409Z Reference file validation failed. Found 1 invalid files out of 1.
2025-06-15T03:28:34.6797213Z   ✗ policy1.json: 2 errors
2025-06-15T03:28:34.6807464Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-15T03:28:34.6808765Z     - Display name is missing or empty.
2025-06-15T03:28:34.6809566Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-15T03:28:34.6810519Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-15T03:28:34.6811348Z Loading 1 reference policy files using parallel processing...
2025-06-15T03:28:34.6812483Z Loading reference files: Progress: 1/1 (100.0%) - 4782.4 items/sec, ETA: 00:00
2025-06-15T03:28:34.6813347Z Reference file loading completed: 1 files loaded successfully
2025-06-15T03:28:34.6813990Z Processing time: 1ms
2025-06-15T03:28:34.6814418Z Average speed: 1792.8 files/second
2025-06-15T03:28:34.6815519Z Starting cross-format comparison between '/tmp/CrossFormatTests_73496545/source' and '/tmp/CrossFormatTests_73496545/reference'
2025-06-15T03:28:34.6854247Z Validating 1 policy files using parallel processing...
2025-06-15T03:28:34.6856038Z Validation completed: 0 valid, 1 invalid files
2025-06-15T03:28:34.6856880Z Processing time: 0ms
2025-06-15T03:28:34.6857605Z Reference file validation failed. Found 1 invalid files out of 1.
2025-06-15T03:28:34.6859416Z   ✗ policy1.json: 2 errors
2025-06-15T03:28:34.6860339Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-15T03:28:34.6861323Z     - Display name is missing or empty.
2025-06-15T03:28:34.6861833Z Average speed: 2060.6 files/second
2025-06-15T03:28:34.6862811Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-15T03:28:34.6863760Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-15T03:28:34.6864550Z Loading 1 reference policy files using parallel processing...
2025-06-15T03:28:34.6865366Z Terraform parsing error: Unmatched braces in resource 'invalid_policy'
2025-06-15T03:28:34.6866214Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-15T03:28:34.6867166Z Loading reference files: Progress: 1/1 (100.0%) - 6357.3 items/sec, ETA: 00:00
2025-06-15T03:28:34.6868037Z Reference file loading completed: 1 files loaded successfully
2025-06-15T03:28:34.6868644Z Processing time: 1ms
2025-06-15T03:28:34.6869055Z Average speed: 1409.4 files/second
2025-06-15T03:28:34.6886005Z Validating 1 policy files using parallel processing...
2025-06-15T03:28:34.6902358Z Validation completed: 0 valid, 1 invalid files
2025-06-15T03:28:34.6902951Z Processing time: 0ms
2025-06-15T03:28:34.6903394Z Average speed: 2030.9 files/second
2025-06-15T03:28:34.6904177Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-15T03:28:34.6905116Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-15T03:28:34.6905876Z Loading 1 reference policy files using parallel processing...
2025-06-15T03:28:34.6906637Z Reference file validation failed. Found 1 invalid files out of 1.
2025-06-15T03:28:34.6907335Z   ✗ policy1.json: 2 errors
2025-06-15T03:28:34.6908183Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-15T03:28:34.6909087Z     - Display name is missing or empty.
2025-06-15T03:28:34.6909805Z Loading reference files: Progress: 1/1 (100.0%) - 2116.4 items/sec, ETA: 00:00
2025-06-15T03:28:34.6910618Z Reference file loading completed: 1 files loaded successfully
2025-06-15T03:28:34.6911198Z Processing time: 1ms
2025-06-15T03:28:34.6936648Z Average speed: 1201.6 files/second
2025-06-15T03:28:34.6937346Z Found 50 source policies (Json) and 50 reference policies (Terraform)
2025-06-15T03:28:34.7024575Z Starting cross-format comparison between '/tmp/CrossFormatIntegrationTests_fbe9de04/source' and '/tmp/CrossFormatIntegrationTests_fbe9de04/reference'
2025-06-15T03:28:34.7067323Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_MatchingById_SameId_ShouldMatch [11 ms]
2025-06-15T03:28:34.7070463Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithNullConditions_ShouldHandleGracefully [9 ms]
2025-06-15T03:28:34.7073105Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_MatchingByName_SameName_ShouldMatch [6 ms]
2025-06-15T03:28:34.7075341Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_InvalidTerraformSyntax_ShouldSkipAndContinue [13 ms]
2025-06-15T03:28:34.7077762Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithGenerateProvider_ShouldCreateProviderFile [15 ms]
2025-06-15T03:28:34.7080099Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_TfStateWithMultipleInstances_ShouldParseAll [143 ms]
2025-06-15T03:28:34.7082814Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceIntegrationTests.CompareLargeNumberOfPolicies_ShouldPerformWithinReasonableTime [323 ms]
2025-06-15T03:28:34.7113347Z Validating 3 policy files using parallel processing...
2025-06-15T03:28:34.7114400Z Found 2 source policies (Json) and 2 reference policies (Terraform)
2025-06-15T03:28:34.7129682Z Validation completed: 0 valid, 3 invalid files
2025-06-15T03:28:34.7130267Z Processing time: 7ms
2025-06-15T03:28:34.7130688Z Average speed: 447.3 files/second
2025-06-15T03:28:34.7131455Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-15T03:28:34.7132616Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-15T03:28:34.7133469Z Reference file validation failed. Found 3 invalid files out of 3.
2025-06-15T03:28:34.7140327Z       Suggestion: Ensure the JSON is well-formed. Check for missing commas, brackets, or quotes.
2025-06-15T03:28:34.7141382Z       Suggestion: Ensure the JSON is well-formed. Check for missing commas, brackets, or quotes.
2025-06-15T03:28:34.7142524Z Loading 3 reference policy files using parallel processing...
2025-06-15T03:28:34.7143317Z   ✗ valid-policy.json: 2 errors
2025-06-15T03:28:34.7144245Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-15T03:28:34.7145199Z     - Display name is missing or empty.
2025-06-15T03:28:34.7145785Z   ✗ incomplete.json: 1 errors
2025-06-15T03:28:34.7160445Z     - Invalid JSON syntax: Unexpected character encountered while parsing value: i. Path 'name', line 1, position 10. (line 1)
2025-06-15T03:28:34.7161754Z   ✗ malformed.json: 1 errors
2025-06-15T03:28:34.7162853Z     - Invalid JSON syntax: Invalid character after parsing property name. Expected ':' but got: j. Path '', line 1, position 10. (line 1)
2025-06-15T03:28:34.7180861Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_ReferenceOnlyPolicy_ShouldReportAsReferenceOnly [10 ms]
2025-06-15T03:28:34.7185238Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_LocationsConditions_ShouldMapCorrectly [311 ms]
2025-06-15T03:28:34.7187649Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithSpecialCharactersInDisplayName_ShouldSanitizeResourceName [13 ms]
2025-06-15T03:28:34.7229028Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_ValidTfStateBackupFile_ShouldParseSuccessfully [2 ms]
2025-06-15T03:28:34.7231696Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceIntegrationTests.CompareWithCustomMappings_ComplexScenario_ShouldFollowMappings [13 ms]
2025-06-15T03:28:34.7234058Z Loading reference files: Progress: 1/3 (33.3%) - 1001.9 items/sec, ETA: 00:00
2025-06-15T03:28:34.7234988Z Loading reference files: Progress: 2/3 (66.7%) - 522.4 items/sec, ETA: 00:00
2025-06-15T03:28:34.7235905Z Loading reference files: Progress: 3/3 (100.0%) - 756.6 items/sec, ETA: 00:00
2025-06-15T03:28:34.7237320Z Failed to load reference file 'malformed.json': Invalid character after parsing property name. Expected ':' but got: j. Path '', line 1, position 10.
2025-06-15T03:28:34.7238638Z   Invalid JSON syntax at line 1, position 10
2025-06-15T03:28:34.7239827Z Failed to load reference file 'incomplete.json': Unexpected character encountered while parsing value: i. Path 'name', line 1, position 10.
2025-06-15T03:28:34.7240873Z   Invalid JSON syntax at line 1, position 10
2025-06-15T03:28:34.7241534Z   Suggestion: Check the JSON structure for missing commas, brackets, or quotes.
2025-06-15T03:28:34.7242575Z   Suggestion: Check the JSON structure for missing commas, brackets, or quotes.
2025-06-15T03:28:34.7243433Z Reference file loading completed: 1 files loaded successfully
2025-06-15T03:28:34.7244030Z Processing time: 5ms
2025-06-15T03:28:34.7244464Z Average speed: 549.5 files/second
2025-06-15T03:28:34.7245760Z Starting cross-format comparison between '/tmp/CrossFormatIntegrationTests_250978fd/source' and '/tmp/CrossFormatIntegrationTests_250978fd/reference'
2025-06-15T03:28:34.7247265Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-15T03:28:34.7248527Z No JSON files found in directory: /tmp/test-ref-both-empty. No files were processed.
2025-06-15T03:28:34.7270216Z ✓ All 0 reference files are valid
2025-06-15T03:28:34.7271087Z No JSON files found in reference directory '/tmp/test-ref-both-empty'
2025-06-15T03:28:34.7272474Z Validating 1 policy files using parallel processing...
2025-06-15T03:28:34.7273818Z Converting policies: Progress: 1/1 (100.0%) - 2144.5 items/sec, ETA: 00:00
2025-06-15T03:28:34.7280848Z Policy conversion completed in 5ms
2025-06-15T03:28:34.7300310Z Validation completed: 0 valid, 1 invalid files
2025-06-15T03:28:34.7305150Z Processing time: 2ms
2025-06-15T03:28:34.7307995Z Average speed: 515.5 files/second
2025-06-15T03:28:34.7342760Z Reference file validation failed. Found 1 invalid files out of 1.
2025-06-15T03:28:34.7344262Z   ✗ policy1.json: 2 errors
2025-06-15T03:28:34.7346640Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-15T03:28:34.7347679Z     - Display name is missing or empty.
2025-06-15T03:28:34.7348457Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-15T03:28:34.7349333Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-15T03:28:34.7358660Z Loading 1 reference policy files using parallel processing...
2025-06-15T03:28:34.7359405Z Average speed: 205.5 policies/second
2025-06-15T03:28:34.7360182Z Loading reference files: Progress: 1/1 (100.0%) - 352.5 items/sec, ETA: 00:00
2025-06-15T03:28:34.7361049Z Reference file loading completed: 1 files loaded successfully
2025-06-15T03:28:34.7361629Z Processing time: 4ms
2025-06-15T03:28:34.7368380Z Average speed: 255.9 files/second
2025-06-15T03:28:34.7413566Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformDirectoryAsync_EmptyDirectory_ShouldReturnEmptyResults [5 ms]
2025-06-15T03:28:34.7418514Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithMinimalPolicy_ShouldGenerateCorrectHCL [10 ms]
2025-06-15T03:28:34.7423389Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_ReferenceDirectoryWithMalformedJson_ShouldSkipMalformedFiles [16 ms]
2025-06-15T03:28:34.7425508Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_BothEmpty_ShouldReturnEmptyResult [2 ms]
2025-06-15T03:28:34.7427879Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformDirectoryAsync_DirectoryWithValidAndInvalidFiles_ShouldParseValidOnesAndReportErrors [12 ms]
2025-06-15T03:28:34.7444167Z   Passed ConditionalAccessExporter.Tests.ParallelProcessingServiceTests.ProcessInParallelAsync_WithCustomParallelism_RespectsMaxDegreeOfParallelism [407 ms]
2025-06-15T03:28:34.7445634Z   Standard Output Messages:
2025-06-15T03:28:34.7446067Z  Max concurrent operations observed: 3
2025-06-15T03:28:34.7446840Z  Configured max degree of parallelism: 3
2025-06-15T03:28:34.7447194Z 
2025-06-15T03:28:34.7447211Z 
2025-06-15T03:28:34.7516987Z No JSON files found in directory: /tmp/test-ref-custom-mapping-missing. No files were processed.
2025-06-15T03:28:34.7518741Z ✓ All 0 reference files are valid
2025-06-15T03:28:34.7519783Z No JSON files found in reference directory '/tmp/test-ref-custom-mapping-missing'
2025-06-15T03:28:34.7522902Z Starting cross-format comparison between '/tmp/CrossFormatTests_7bdbadd2/source' and '/tmp/CrossFormatTests_7bdbadd2/reference'
2025-06-15T03:28:34.7557386Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_ValidTfFileWithMultiplePolicies_ShouldParseAll [9 ms]
2025-06-15T03:28:34.7559106Z Reference file validation failed. Found 0 invalid files out of 0.
2025-06-15T03:28:34.7559867Z Reference directory 'dummy-path' does not exist
2025-06-15T03:28:34.7560599Z Reference file validation failed. Found 0 invalid files out of 0.
2025-06-15T03:28:34.7561350Z Reference directory 'dummy-path' does not exist
2025-06-15T03:28:34.7562446Z No JSON files found in directory: /tmp/test-ref-dir. No files were processed.
2025-06-15T03:28:34.7563371Z ✓ All 0 reference files are valid
2025-06-15T03:28:34.7564060Z No JSON files found in reference directory '/tmp/test-ref-dir'
2025-06-15T03:28:34.7573500Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_CaseSensitiveTrue_DifferentCase_ShouldNotMatch [15 ms]
2025-06-15T03:28:34.7575933Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithSessionControls_ShouldMapCorrectly [24 ms]
2025-06-15T03:28:34.7578310Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.ParseEntraExport_InvalidJsonString_ShouldThrowException [4 ms]
2025-06-15T03:28:34.7580723Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_CustomMapping_NonExistentReference_ShouldReportAsEntraOnly [1 ms]
2025-06-15T03:28:34.7583080Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.ParseEntraExport_NullInput_ShouldThrowException [1 ms]
2025-06-15T03:28:34.7585233Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithInvalidJson_ShouldHandleErrorGracefully [5 ms]
2025-06-15T03:28:34.7612821Z Found 4 source policies (Json) and 4 reference policies (Terraform)
2025-06-15T03:28:34.7631594Z Validating 1 policy files using parallel processing...
2025-06-15T03:28:34.7632935Z Validation completed: 0 valid, 1 invalid files
2025-06-15T03:28:34.7641444Z Processing time: 2ms
2025-06-15T03:28:34.7648967Z Average speed: 415.9 files/second
2025-06-15T03:28:34.7657343Z Reference file validation failed. Found 1 invalid files out of 1.
2025-06-15T03:28:34.7692824Z   ✗ valid-policy.json: 2 errors
2025-06-15T03:28:34.7694134Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-15T03:28:34.7695175Z     - Display name is missing or empty.
2025-06-15T03:28:34.7695999Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-15T03:28:34.7696934Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-15T03:28:34.7697739Z Loading 1 reference policy files using parallel processing...
2025-06-15T03:28:34.7699192Z Loading reference files: Progress: 1/1 (100.0%) - 2659.6 items/sec, ETA: 00:00
2025-06-15T03:28:34.7700778Z Reference file loading completed: 1 files loaded successfully
2025-06-15T03:28:34.7704860Z Processing time: 1ms
2025-06-15T03:28:34.7705532Z Average speed: 1996.0 files/second
2025-06-15T03:28:34.7707901Z Starting cross-format comparison between '/tmp/CrossFormatIntegrationTests_65b3cb5d/source' and '/tmp/CrossFormatIntegrationTests_65b3cb5d/reference'
2025-06-15T03:28:34.7710022Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_FullyPopulatedPolicy_ShouldMapAllAttributes [12 ms]
2025-06-15T03:28:34.7712659Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.ParseEntraExport_EmptyPoliciesArray_ShouldHandleGracefully [4 ms]
2025-06-15T03:28:34.7714669Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.ParseEntraExport_MissingTenantId_ShouldUseEmptyString [1 ms]
2025-06-15T03:28:34.7716541Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_ShouldSetReferenceDirectoryCorrectly [1 ms]
2025-06-15T03:28:34.7761216Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceIntegrationTests.CompareMixedFormats_MultiplePolicies_ShouldHandleAllCombinations [48 ms]
2025-06-15T03:28:34.7763954Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_TfFileWithVariableInterpolations_ShouldParseCorrectly [9 ms]
2025-06-15T03:28:34.7766258Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_VariableResolution_ShouldResolveCorrectly [55 ms]
2025-06-15T03:28:34.7767790Z Reference file validation failed. Found 0 invalid files out of 0.
2025-06-15T03:28:34.7768471Z Reference directory 'dummy-path' does not exist
2025-06-15T03:28:34.7769260Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-15T03:28:34.7770141Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-15T03:28:34.7770979Z Converting policies: Progress: 1/1 (100.0%) - 501.0 items/sec, ETA: 00:00
2025-06-15T03:28:34.7771636Z Policy conversion completed in 2ms
2025-06-15T03:28:34.7772255Z Average speed: 436.9 policies/second
2025-06-15T03:28:34.7807935Z Starting cross-format comparison between '/tmp/CrossFormatIntegrationTests_bb2100c9/source' and '/tmp/CrossFormatIntegrationTests_bb2100c9/reference'
2025-06-15T03:28:34.7814849Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_TfFileWithComments_ShouldIgnoreComments [1 ms]
2025-06-15T03:28:34.7826365Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_ReferenceDirectoryWithNonJsonFiles_ShouldIgnoreNonJsonFiles [11 ms]
2025-06-15T03:28:34.7828615Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithGrantControls_ShouldMapCorrectly [19 ms]
2025-06-15T03:28:34.7830730Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.ParseEntraExport_MissingPoliciesProperty_ShouldHandleGracefully [4 ms]
2025-06-15T03:28:34.7832992Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_ValidTfStateFile_ShouldParseSuccessfully [7 ms]
2025-06-15T03:28:34.7835397Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceIntegrationTests.CompareWithMixedFileTypes_ShouldIgnoreNonPolicyFiles [14 ms]
2025-06-15T03:28:34.7885563Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-15T03:28:34.7946041Z Starting cross-format comparison between '/tmp/CrossFormatIntegrationTests_4cf7e498/source' and '/tmp/CrossFormatIntegrationTests_4cf7e498/reference'
2025-06-15T03:28:34.7957290Z Found 0 source policies (Mixed) and 0 reference policies (Mixed)
2025-06-15T03:28:34.7972828Z Starting cross-format comparison between '/tmp/CrossFormatIntegrationTests_31bd18c7/source' and '/tmp/CrossFormatIntegrationTests_31bd18c7/reference'
2025-06-15T03:28:34.8084564Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-15T03:28:34.8125317Z Validating 1 policy files using parallel processing...
2025-06-15T03:28:34.8156480Z Validation completed: 0 valid, 1 invalid files
2025-06-15T03:28:34.8158646Z Processing time: 1ms
2025-06-15T03:28:34.8159306Z Average speed: 1215.1 files/second
2025-06-15T03:28:34.8164358Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-15T03:28:34.8165935Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-15T03:28:34.8168774Z Loading 1 reference policy files using parallel processing...
2025-06-15T03:28:34.8170151Z Reference file validation failed. Found 1 invalid files out of 1.
2025-06-15T03:28:34.8171267Z   ✗ complex-policy.json: 2 errors
2025-06-15T03:28:34.8172570Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-15T03:28:34.8173714Z     - Display name is missing or empty.
2025-06-15T03:28:34.8174618Z Loading reference files: Progress: 1/1 (100.0%) - 2206.5 items/sec, ETA: 00:00
2025-06-15T03:28:34.8175628Z Reference file loading completed: 1 files loaded successfully
2025-06-15T03:28:34.8176407Z Processing time: 1ms
2025-06-15T03:28:34.8177930Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_PolicyWithMissingRequiredAttributes_ShouldHandleGracefully [4 ms]
2025-06-15T03:28:34.8181678Z   Passed ConditionalAccessExporter.Tests.JsonToTerraformServiceTests.ConvertJsonToTerraformAsync_WithGenerateVariables_ShouldCreateVariablesFile [19 ms]
2025-06-15T03:28:34.8184611Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceIntegrationTests.CompareComplexPolicies_MultipleConditionsAndControls_ShouldAnalyzeCorrectly [10 ms]
2025-06-15T03:28:34.8187238Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_UnknownFileExtension_ShouldAttemptHclParsing [10 ms]
2025-06-15T03:28:34.8189664Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceIntegrationTests.CompareWithEmptyDirectories_ShouldHandleGracefully [6 ms]
2025-06-15T03:28:34.8207306Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformDirectoryAsync_DirectoryWithSubdirectories_ShouldParseRecursively [10 ms]
2025-06-15T03:28:34.8216268Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceIntegrationTests.CompareWithDifferentNamingConventions_ShouldDetectSimilarPolicies [13 ms]
2025-06-15T03:28:34.8219763Z   Passed ConditionalAccessExporter.Tests.TerraformParsingServiceTests.ParseTerraformFileAsync_TfStateWithNoResources_ShouldReturnEmpty [8 ms]
2025-06-15T03:28:34.8222296Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_GrantControls_ShouldMapCorrectly [48 ms]
2025-06-15T03:28:34.8231820Z Average speed: 1074.7 files/second
2025-06-15T03:28:34.8232820Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-15T03:28:34.8233711Z Reference file validation failed. Found 0 invalid files out of 0.
2025-06-15T03:28:34.8234394Z Reference directory 'dummy-path' does not exist
2025-06-15T03:28:34.8248558Z Converting policies: Progress: 1/1 (100.0%) - 209.7 items/sec, ETA: 00:00
2025-06-15T03:28:34.8250768Z Policy conversion completed in 5ms
2025-06-15T03:28:34.8253362Z Average speed: 206.3 policies/second
2025-06-15T03:28:34.8265544Z Validating 1 policy files using parallel processing...
2025-06-15T03:28:34.8269089Z Validation completed: 0 valid, 1 invalid files
2025-06-15T03:28:34.8270019Z Processing time: 0ms
2025-06-15T03:28:34.8270636Z Average speed: 2333.2 files/second
2025-06-15T03:28:34.8271444Z       Suggestion: Ensure the policy structure matches the defined schema. Check field names and types.
2025-06-15T03:28:34.8272600Z       Suggestion: Provide a descriptive display name for the policy.
2025-06-15T03:28:34.8273411Z Loading 1 reference policy files using parallel processing...
2025-06-15T03:28:34.8274181Z Reference file validation failed. Found 1 invalid files out of 1.
2025-06-15T03:28:34.8274926Z   ✗ policy1.json: 2 errors
2025-06-15T03:28:34.8276058Z     - Required properties are missing from object: displayName, conditions, grantControls, state. Path '', line 1, position 1.
2025-06-15T03:28:34.8277032Z     - Display name is missing or empty.
2025-06-15T03:28:34.8277788Z Loading reference files: Progress: 1/1 (100.0%) - 4606.2 items/sec, ETA: 00:00
2025-06-15T03:28:34.8278623Z Reference file loading completed: 1 files loaded successfully
2025-06-15T03:28:34.8279421Z Processing time: 0ms
2025-06-15T03:28:34.8279835Z Average speed: 3093.1 files/second
2025-06-15T03:28:34.8302425Z Reference file validation failed. Found 0 invalid files out of 0.
2025-06-15T03:28:34.8303631Z Reference directory '/tmp/non-existent-directory' does not exist
2025-06-15T03:28:34.8501117Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-15T03:28:34.8513000Z Converting policies: Progress: 1/1 (100.0%) - 8888.9 items/sec, ETA: 00:00
2025-06-15T03:28:34.8529717Z Policy conversion completed in 0ms
2025-06-15T03:28:34.8530325Z Average speed: 3701.0 policies/second
2025-06-15T03:28:34.8531119Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-15T03:28:34.8535977Z Policy conversion completed in 1ms
2025-06-15T03:28:34.8540921Z Average speed: 1241.0 policies/second
2025-06-15T03:28:34.8543868Z Converting policies: Progress: 1/1 (100.0%) - 1517.7 items/sec, ETA: 00:00
2025-06-15T03:28:34.8547388Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-15T03:28:34.8552101Z Policy conversion completed in 0ms
2025-06-15T03:28:34.8553688Z Average speed: 5952.4 policies/second
2025-06-15T03:28:34.8557536Z Converting policies: Progress: 1/1 (100.0%) - 10515.2 items/sec, ETA: 00:00
2025-06-15T03:28:34.8558791Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-15T03:28:34.8561239Z Converting policies: Progress: 1/1 (100.0%) - 4271.7 items/sec, ETA: 00:00
2025-06-15T03:28:34.8562090Z Policy conversion completed in 1ms
2025-06-15T03:28:34.8562603Z Average speed: 1234.9 policies/second
2025-06-15T03:28:34.8563361Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-15T03:28:34.8564321Z Converting policies: Progress: 1/1 (100.0%) - 6150.1 items/sec, ETA: 00:00
2025-06-15T03:28:34.8565027Z Policy conversion completed in 1ms
2025-06-15T03:28:34.8565536Z Average speed: 1873.0 policies/second
2025-06-15T03:28:34.8577419Z No Terraform policies found to convert.
2025-06-15T03:28:34.8603014Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_ComplexNestedDifferences_ShouldDetectCorrectly [46 ms]
2025-06-15T03:28:34.8618045Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.ParseEntraExport_ValidJsonString_ShouldParseCorrectly [1 ms]
2025-06-15T03:28:34.8624744Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_EmptyEntraExport_ShouldReportAllAsReferenceOnly [6 ms]
2025-06-15T03:28:34.8630433Z   Passed ConditionalAccessExporter.Tests.PolicyComparisonServiceTests.CompareAsync_NonExistentReferenceDirectory_ShouldHandleGracefully [2 ms]
2025-06-15T03:28:34.8633123Z   Passed ConditionalAccessExporter.Tests.ParallelProcessingServiceTests.ProcessInParallelAsync_WithCancellation_ThrowsOperationCancelledException [111 ms]
2025-06-15T03:28:34.8635532Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_SingleFullyPopulatedPolicy_ShouldConvertSuccessfully [35 ms]
2025-06-15T03:28:34.8638207Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_DifferentStates_ShouldMapCorrectly(terraformState: "enabled", expectedState: "enabled") [1 ms]
2025-06-15T03:28:34.8641077Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_DifferentStates_ShouldMapCorrectly(terraformState: "invalid", expectedState: "disabled") [1 ms]
2025-06-15T03:28:34.8643279Z Converting 2 Terraform policies to Graph JSON format using parallel processing...
2025-06-15T03:28:34.8644616Z Converting policies: Progress: 1/2 (50.0%) - 573.7 items/sec, ETA: 00:00
2025-06-15T03:28:34.8645560Z Converting policies: Progress: 2/2 (100.0%) - 1080.4 items/sec, ETA: 00:00
2025-06-15T03:28:34.8646285Z Policy conversion completed in 2ms
2025-06-15T03:28:34.8646795Z Average speed: 1052.0 policies/second
2025-06-15T03:28:34.8647595Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-15T03:28:34.8648872Z Converting policies: Progress: 1/1 (100.0%) - 5820.7 items/sec, ETA: 00:00
2025-06-15T03:28:34.8649597Z Policy conversion completed in 0ms
2025-06-15T03:28:34.8650109Z Average speed: 4118.6 policies/second
2025-06-15T03:28:34.8669087Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-15T03:28:34.8682164Z Converting policies: Progress: 1/1 (100.0%) - 17182.1 items/sec, ETA: 00:00
2025-06-15T03:28:34.8682934Z Policy conversion completed in 0ms
2025-06-15T03:28:34.8683451Z Average speed: 2664.5 policies/second
2025-06-15T03:28:34.8694366Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_DifferentStates_ShouldMapCorrectly(terraformState: "enabledForReportingButNotEnforced", expectedState: "enabledForReportingButNotEnforced") [< 1 ms]
2025-06-15T03:28:34.8697576Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_DifferentStates_ShouldMapCorrectly(terraformState: null, expectedState: "disabled") [1 ms]
2025-06-15T03:28:34.8700371Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_DifferentStates_ShouldMapCorrectly(terraformState: "disabled", expectedState: "disabled") [< 1 ms]
2025-06-15T03:28:34.8703145Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_EmptyPoliciesList_ShouldReturnEmptyList [3 ms]
2025-06-15T03:28:34.8705420Z   Passed ConditionalAccessExporter.Tests.ParallelProcessingServiceTests.ProcessFilesInParallelAsync_WithTestFiles_ProcessesCorrectly [16 ms]
2025-06-15T03:28:34.8706800Z   Standard Output Messages:
2025-06-15T03:28:34.8707251Z  Processed 5 files with 5 progress reports
2025-06-15T03:28:34.8707589Z 
2025-06-15T03:28:34.8707601Z 
2025-06-15T03:28:34.8708682Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_PolicyConversionFailure_ShouldContinueWithOthers [2 ms]
2025-06-15T03:28:34.8711003Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_UnresolvedVariables_ShouldGenerateWarnings [1 ms]
2025-06-15T03:28:34.8713369Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_NullNestedObjects_ShouldHandleGracefully [2 ms]
2025-06-15T03:28:34.8729449Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-15T03:28:34.8730550Z Converting policies: Progress: 1/1 (100.0%) - 11627.9 items/sec, ETA: 00:00
2025-06-15T03:28:34.8731264Z Policy conversion completed in 0ms
2025-06-15T03:28:34.8731761Z Average speed: 2475.2 policies/second
2025-06-15T03:28:34.8875066Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-15T03:28:34.8882921Z Converting policies: Progress: 1/1 (100.0%) - 7127.6 items/sec, ETA: 00:00
2025-06-15T03:28:34.8884038Z Policy conversion completed in 0ms
2025-06-15T03:28:34.8884803Z Average speed: 5254.9 policies/second
2025-06-15T03:28:34.8927656Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-15T03:28:34.8928689Z Converting policies: Progress: 1/1 (100.0%) - 4086.6 items/sec, ETA: 00:00
2025-06-15T03:28:34.8929390Z Policy conversion completed in 0ms
2025-06-15T03:28:34.8929906Z Average speed: 3206.2 policies/second
2025-06-15T03:28:34.9004161Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-15T03:28:34.9005568Z Converting policies: Progress: 1/1 (100.0%) - 8912.7 items/sec, ETA: 00:00
2025-06-15T03:28:34.9012891Z Policy conversion completed in 0ms
2025-06-15T03:28:34.9013389Z Average speed: 5963.0 policies/second
2025-06-15T03:28:34.9058238Z Found 100 source policies (Json) and 100 reference policies (Terraform)
2025-06-15T03:28:34.9133985Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-15T03:28:34.9140662Z Policy conversion completed in 0ms
2025-06-15T03:28:34.9141500Z Average speed: 2835.3 policies/second
2025-06-15T03:28:34.9142409Z Converting policies: Progress: 1/1 (100.0%) - 9542.0 items/sec, ETA: 00:00
2025-06-15T03:28:34.9224739Z Starting cross-format comparison between '/tmp/CrossFormatTests_a6625631/source' and '/tmp/CrossFormatTests_a6625631/reference'
2025-06-15T03:28:34.9237240Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-15T03:28:34.9243666Z Converting policies: Progress: 1/1 (100.0%) - 3112.4 items/sec, ETA: 00:00
2025-06-15T03:28:34.9258784Z Policy conversion completed in 2ms
2025-06-15T03:28:34.9274563Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_UsersConditions_ShouldMapCorrectly [21 ms]
2025-06-15T03:28:34.9286940Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_DataSourceReferences_ShouldGenerateWarnings [1 ms]
2025-06-15T03:28:34.9289348Z   Passed ConditionalAccessExporter.Tests.ParallelProcessingServiceTests.ProcessInParallelAsync_WithErrorsAndContinueOnError_HandlesErrorsGracefully [32 ms]
2025-06-15T03:28:34.9290800Z   Standard Output Messages:
2025-06-15T03:28:34.9291240Z  Successfully processed 7 out of 10 items
2025-06-15T03:28:34.9291731Z  Errors encountered: 3
2025-06-15T03:28:34.9292198Z 
2025-06-15T03:28:34.9292220Z 
2025-06-15T03:28:34.9300606Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_ClientApplicationsConditions_ShouldMapCorrectly [10 ms]
2025-06-15T03:28:34.9303155Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_PlatformsConditions_ShouldMapCorrectly [11 ms]
2025-06-15T03:28:34.9305551Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_LargeNumberOfPolicies_ShouldHandleEfficiently [235 ms]
2025-06-15T03:28:34.9307898Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_ApplicationsConditions_ShouldMapCorrectly [12 ms]
2025-06-15T03:28:34.9309323Z Average speed: 560.7 policies/second
2025-06-15T03:28:34.9310019Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-15T03:28:34.9328231Z Starting cross-format comparison between '/tmp/CrossFormatTests_1c2f0205/source' and '/tmp/CrossFormatTests_1c2f0205/reference'
2025-06-15T03:28:34.9329479Z Found 1 source policies (Json) and 0 reference policies (Mixed)
2025-06-15T03:28:34.9362861Z Converting 3 Terraform policies to Graph JSON format using parallel processing...
2025-06-15T03:28:34.9364173Z Converting policies: Progress: 1/3 (33.3%) - 5027.7 items/sec, ETA: 00:00
2025-06-15T03:28:34.9365357Z Converting policies: Progress: 2/3 (66.7%) - 7898.9 items/sec, ETA: 00:00
2025-06-15T03:28:34.9366480Z Converting policies: Progress: 3/3 (100.0%) - 8600.9 items/sec, ETA: 00:00
2025-06-15T03:28:34.9368041Z Starting cross-format comparison between '/tmp/CrossFormatTests_1f54a540/source' and '/tmp/CrossFormatTests_1f54a540/reference'
2025-06-15T03:28:34.9369336Z Policy conversion completed in 2ms
2025-06-15T03:28:34.9369994Z Average speed: 1888.7 policies/second
2025-06-15T03:28:34.9370800Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-15T03:28:34.9417573Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-15T03:28:34.9441621Z Converting policies: Progress: 1/1 (100.0%) - 1551.8 items/sec, ETA: 00:00
2025-06-15T03:28:34.9446461Z Policy conversion completed in 1ms
2025-06-15T03:28:34.9450868Z Average speed: 712.9 policies/second
2025-06-15T03:28:34.9479101Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_LocalResolution_ShouldResolveCorrectly [5 ms]
2025-06-15T03:28:34.9481678Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_ReadOnlyFileSystem_ShouldNotThrow [9 ms]
2025-06-15T03:28:34.9484268Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_EmptyReferenceDirectory_ShouldHandleGracefully [2 ms]
2025-06-15T03:28:34.9486792Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_MultiplePolicies_ShouldConvertAll [7 ms]
2025-06-15T03:28:34.9489006Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_CustomMapping_ShouldUseCustomMappings [5 ms]
2025-06-15T03:28:34.9491313Z   Passed ConditionalAccessExporter.Tests.ParallelProcessingServiceTests.ProcessInParallelAsync_WithValidItems_ProcessesSuccessfully [50 ms]
2025-06-15T03:28:34.9496689Z   Standard Output Messages:
2025-06-15T03:28:34.9497136Z  Processed 10 items in 44.2924ms
2025-06-15T03:28:34.9497577Z  Average speed: 225.77 items/second
2025-06-15T03:28:34.9497869Z 
2025-06-15T03:28:34.9497880Z 
2025-06-15T03:28:34.9498878Z   Passed ConditionalAccessExporter.Tests.ParallelProcessingServiceTests.GetOptimalDegreeOfParallelism_ReturnsReasonableValue [< 1 ms]
2025-06-15T03:28:34.9500174Z   Standard Output Messages:
2025-06-15T03:28:34.9500626Z  Optimal parallelism: 3 (System cores: 4)
2025-06-15T03:28:34.9500963Z 
2025-06-15T03:28:34.9500974Z 
2025-06-15T03:28:34.9518554Z Starting cross-format comparison between '/tmp/CrossFormatTests_4d71692d/source' and '/tmp/CrossFormatTests_4d71692d/reference'
2025-06-15T03:28:34.9522310Z Warning: Failed to load JSON file '/tmp/CrossFormatTests_4d71692d/source/malformed.json': Invalid character after parsing property name. Expected ':' but got: j. Path '', line 1, position 10.
2025-06-15T03:28:34.9532906Z Found 1 source policies (Json) and 0 reference policies (Mixed)
2025-06-15T03:28:34.9534260Z Starting cross-format comparison between '/tmp/CrossFormatTests_813f74c6/source' and '/tmp/CrossFormatTests_813f74c6/reference'
2025-06-15T03:28:34.9535536Z Found 0 source policies (Mixed) and 1 reference policies (Terraform)
2025-06-15T03:28:34.9623635Z Starting cross-format comparison between '/tmp/CrossFormatTests_a13a4b3b/source' and '/tmp/CrossFormatTests_a13a4b3b/reference'
2025-06-15T03:28:34.9641347Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-15T03:28:34.9754975Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-15T03:28:34.9758180Z Converting policies: Progress: 1/1 (100.0%) - 7745.9 items/sec, ETA: 00:00
2025-06-15T03:28:34.9761646Z Policy conversion completed in 0ms
2025-06-15T03:28:34.9763637Z Average speed: 4562.0 policies/second
2025-06-15T03:28:34.9833254Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-15T03:28:34.9837946Z Converting policies: Progress: 1/1 (100.0%) - 9794.3 items/sec, ETA: 00:00
2025-06-15T03:28:34.9842905Z Policy conversion completed in 0ms
2025-06-15T03:28:34.9846025Z Average speed: 5920.7 policies/second
2025-06-15T03:28:34.9902867Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-15T03:28:34.9904441Z Converting policies: Progress: 1/1 (100.0%) - 4957.9 items/sec, ETA: 00:00
2025-06-15T03:28:34.9905362Z Policy conversion completed in 0ms
2025-06-15T03:28:34.9906493Z Average speed: 2750.3 policies/second
2025-06-15T03:28:34.9992925Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-15T03:28:34.9994332Z Converting policies: Progress: 1/1 (100.0%) - 8952.6 items/sec, ETA: 00:00
2025-06-15T03:28:34.9995340Z Policy conversion completed in 0ms
2025-06-15T03:28:34.9996839Z Average speed: 4088.3 policies/second
2025-06-15T03:28:35.0066587Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_MalformedJsonFile_ShouldSkipAndContinue [11 ms]
2025-06-15T03:28:35.0069576Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_ReferenceOnlyPolicy_ShouldReturnReferenceOnlyStatus [2 ms]
2025-06-15T03:28:35.0073752Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_ByNameCaseInsensitive_ShouldIgnoreCase [12 ms]
2025-06-15T03:28:35.0077563Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_SessionControls_ShouldMapCorrectly [37 ms]
2025-06-15T03:28:35.0087214Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_ClientAppTypes_ShouldMapCorrectly [7 ms]
2025-06-15T03:28:35.0089387Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_SpecialValues_ShouldMapCorrectly [4 ms]
2025-06-15T03:28:35.0091362Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_RiskLevels_ShouldMapCorrectly [9 ms]
2025-06-15T03:28:35.0093665Z   Passed ConditionalAccessExporter.Tests.ParallelProcessingServiceTests.ProcessInParallelAsync_WithProgressReporting_ReportsProgressCorrectly [58 ms]
2025-06-15T03:28:35.0094971Z   Standard Output Messages:
2025-06-15T03:28:35.0095479Z  Progress: Progress: 5/20 (25.0%) - 191.9 items/sec, ETA: 00:00
2025-06-15T03:28:35.0096145Z  Progress: Progress: 10/20 (50.0%) - 275.3 items/sec, ETA: 00:00
2025-06-15T03:28:35.0096811Z  Progress: Progress: 15/20 (75.0%) - 322.4 items/sec, ETA: 00:00
2025-06-15T03:28:35.0097456Z  Progress: Progress: 20/20 (100.0%) - 352.8 items/sec, ETA: 00:00
2025-06-15T03:28:35.0098012Z  Received 4 progress reports
2025-06-15T03:28:35.0098285Z 
2025-06-15T03:28:35.0098302Z 
2025-06-15T03:28:35.0099119Z Starting cross-format comparison between '/tmp/CrossFormatTests_8c07ab38/source' and '/tmp/CrossFormatTests_8c07ab38/reference'
2025-06-15T03:28:35.0202825Z Converting 1 Terraform policies to Graph JSON format using parallel processing...
2025-06-15T03:28:35.0208185Z Converting policies: Progress: 1/1 (100.0%) - 8650.5 items/sec, ETA: 00:00
2025-06-15T03:28:35.0208889Z Policy conversion completed in 0ms
2025-06-15T03:28:35.0209373Z Average speed: 5230.1 policies/second
2025-06-15T03:28:35.0575918Z Found 50 source policies (Json) and 50 reference policies (Terraform)
2025-06-15T03:28:35.0616763Z Starting cross-format comparison between '/tmp/CrossFormatTests_a72b102a/source' and '/tmp/CrossFormatTests_a72b102a/nonexistent-reference'
2025-06-15T03:28:35.0623589Z Found 0 source policies (Mixed) and 0 reference policies (Unknown)
2025-06-15T03:28:35.4720297Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_GeneralStructure_ShouldBeCorrect [10 ms]
2025-06-15T03:28:35.4722980Z   Passed ConditionalAccessExporter.Tests.TerraformConversionServiceTests.ConvertToGraphJsonAsync_MinimalRequiredFields_ShouldConvertWithDefaults [15 ms]
2025-06-15T03:28:35.4725833Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_PerformanceWithManyComplexPolicies_ShouldCompleteWithinReasonableTime [95 ms]
2025-06-15T03:28:35.4728671Z   Passed ConditionalAccessExporter.Tests.CrossFormatPolicyComparisonServiceTests.ComparePoliciesAsync_NonExistentReferenceDirectory_ShouldHandleGracefully [1 ms]
2025-06-15T03:28:35.4731045Z   Passed ConditionalAccessExporter.Tests.PerformanceBenchmarkServiceTests.MonitorMemoryUsageAsync_WithException_HandlesGracefully [89 ms]
2025-06-15T03:28:35.4733538Z   Passed ConditionalAccessExporter.Tests.PerformanceBenchmarkServiceTests.MonitorMemoryUsageAsync_WithSimpleOperation_ReturnsValidResults [115 ms]
2025-06-15T03:28:35.4735785Z   Passed ConditionalAccessExporter.Tests.PerformanceBenchmarkServiceTests.MemoryUsageResult_FormattedProperties_ReturnValidStrings [< 1 ms]
2025-06-15T03:28:35.4738017Z   Passed ConditionalAccessExporter.Tests.PerformanceBenchmarkServiceTests.PerformanceBenchmarkService_WithProgressReporter_ReportsProgress [108 ms]
2025-06-15T03:28:35.4740936Z   Passed ConditionalAccessExporter.Tests.PerformanceBenchmarkServiceTests.RunPerformanceRegressionTestsAsync_WithValidThresholds_ReturnsResults [152 ms]
2025-06-15T03:28:35.8979141Z   Passed ConditionalAccessExporter.Tests.PerformanceBenchmarkServiceTests.RunPerformanceRegressionTestsAsync_WithStrictThresholds_DetectsFailures [152 ms]
2025-06-15T03:28:35.8980455Z   Passed ConditionalAccessExporter.Tests.PerformanceBenchmarkServiceTests.MonitorMemoryUsageAsync_WithCancellation_HandlesCancellation [59 ms]
2025-06-15T03:28:35.8982129Z   Passed ConditionalAccessExporter.Tests.PerformanceBenchmarkServiceTests.RegressionTestResult_FormattedResult_ReturnsValidString [< 1 ms]
2025-06-15T03:28:35.8983128Z   Passed ConditionalAccessExporter.Tests.ProgressIndicatorTests.ProgressInfo_FormattedProperties_ReturnValidStrings [4 ms]
2025-06-15T03:28:35.8984051Z   Passed ConditionalAccessExporter.Tests.ProgressIndicatorTests.ProgressInfo_ToString_ReturnsComprehensiveString [< 1 ms]
2025-06-15T03:28:35.8984983Z   Passed ConditionalAccessExporter.Tests.ProgressIndicatorTests.ProgressIndicator_SetProgress_UpdatesCorrectly [103 ms]
2025-06-15T03:28:35.8985956Z   Passed ConditionalAccessExporter.Tests.ProgressIndicatorTests.PerformanceThresholdMonitor_CheckProgress_CallsProgressReporter [103 ms]
2025-06-15T03:28:35.8986964Z   Passed ConditionalAccessExporter.Tests.ProgressIndicatorTests.ProgressIndicator_Constructor_InitializesCorrectly [< 1 ms]
2025-06-15T03:28:35.8987910Z   Passed ConditionalAccessExporter.Tests.ProgressIndicatorTests.ProgressInfo_EstimatedTimeRemaining_CalculatesCorrectly [< 1 ms]
2025-06-15T03:28:36.3993722Z Test: 1/10 (10.0%) | Elapsed: 00:00:00 | ETA: Calculating... | Rate: 0.0 items/sec | Memory: 0.0 MB | Delta: +0.0 MB
2025-06-15T03:28:36.4006187Z Test message
2025-06-15T03:28:36.4047806Z Markdown cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/91dfe6e4-2cb1-475a-af13-87b57bba739d/cross-format-comparison-20250615-032836.md
2025-06-15T03:28:36.4181409Z Cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/fc87d036-e04d-401d-acc7-316157622d60/cross-format-comparison-20250615-032836.json
2025-06-15T03:28:36.4201059Z HTML cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/fc87d036-e04d-401d-acc7-316157622d60/cross-format-comparison-20250615-032836.html
2025-06-15T03:28:36.4209253Z Markdown cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/fc87d036-e04d-401d-acc7-316157622d60/cross-format-comparison-20250615-032836.md
2025-06-15T03:28:36.4221099Z CSV cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/fc87d036-e04d-401d-acc7-316157622d60/cross-format-comparison-20250615-032836.csv
2025-06-15T03:28:36.4259386Z Cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/211f05d7-d758-4927-9cdc-5eef29427786/cross-format-comparison-20250615-032836.json
2025-06-15T03:28:36.4314151Z   Passed ConditionalAccessExporter.Tests.ProgressIndicatorTests.PerformanceThreshold_CheckThresholds_DetectsViolations [1 ms]
2025-06-15T03:28:36.4315217Z   Passed ConditionalAccessExporter.Tests.ProgressIndicatorTests.ProgressIndicator_IncrementProgress_UpdatesCorrectly [100 ms]
2025-06-15T03:28:36.4316337Z   Passed ConditionalAccessExporter.Tests.ProgressIndicatorTests.ProgressInfo_NegativeMemoryDelta_FormatsCorrectly [< 1 ms]
2025-06-15T03:28:36.4318226Z   Passed ConditionalAccessExporter.Tests.ProgressIndicatorTests.PerformanceThreshold_CheckThresholds_NoViolations_ReturnsEmpty [< 1 ms]
2025-06-15T03:28:36.4320112Z   Passed ConditionalAccessExporter.Tests.ProgressIndicatorTests.ProgressIndicator_Dispose_StopsUpdates [400 ms]
2025-06-15T03:28:36.4322103Z   Passed ConditionalAccessExporter.Tests.ProgressIndicatorTests.ConsoleProgressReporter_Report_DoesNotThrow [< 1 ms]
2025-06-15T03:28:36.4324158Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateMarkdownReport_ValidatesMarkdownSyntax [4 ms]
2025-06-15T03:28:36.4326780Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateReports_AllFormats_ShouldContainSameDataAccuracy [19 ms]
2025-06-15T03:28:36.4329174Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateJsonReport_WithEmptyResult_ShouldCreateValidJsonFile [4 ms]
2025-06-15T03:28:36.4331636Z Cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/26127923-5dce-421d-8418-5711306e48e4/cross-format-comparison-20250615-032836.json
2025-06-15T03:28:36.4453498Z HTML cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/d5f4816e-885e-493d-891b-8dc92df3d973/cross-format-comparison-20250615-032836.html
2025-06-15T03:28:36.4475753Z CSV cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/36a49ad1-f9e3-4e66-b2a0-6773e7aad58d/cross-format-comparison-20250615-032836.csv
2025-06-15T03:28:36.4493008Z Cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/f734272a-eae3-4159-bb99-94356beb1bd6/cross-format-comparison-20250615-032836.json
2025-06-15T03:28:36.4497733Z HTML cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/f734272a-eae3-4159-bb99-94356beb1bd6/cross-format-comparison-20250615-032836.html
2025-06-15T03:28:36.4500693Z Markdown cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/f734272a-eae3-4159-bb99-94356beb1bd6/cross-format-comparison-20250615-032836.md
2025-06-15T03:28:36.4507429Z CSV cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/f734272a-eae3-4159-bb99-94356beb1bd6/cross-format-comparison-20250615-032836.csv
2025-06-15T03:28:36.4524805Z HTML cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/2be5bb0a-7fd6-40be-8676-1814416b9132/cross-format-comparison-20250615-032836.html
2025-06-15T03:28:36.4550388Z Cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/a0b37aaf-b14c-4be4-81fa-1fe2d5af3064/cross-format-comparison-20250615-032836.json
2025-06-15T03:28:36.4559204Z CSV cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/b8e6d6b4-5011-49c1-be8a-8d91fe271bd9/cross-format-comparison-20250615-032836.csv
2025-06-15T03:28:36.4578620Z HTML cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/3ff47d4c-cffe-484b-b281-70917e7bd975/cross-format-comparison-20250615-032836.html
2025-06-15T03:28:36.4611395Z Cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/edf3844e-9741-4997-9aaf-6dd7e0de2ed2/new-directory/cross-format-comparison-20250615-032836.json
2025-06-15T03:28:36.4636201Z Markdown cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/8d791892-e301-4277-891c-bf4b89eae052/cross-format-comparison-20250615-032836.md
2025-06-15T03:28:36.4642937Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateReport_WithDefaultFormat_ShouldCreateJsonReport [14 ms]
2025-06-15T03:28:36.4645303Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateHtmlReport_WithSemanticallyEquivalent_ShouldDisplaySemanticInfo [1 ms]
2025-06-15T03:28:36.4647926Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateCsvReport_WithConversionSuggestions_ShouldReflectInHasSuggestions [1 ms]
2025-06-15T03:28:36.4650331Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateReport_WithEmptyResult_ShouldHandleGracefully [2 ms]
2025-06-15T03:28:36.4652816Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateHtmlReport_WithConversionSuggestions_ShouldDisplaySuggestions [1 ms]
2025-06-15T03:28:36.4655179Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateReport_WithUnknownFormat_ShouldDefaultToJson [1 ms]
2025-06-15T03:28:36.4657445Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateCsvReport_WithAllStatuses_ShouldCreateValidCsvFile [1 ms]
2025-06-15T03:28:36.4660040Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateHtmlReport_WithAllStatuses_ShouldCreateValidHtmlFile [2 ms]
2025-06-15T03:28:36.4662522Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateReport_CreatesOutputDirectory_WhenNotExists [1 ms]
2025-06-15T03:28:36.4681250Z Markdown cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/6f9bf4b9-6a61-4de8-8e4a-71e3362882b2/cross-format-comparison-20250615-032836.md
2025-06-15T03:28:36.4699140Z Cross-format comparison report generated: /tmp/CrossFormatReportGenerationTests/03603caf-85ac-4679-aa63-3a5b4d0b74fa/cross-format-comparison-20250615-032836.json
2025-06-15T03:28:36.4828145Z Starting cross-format comparison between '/tmp/EndToEndTests_f054f469/json-policies' and '/tmp/EndToEndTests_f054f469/terraform-policies'
2025-06-15T03:28:36.4841158Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-15T03:28:36.4917868Z Baseline Generation
2025-06-15T03:28:36.4918769Z ==================
2025-06-15T03:28:36.4919189Z Fetching policies from tenant...
2025-06-15T03:28:36.4926714Z Tenant ID: d385***
2025-06-15T03:28:36.4927992Z Client ID: 1c6d***
2025-06-15T03:28:36.4928516Z Client Secret: [HIDDEN]
2025-06-15T03:28:36.5254548Z Authenticating to Microsoft Graph...
2025-06-15T03:28:37.8661042Z Found 1 policies in tenant
2025-06-15T03:28:37.8666646Z Applied filter: Enabled policies only
2025-06-15T03:28:37.8670329Z After filtering: 1 policies selected
2025-06-15T03:28:37.8671038Z Generating baseline files for 1 policies using parallel processing...
2025-06-15T03:28:37.8870817Z Generated: notrustisrael.json
2025-06-15T03:28:37.8875800Z Generating baseline files: Progress: 1/1 (100.0%) - 49.9 items/sec, ETA: 00:00
2025-06-15T03:28:37.8878351Z Baseline file generation completed in 20ms
2025-06-15T03:28:37.8881136Z Average speed: 49.5 policies/second
2025-06-15T03:28:37.8881633Z Baseline Generation Summary:
2025-06-15T03:28:37.8882265Z ============================
2025-06-15T03:28:37.8882677Z Total policies fetched: 1
2025-06-15T03:28:37.8883090Z Policies after filtering: 1
2025-06-15T03:28:37.8883510Z Files generated: 1
2025-06-15T03:28:37.8884071Z Output directory: /tmp/EndToEndTests_c3b000c1/baseline-output
2025-06-15T03:28:37.8884660Z Generated files:
2025-06-15T03:28:37.8885013Z   - notrustisrael.json
2025-06-15T03:28:37.8885525Z Baseline generation completed successfully!
2025-06-15T03:28:37.8912863Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateMarkdownReport_WithAllStatuses_ShouldCreateValidMarkdownFile [2 ms]
2025-06-15T03:28:37.8916529Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateReports_ShouldLogFileGeneration [2 ms]
2025-06-15T03:28:37.8918855Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateMarkdownReport_WithSemanticallyEquivalent_ShouldFormatCorrectly [1 ms]
2025-06-15T03:28:37.8921285Z   Passed ConditionalAccessExporter.Tests.CrossFormatReportGenerationServiceTests.GenerateJsonReport_WithAllStatuses_ShouldCreateValidJsonFile [2 ms]
2025-06-15T03:28:37.8923903Z   Passed ConditionalAccessExporter.Tests.EndToEndWorkflowIntegrationTests.TemplateWorkflow_ListAndCreateTemplate_ShouldProvideTemplateCapabilities [3 ms]
2025-06-15T03:28:37.8925324Z   Standard Output Messages:
2025-06-15T03:28:37.8925810Z  Test directory: /tmp/EndToEndTests_cb0389bd
2025-06-15T03:28:37.8926496Z  No templates available - service returned empty list but functioned properly
2025-06-15T03:28:37.8927264Z  Template workflow: 0 templates available, 0 files created
2025-06-15T03:28:37.8927690Z 
2025-06-15T03:28:37.8927703Z 
2025-06-15T03:28:37.8928723Z   Passed ConditionalAccessExporter.Tests.EndToEndWorkflowIntegrationTests.ErrorHandlingWorkflow_MalformedFiles_ShouldHandleGracefully [2 ms]
2025-06-15T03:28:37.8930098Z   Standard Output Messages:
2025-06-15T03:28:37.8930568Z  Test directory: /tmp/EndToEndTests_1a7c0272
2025-06-15T03:28:37.8931518Z  Error handling test completed: Source files=2, Reference files=1
2025-06-15T03:28:37.8932343Z 
2025-06-15T03:28:37.8932358Z 
2025-06-15T03:28:37.8933263Z   Passed ConditionalAccessExporter.Tests.EndToEndWorkflowIntegrationTests.FileIOWorkflow_LargeFiles_ShouldHandleEfficiently [3 ms]
2025-06-15T03:28:37.8934479Z   Standard Output Messages:
2025-06-15T03:28:37.8935185Z  Test directory: /tmp/EndToEndTests_6fb267f6
2025-06-15T03:28:37.8935756Z  Large file I/O completed in 0.81ms, file size: 4151 bytes
2025-06-15T03:28:37.8936143Z 
2025-06-15T03:28:37.8936152Z 
2025-06-15T03:28:37.8937242Z   Passed ConditionalAccessExporter.Tests.EndToEndWorkflowIntegrationTests.CrossFormatComparisonWorkflow_JsonVsTerraform_ShouldAnalyzeCorrectly [3 ms]
2025-06-15T03:28:37.8938720Z   Standard Output Messages:
2025-06-15T03:28:37.8939208Z  Test directory: /tmp/EndToEndTests_f054f469
2025-06-15T03:28:37.8939800Z  Cross-format comparison completed with 1 comparisons
2025-06-15T03:28:37.8940208Z 
2025-06-15T03:28:37.8940222Z 
2025-06-15T03:28:37.8941382Z   Passed ConditionalAccessExporter.Tests.EndToEndWorkflowIntegrationTests.BaselineGenerationWorkflow_CreateFromJsonFiles_ShouldCreateValidBaseline [1 s]
2025-06-15T03:28:37.8943015Z   Standard Output Messages:
2025-06-15T03:28:37.8943485Z  Test directory: /tmp/EndToEndTests_c3b000c1
2025-06-15T03:28:37.8944039Z  Baseline generation completed with result: 0
2025-06-15T03:28:37.8944409Z 
2025-06-15T03:28:37.8944424Z 
2025-06-15T03:28:37.8945103Z No JSON files found in directory: /tmp/EndToEndTests_a16af290/terraform-validation. No files were processed.
2025-06-15T03:28:38.1834009Z custom_export.json
2025-06-15T03:28:38.7157048Z Conditional Access Policy Exporter
2025-06-15T03:28:38.7158638Z ==================================
2025-06-15T03:28:38.7159327Z Tenant ID: ***
2025-06-15T03:28:38.7160731Z Client ID: ***
2025-06-15T03:28:38.7161145Z Client Secret: [HIDDEN]
2025-06-15T03:28:38.7161561Z Authenticating to Microsoft Graph...
2025-06-15T03:28:38.7162324Z Fetching Conditional Access Policies...
2025-06-15T03:28:38.7162705Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.7163018Z       Conditional Access Policy Exporter
2025-06-15T03:28:38.7163342Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.7163610Z       ==================================
2025-06-15T03:28:38.7163903Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.7164271Z       Tenant ID: ***
2025-06-15T03:28:38.7164556Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.7164868Z       Client ID: ***
2025-06-15T03:28:38.7165121Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.7165391Z       Client Secret: [HIDDEN]
2025-06-15T03:28:38.7165657Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.7165968Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.7166258Z       Authenticating to Microsoft Graph...
2025-06-15T03:28:38.7166560Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.7166847Z       Fetching Conditional Access Policies...
2025-06-15T03:28:38.7167139Z Found 1 Conditional Access Policies
2025-06-15T03:28:38.7167545Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.7168027Z       Found 1 Conditional Access Policies
2025-06-15T03:28:38.7168544Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.7168997Z Policy Summary:
2025-06-15T03:28:38.7169299Z ================
2025-06-15T03:28:38.7169714Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.7170156Z       Policy Summary:
2025-06-15T03:28:38.7170587Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.7170988Z       ================
2025-06-15T03:28:38.7171338Z - notrustisrael (State: Enabled)
2025-06-15T03:28:38.7171788Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.7172494Z       - notrustisrael (State: Enabled)
2025-06-15T03:28:38.7173023Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.7173705Z Conditional Access Policies exported successfully to: custom_export.json
2025-06-15T03:28:38.7174665Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.7175337Z       Conditional Access Policies exported successfully to: custom_export.json
2025-06-15T03:28:38.7175949Z File size: 1.25 KB
2025-06-15T03:28:38.7176325Z Export completed successfully!
2025-06-15T03:28:38.7176838Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.7177610Z       File size: 1.25 KB
2025-06-15T03:28:38.7178098Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.7178600Z       Export completed successfully!
2025-06-15T03:28:38.7179134Z ConditionalAccessPolicies_20250615_032838.json
2025-06-15T03:28:38.9576515Z Conditional Access Policy Exporter
2025-06-15T03:28:38.9577298Z ==================================
2025-06-15T03:28:38.9578322Z Tenant ID: ***
2025-06-15T03:28:38.9578787Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.9579313Z       Conditional Access Policy Exporter
2025-06-15T03:28:38.9579872Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.9580363Z       ==================================
2025-06-15T03:28:38.9580883Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.9581578Z       Tenant ID: ***
2025-06-15T03:28:38.9582483Z Client ID: ***
2025-06-15T03:28:38.9582849Z Client Secret: [HIDDEN]
2025-06-15T03:28:38.9583322Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.9583989Z       Client ID: ***
2025-06-15T03:28:38.9584465Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.9584963Z       Client Secret: [HIDDEN]
2025-06-15T03:28:38.9585481Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.9586049Z Authenticating to Microsoft Graph...
2025-06-15T03:28:38.9586602Z Fetching Conditional Access Policies...
2025-06-15T03:28:38.9587200Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.9587727Z       Authenticating to Microsoft Graph...
2025-06-15T03:28:38.9588291Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.9588821Z       Fetching Conditional Access Policies...
2025-06-15T03:28:38.9589348Z Found 1 Conditional Access Policies
2025-06-15T03:28:38.9589875Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.9590381Z       Found 1 Conditional Access Policies
2025-06-15T03:28:38.9590933Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.9591402Z Policy Summary:
2025-06-15T03:28:38.9591707Z ================
2025-06-15T03:28:38.9592295Z - notrustisrael (State: Enabled)
2025-06-15T03:28:38.9592809Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.9593292Z       Policy Summary:
2025-06-15T03:28:38.9593757Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.9594217Z       ================
2025-06-15T03:28:38.9594665Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.9595169Z       - notrustisrael (State: Enabled)
2025-06-15T03:28:38.9595716Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.9596647Z Conditional Access Policies exported successfully to: ConditionalAccessPolicies_20250615_032838.json
2025-06-15T03:28:38.9597578Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.9598409Z       Conditional Access Policies exported successfully to: ConditionalAccessPolicies_20250615_032838.json
2025-06-15T03:28:38.9599308Z File size: 1.25 KB
2025-06-15T03:28:38.9599726Z Export completed successfully!
2025-06-15T03:28:38.9600275Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.9600815Z       File size: 1.25 KB
2025-06-15T03:28:38.9601323Z info: ConditionalAccessExporter.Program[0]
2025-06-15T03:28:38.9602056Z       Export completed successfully!
2025-06-15T03:28:39.0036961Z   Passed ConditionalAccessExporter.Tests.EndToEndWorkflowIntegrationTests.TerraformValidationWorkflow_CompleteValidation_ShouldValidateAllAspects [3 ms]
2025-06-15T03:28:39.0038126Z   Standard Output Messages:
2025-06-15T03:28:39.0038611Z  Test directory: /tmp/EndToEndTests_a16af290
2025-06-15T03:28:39.0039145Z  Terraform validation completed successfully
2025-06-15T03:28:39.0039798Z 
2025-06-15T03:28:39.0039813Z 
2025-06-15T03:28:39.0040846Z   Passed ConditionalAccessExporter.Tests.EndToEndWorkflowIntegrationTests.JsonToTerraformWorkflow_SingleFile_ShouldConvertSuccessfully [5 ms]
2025-06-15T03:28:39.0042450Z   Standard Output Messages:
2025-06-15T03:28:39.0042936Z  Test directory: /tmp/EndToEndTests_c2f7f4ae
2025-06-15T03:28:39.0043542Z  JSON to Terraform conversion completed: 3 files generated
2025-06-15T03:28:39.0044258Z 
2025-06-15T03:28:39.0044275Z 
2025-06-15T03:28:39.0045048Z   Passed ConditionalAccessExporter.Tests.ProgramTests.CrossFormatComparePoliciesAsync_Success_ReturnsZero [15 ms]
2025-06-15T03:28:39.0046748Z   Passed ConditionalAccessExporter.Tests.ProgramTests.ExportPoliciesAsync_Exception_HandlesErrorAndReturnsOne [268 ms]
2025-06-15T03:28:39.0048555Z   Passed ConditionalAccessExporter.Tests.ProgramTests.Export_Command_ValidArgs_CallsHandler(args: ["export", "--output", "custom_export.json"]) [533 ms]
2025-06-15T03:28:39.0050316Z   Passed ConditionalAccessExporter.Tests.ProgramTests.Export_Command_ValidArgs_CallsHandler(args: ["export"]) [241 ms]
2025-06-15T03:28:39.0052093Z   Passed ConditionalAccessExporter.Tests.ProgramTests.ConvertJsonToTerraformAsync_Success_ReturnsZero [13 ms]
2025-06-15T03:28:39.0053648Z   Passed ConditionalAccessExporter.Tests.ProgramTests.ComparePoliciesAsync_ServiceFailure_ReturnsOne [3 ms]
2025-06-15T03:28:39.0055211Z   Passed ConditionalAccessExporter.Tests.ProgramTests.JsonToTerraform_Command_MissingInput_ReturnsError [27 ms]
2025-06-15T03:28:39.4768624Z   Passed ConditionalAccessExporter.Tests.ProgramTests.CrossCompare_Command_MissingRequiredOption_ReturnsError(args: ["cross-compare", "--source-dir", "./src"]) [2 ms]
2025-06-15T03:28:39.4772755Z   Passed ConditionalAccessExporter.Tests.ProgramTests.CrossCompare_Command_MissingRequiredOption_ReturnsError(args: ["cross-compare", "--reference-dir", "./ref"]) [1 ms]
2025-06-15T03:28:39.4775616Z   Passed ConditionalAccessExporter.Tests.ProgramTests.CrossCompare_Command_ValidArgs_CallsHandler(args: ["cross-compare", "--source-dir", "./src_tf", "--reference-dir", "./ref_json", ···]) [3 ms]
2025-06-15T03:28:39.4778055Z   Passed ConditionalAccessExporter.Tests.ProgramTests.CrossCompare_Command_ValidArgs_CallsHandler(args: ["cross-compare", "--source-dir", "./src", "--reference-dir", "./ref"]) [1 ms]
2025-06-15T03:28:39.4779923Z   Passed ConditionalAccessExporter.Tests.ProgramTests.Terraform_Command_MissingInput_ReturnsError [1 ms]
2025-06-15T03:28:39.4781632Z   Passed ConditionalAccessExporter.Tests.ProgramTests.Terraform_Command_ValidArgs_CallsHandler(args: ["terraform", "--input", "file.tf"]) [12 ms]
2025-06-15T03:28:39.4784200Z   Passed ConditionalAccessExporter.Tests.ProgramTests.Terraform_Command_ValidArgs_CallsHandler(args: ["terraform", "--input", "dir/", "--output", "converted.json", ···]) [1 ms]
2025-06-15T03:28:39.4786003Z   Passed ConditionalAccessExporter.Tests.ProgramTests.ExportPoliciesAsync_Success_ReturnsZero [446 ms]
2025-06-15T03:28:39.4787489Z   Passed ConditionalAccessExporter.Tests.ProgramTests.ConvertTerraformAsync_ServiceFailure_ReturnsOne [1 ms]
2025-06-15T03:28:39.7799538Z [xUnit.net 00:00:05.82]     ConditionalAccessExporter.Tests.ProgramTests.JsonToTerraform_Command_ValidArgs_CallsHandler(args: ["json-to-terraform", "--input", "policies.json"]) [FAIL]
2025-06-15T03:28:39.7803969Z [xUnit.net 00:00:05.82]       System.ArgumentOutOfRangeException : Index was out of range. Must be non-negative and less than or equal to the size of the collection. (Parameter 'chunkLength')
2025-06-15T03:28:39.7807503Z [xUnit.net 00:00:05.82]       Stack Trace:
2025-06-15T03:28:39.7811365Z [xUnit.net 00:00:05.82]            at System.Text.StringBuilder.ToString()
2025-06-15T03:28:39.7813810Z [xUnit.net 00:00:05.82]         /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTestHelper.cs(250,0): at ConditionalAccessExporter.Tests.ProgramTestHelper.CaptureConsoleOutputInternal(Func`1 action)
2025-06-15T03:28:39.7816850Z [xUnit.net 00:00:05.82]         /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTestHelper.cs(218,0): at ConditionalAccessExporter.Tests.ProgramTestHelper.CaptureConsoleOutputAsync(Func`1 action)
2025-06-15T03:28:39.7818789Z [xUnit.net 00:00:05.82]         /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTests.cs(187,0): at ConditionalAccessExporter.Tests.ProgramTests.JsonToTerraform_Command_ValidArgs_CallsHandler(String[] args)
2025-06-15T03:28:39.7819975Z [xUnit.net 00:00:05.82]         --- End of stack trace from previous location ---
2025-06-15T03:28:39.7849199Z   Passed ConditionalAccessExporter.Tests.ProgramTests.ConvertJsonToTerraformAsync_ServiceFailure_ReturnsOne [1 ms]
2025-06-15T03:28:39.7851682Z   Passed ConditionalAccessExporter.Tests.ProgramTests.Compare_Command_ValidArgs_CallsHandler(args: ["compare", "--reference-dir", "./ref", "--entra-file", "entra_export.json", ···]) [9 ms]
2025-06-15T03:28:39.7854089Z   Passed ConditionalAccessExporter.Tests.ProgramTests.Compare_Command_ValidArgs_CallsHandler(args: ["compare", "--reference-dir", "./ref"]) [274 ms]
2025-06-15T03:28:39.7855825Z   Passed ConditionalAccessExporter.Tests.ProgramTests.ConvertTerraformAsync_Success_ReturnsZero [3 ms]
2025-06-15T03:28:39.7857214Z   Passed ConditionalAccessExporter.Tests.ProgramTests.ComparePoliciesAsync_Success_ReturnsZero [7 ms]
2025-06-15T03:28:39.7859580Z   Passed ConditionalAccessExporter.Tests.ProgramTests.JsonToTerraform_Command_ValidArgs_CallsHandler(args: ["json-to-terraform", "--input", "policies.json", "--output-dir", "custom_tf_out", ···]) [2 ms]
2025-06-15T03:28:39.7862222Z   Failed ConditionalAccessExporter.Tests.ProgramTests.JsonToTerraform_Command_ValidArgs_CallsHandler(args: ["json-to-terraform", "--input", "policies.json"]) [1 ms]
2025-06-15T03:28:39.7863595Z   Error Message:
2025-06-15T03:28:39.7864633Z    System.ArgumentOutOfRangeException : Index was out of range. Must be non-negative and less than or equal to the size of the collection. (Parameter 'chunkLength')
2025-06-15T03:28:39.7865763Z   Stack Trace:
2025-06-15T03:28:39.7866155Z      at System.Text.StringBuilder.ToString()
2025-06-15T03:28:39.7867843Z    at ConditionalAccessExporter.Tests.ProgramTestHelper.CaptureConsoleOutputInternal(Func`1 action) in /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTestHelper.cs:line 250
2025-06-15T03:28:39.7870547Z    at ConditionalAccessExporter.Tests.ProgramTestHelper.CaptureConsoleOutputAsync(Func`1 action) in /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTestHelper.cs:line 218
2025-06-15T03:28:39.7873345Z    at ConditionalAccessExporter.Tests.ProgramTests.JsonToTerraform_Command_ValidArgs_CallsHandler(String[] args) in /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/ProgramTests.cs:line 187
2025-06-15T03:28:39.7874926Z --- End of stack trace from previous location ---
2025-06-15T03:28:39.7875836Z   Passed ConditionalAccessExporter.Tests.ProgramTests.Compare_Command_MissingReferenceDir_ReturnsError [3 ms]
2025-06-15T03:28:39.7877176Z   Passed ConditionalAccessExporter.Tests.ProgramTests.Help_Option_PrintsHelpText(args: ["--help"]) [3 ms]
2025-06-15T03:28:40.5176256Z HTML report generated: /tmp/ReportGenerationTests/1457a841-c89d-4197-b6a7-1a08cbf6579a/CA_Comparison_20250615_032840.html
2025-06-15T03:28:40.5190847Z JSON report generated: /tmp/ReportGenerationTests/68deeb57-1e3d-4e03-8087-52f8cea1ed97/CA_Comparison_20250615_032840.json
2025-06-15T03:28:40.5233031Z CSV report generated: /tmp/ReportGenerationTests/c6e2b883-b19f-4d7e-a382-a8f99be72af3/CA_Comparison_20250615_032840.csv
2025-06-15T03:28:40.5245748Z JSON report generated: /tmp/ReportGenerationTests/a517dba9-586c-404a-ab64-fef49dc7216b/CA_Comparison_20250615_032840.json
2025-06-15T03:28:40.5248158Z HTML report generated: /tmp/ReportGenerationTests/a517dba9-586c-404a-ab64-fef49dc7216b/CA_Comparison_20250615_032840.html
2025-06-15T03:28:40.5254040Z CSV report generated: /tmp/ReportGenerationTests/a517dba9-586c-404a-ab64-fef49dc7216b/CA_Comparison_20250615_032840.csv
2025-06-15T03:28:40.5265615Z   Passed ConditionalAccessExporter.Tests.ProgramTests.Help_Option_PrintsHelpText(args: ["export", "--help"]) [1 ms]
2025-06-15T03:28:40.5266828Z   Passed ConditionalAccessExporter.Tests.ProgramTests.Main_NoArgs_CallsExportCommand [727 ms]
2025-06-15T03:28:40.5267671Z   Passed ConditionalAccessExporter.Tests.ProgramTests.CrossFormatComparePoliciesAsync_ServiceFailure_ReturnsOne [1 ms]
2025-06-15T03:28:40.5268920Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateConsoleReport_WithAllIdentical_ShouldShowAllIdentical [1 ms]
2025-06-15T03:28:40.5270029Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateConsoleReport_WithAllEntraOnly_ShouldShowEntraOnlySection [< 1 ms]
2025-06-15T03:28:40.5271759Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateHtmlReport_WithEmptyResult_ShouldCreateValidHtmlFile [1 ms]
2025-06-15T03:28:40.5273953Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateJsonReport_WithEmptyResult_ShouldCreateValidJsonFile [3 ms]
2025-06-15T03:28:40.5275815Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateCsvReport_WithAllStatusTypes_ShouldCreateValidCsvFile [2 ms]
2025-06-15T03:28:40.5276864Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateReports_WithNullDifferences_ShouldHandleGracefully [1 ms]
2025-06-15T03:28:40.5277849Z JSON report generated: /tmp/ReportGenerationTests/573828f4-5118-4e35-a51c-b994cebc27e4/CA_Comparison_20250615_032840.json
2025-06-15T03:28:40.5320935Z JSON report generated: /tmp/ReportGenerationTests/3113895a-4426-4792-8d50-939e0eb5e39e/new-directory/CA_Comparison_20250615_032840.json
2025-06-15T03:28:40.5331444Z JSON report generated: /tmp/ReportGenerationTests/fa19a870-31ce-4c77-9cf7-8fa66c8fb118/CA_Comparison_20250615_032840.json
2025-06-15T03:28:40.5333273Z HTML report generated: /tmp/ReportGenerationTests/fa19a870-31ce-4c77-9cf7-8fa66c8fb118/CA_Comparison_20250615_032840.html
2025-06-15T03:28:40.5336517Z CSV report generated: /tmp/ReportGenerationTests/fa19a870-31ce-4c77-9cf7-8fa66c8fb118/CA_Comparison_20250615_032840.csv
2025-06-15T03:28:40.5347648Z HTML report generated: /tmp/ReportGenerationTests/884b9da2-d8a4-4d86-a75b-0bc1768ce4fa/CA_Comparison_20250615_032840.html
2025-06-15T03:28:40.5377251Z Validating 2 policy files using parallel processing...
2025-06-15T03:28:40.5382239Z Validation completed: 0 valid, 2 invalid files
2025-06-15T03:28:40.5382805Z Processing time: 0ms
2025-06-15T03:28:40.5383221Z Average speed: 4309.4 files/second
2025-06-15T03:28:40.5403272Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateJsonReport_WithAllStatusTypes_ShouldCreateValidJsonFile [3 ms]
2025-06-15T03:28:40.5405325Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateReports_WithInvalidFormat_ShouldHandleGracefully [< 1 ms]
2025-06-15T03:28:40.5407313Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateConsoleReport_WithEmptyResult_ShouldShowEmptyReport [< 1 ms]
2025-06-15T03:28:40.5409087Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateConsoleReport_WithAllStatusTypes_ShouldProduceStructuredOutput [< 1 ms]
2025-06-15T03:28:40.5410433Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateReports_CreatesOutputDirectory_WhenNotExists [1 ms]
2025-06-15T03:28:40.5412230Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateReports_WithMultipleFormats_ShouldCreateAllFiles [1 ms]
2025-06-15T03:28:40.5422732Z   Passed ConditionalAccessExporter.Tests.ReportGenerationServiceTests.GenerateHtmlReport_WithAllStatusTypes_ShouldCreateValidHtmlFile [1 ms]
2025-06-15T03:28:40.5424773Z   Passed ConditionalAccessExporter.Tests.WorkflowIntegrationTests.ValidationWorkflow_MixedFiles_ShouldValidateAppropriately [2 ms]
2025-06-15T03:28:40.5425803Z   Standard Output Messages:
2025-06-15T03:28:40.5426115Z  Test directory: /tmp/WorkflowIntegrationTests_a848e68d
2025-06-15T03:28:40.5426675Z  Directory validation completed - Valid: False
2025-06-15T03:28:40.5426880Z 
2025-06-15T03:28:40.5426889Z 
2025-06-15T03:28:40.5427414Z   Passed ConditionalAccessExporter.Tests.WorkflowIntegrationTests.ErrorHandlingWorkflow_NonExistentDirectory_ShouldHandleGracefully [< 1 ms]
2025-06-15T03:28:40.5428109Z   Standard Output Messages:
2025-06-15T03:28:40.5428395Z  Test directory: /tmp/WorkflowIntegrationTests_61402e7b
2025-06-15T03:28:40.5428849Z  Non-existent directory handled gracefully
2025-06-15T03:28:40.5429040Z 
2025-06-15T03:28:40.5429045Z 
2025-06-15T03:28:40.5429458Z No JSON files found in directory: /tmp/WorkflowIntegrationTests_eb5dd891/empty-directory. No files were processed.
2025-06-15T03:28:40.5474659Z Validating 20 policy files using parallel processing...
2025-06-15T03:28:40.5491068Z Validation completed: 0 valid, 20 invalid files
2025-06-15T03:28:40.5492210Z Processing time: 2ms
2025-06-15T03:28:40.5492830Z Average speed: 12390.8 files/second
2025-06-15T03:28:40.5525616Z Starting cross-format comparison between '/tmp/WorkflowIntegrationTests_0f9dde9f/json-source' and '/tmp/WorkflowIntegrationTests_0f9dde9f/terraform-reference'
2025-06-15T03:28:40.5536900Z Found 2 source policies (Json) and 2 reference policies (Terraform)
2025-06-15T03:28:40.5542765Z Cross-format comparison report generated: /tmp/WorkflowIntegrationTests_0f9dde9f/report-output/comparison-report.json/cross-format-comparison-20250615-032840.json
2025-06-15T03:28:40.5643864Z Starting cross-format comparison between '/tmp/WorkflowIntegrationTests_bab772d0/json-policies' and '/tmp/WorkflowIntegrationTests_bab772d0/terraform-policies'
2025-06-15T03:28:40.5650229Z Found 1 source policies (Json) and 1 reference policies (Terraform)
2025-06-15T03:28:40.5683787Z [xUnit.net 00:00:06.60]   Finished:    ConditionalAccessExporter.Tests
2025-06-15T03:28:42.0409027Z   Passed ConditionalAccessExporter.Tests.WorkflowIntegrationTests.TerraformParsingWorkflow_ValidConfiguration_ShouldParseSuccessfully [1 ms]
2025-06-15T03:28:42.0410393Z   Standard Output Messages:
2025-06-15T03:28:42.0410880Z  Test directory: /tmp/WorkflowIntegrationTests_635288ab
2025-06-15T03:28:42.0411423Z  Parsed 1 Terraform policies successfully
2025-06-15T03:28:42.0411745Z 
2025-06-15T03:28:42.0411763Z 
2025-06-15T03:28:42.0412858Z   Passed ConditionalAccessExporter.Tests.WorkflowIntegrationTests.ErrorHandlingWorkflow_EmptyDirectory_ShouldReturnEmptyResults [< 1 ms]
2025-06-15T03:28:42.0414082Z   Standard Output Messages:
2025-06-15T03:28:42.0414559Z  Test directory: /tmp/WorkflowIntegrationTests_eb5dd891
2025-06-15T03:28:42.0415096Z  Empty directory handled gracefully
2025-06-15T03:28:42.0415372Z 
2025-06-15T03:28:42.0415380Z 
2025-06-15T03:28:42.0416327Z   Passed ConditionalAccessExporter.Tests.WorkflowIntegrationTests.TemplateWorkflow_ListAndCreateBasicTemplate_ShouldProvideTemplateSupport [1 ms]
2025-06-15T03:28:42.0417560Z   Standard Output Messages:
2025-06-15T03:28:42.0417951Z  Test directory: /tmp/WorkflowIntegrationTests_f9bd9cc1
2025-06-15T03:28:42.0418328Z  No templates available - template system accessible
2025-06-15T03:28:42.0418536Z 
2025-06-15T03:28:42.0418540Z 
2025-06-15T03:28:42.0419025Z   Passed ConditionalAccessExporter.Tests.WorkflowIntegrationTests.TerraformParsingWorkflow_InvalidSyntax_ShouldReportErrors [1 ms]
2025-06-15T03:28:42.0419664Z   Standard Output Messages:
2025-06-15T03:28:42.0419955Z  Test directory: /tmp/WorkflowIntegrationTests_ac2b3864
2025-06-15T03:28:42.0420308Z  Invalid Terraform correctly identified: 1 errors found
2025-06-15T03:28:42.0420519Z 
2025-06-15T03:28:42.0420523Z 
2025-06-15T03:28:42.0421070Z   Passed ConditionalAccessExporter.Tests.WorkflowIntegrationTests.PerformanceWorkflow_MultipleFileProcessing_ShouldCompleteWithinReasonableTime [5 ms]
2025-06-15T03:28:42.0421779Z   Standard Output Messages:
2025-06-15T03:28:42.0422326Z  Test directory: /tmp/WorkflowIntegrationTests_44c94c09
2025-06-15T03:28:42.0422683Z  Performance test: 20 files processed in 0.00 seconds
2025-06-15T03:28:42.0422888Z 
2025-06-15T03:28:42.0423206Z 
2025-06-15T03:28:42.0423763Z   Passed ConditionalAccessExporter.Tests.WorkflowIntegrationTests.CrossFormatWorkflow_JsonToTerraformWithReport_ShouldGenerateComprehensiveReport [4 ms]
2025-06-15T03:28:42.0424484Z   Standard Output Messages:
2025-06-15T03:28:42.0424762Z  Test directory: /tmp/WorkflowIntegrationTests_0f9dde9f
2025-06-15T03:28:42.0425421Z  Report generated at: /tmp/WorkflowIntegrationTests_0f9dde9f/report-output/comparison-report.json/cross-format-comparison-20250615-032840.json
2025-06-15T03:28:42.0426091Z 
2025-06-15T03:28:42.0426097Z 
2025-06-15T03:28:42.0426580Z   Passed ConditionalAccessExporter.Tests.WorkflowIntegrationTests.JsonToTerraformWorkflow_SinglePolicy_ShouldConvertWithMetadata [2 ms]
2025-06-15T03:28:42.0427228Z   Standard Output Messages:
2025-06-15T03:28:42.0427506Z  Test directory: /tmp/WorkflowIntegrationTests_a689daa9
2025-06-15T03:28:42.0427812Z  Conversion successful: 3 files created
2025-06-15T03:28:42.0427990Z 
2025-06-15T03:28:42.0427994Z 
2025-06-15T03:28:42.0428476Z   Passed ConditionalAccessExporter.Tests.WorkflowIntegrationTests.JsonToTerraformWorkflow_ComplexPolicy_ShouldPreserveStructure [5 ms]
2025-06-15T03:28:42.0429121Z   Standard Output Messages:
2025-06-15T03:28:42.0429394Z  Test directory: /tmp/WorkflowIntegrationTests_d22153cb
2025-06-15T03:28:42.0429728Z  Complex policy converted successfully with 3 files
2025-06-15T03:28:42.0429932Z 
2025-06-15T03:28:42.0429941Z 
2025-06-15T03:28:42.0430472Z   Passed ConditionalAccessExporter.Tests.WorkflowIntegrationTests.CrossFormatWorkflow_JsonToTerraformComparison_ShouldDetectEquivalentPolicies [2 ms]
2025-06-15T03:28:42.0431172Z   Standard Output Messages:
2025-06-15T03:28:42.0431440Z  Test directory: /tmp/WorkflowIntegrationTests_bab772d0
2025-06-15T03:28:42.0431815Z  Cross-format comparison: 1 JSON policies, 1 Terraform policies
2025-06-15T03:28:42.0432243Z 
2025-06-15T03:28:42.0432249Z 
2025-06-15T03:28:51.6311723Z 
2025-06-15T03:28:51.6353100Z Test Run Failed.
2025-06-15T03:28:51.6353502Z Total tests: 253
2025-06-15T03:28:51.6353818Z      Passed: 252
2025-06-15T03:28:51.6354013Z      Failed: 1
2025-06-15T03:28:51.6368361Z  Total time: 19.7332 Seconds
2025-06-15T03:28:51.6491139Z      1>Project "/home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.sln" (1) is building "/home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/ConditionalAccessExporter.Tests.csproj" (3) on node 2 (VSTest target(s)).
2025-06-15T03:28:51.6493128Z      3>_VSTestConsole:
2025-06-15T03:28:51.6493708Z          MSB4181: The "VSTestTask" task returned false but did not log an error.
2025-06-15T03:28:51.6526856Z      3>Done Building Project "/home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/ConditionalAccessExporter.Tests.csproj" (VSTest target(s)) -- FAILED.
2025-06-15T03:28:51.6593001Z      1>Done Building Project "/home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.sln" (VSTest target(s)) -- FAILED.
2025-06-15T03:28:51.6638966Z 
2025-06-15T03:28:51.6639337Z Build FAILED.
2025-06-15T03:28:51.6639894Z     0 Warning(s)
2025-06-15T03:28:51.6640877Z     0 Error(s)
2025-06-15T03:28:51.6646398Z 
2025-06-15T03:28:51.6646816Z Time Elapsed 00:00:20.64
2025-06-15T03:28:51.8383766Z 
2025-06-15T03:28:51.8388426Z Attachments:
2025-06-15T03:28:51.8390482Z   /home/runner/work/CA_Scanner/CA_Scanner/ConditionalAccessExporter.Tests/TestResults/19a28349-90e2-4a3d-9744-347ace6fe064/coverage.cobertura.xml
2025-06-15T03:28:51.8955519Z ##[error]Process completed with exit code 1.
